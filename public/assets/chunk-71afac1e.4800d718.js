(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-71afac1e"],{"0085":function(e,t,n){"use strict";n("6a23")},"01956":function(e,t,n){"use strict";n("b5e6")},"044c":function(e,t,n){"use strict";n("3982")},"0f4c":function(e,t,n){},"0f56":function(e,t,n){},10207:function(e,t,n){},1164:function(e,t,n){},"12ab":function(e,t,n){},1757:function(e,t,n){"use strict";n("ba24")},"187f":function(e,t,n){"use strict";n("3bdd")},1950:function(e,t,n){},"1c237":function(e,t,n){"use strict";n("237b")},"1faf":function(e,t,n){"use strict";n("3f33")},"21ad":function(e,t,n){"use strict";n("9bc7")},"237b":function(e,t,n){},"2e46":function(e,t,n){},"31ce":function(e,t,n){},3211:function(e,t,n){"use strict";n("c906")},"33ea":function(e,t,n){"use strict";n("a92a")},"34cb":function(e,t,n){"use strict";n("9867")},3982:function(e,t,n){},"3bdd":function(e,t,n){},"3e36":function(e,t,n){"use strict";n("5ea5")},"3f33":function(e,t,n){},"40d0":function(e,t,n){},"44bd":function(e,t,n){"use strict";n("90e9")},4596:function(e,t,n){},"475c":function(e,t,n){"use strict";n("ff92")},4789:function(e,t,n){"use strict";n("c936")},"49f7":function(e,t,n){},"4a7a":function(e,t,n){"use strict";n("de18")},"4afa":function(e,t,n){},"4b82":function(e,t,n){"use strict";n("80ce")},"4bec":function(e,t,n){"use strict";n("0f4c")},"4e80":function(e,t,n){"use strict";n("6d4a")},5170:function(e,t,n){},"578f":function(e,t,n){},"5ea5":function(e,t,n){},"609a":function(e,t,n){"use strict";n("ec8a")},6122:function(e,t,n){},6543:function(e,t,n){"use strict";n("4afa")},"6a23":function(e,t,n){},"6a48":function(e,t,n){},"6d4a":function(e,t,n){},"72b4":function(e,t,n){"use strict";n("6122")},"747f":function(e,t,n){"use strict";n("1950")},"751e":function(e,t,n){"use strict";n("578f")},"79db":function(e,t,n){},"79e5":function(e,t,n){"use strict";n("fc78")},"80ce":function(e,t,n){},"810c":function(e,t,n){"use strict";n("4596")},8161:function(e,t,n){"use strict";n("dffe")},"86c0":function(e,t,n){},"883d":function(e,t,n){},"90e9":function(e,t,n){},"965e":function(e,t,n){"use strict";n("2e46")},9867:function(e,t,n){},"9bc7":function(e,t,n){},"9bfc":function(e,t,n){"use strict";n("79db")},a697:function(e,t,n){"use strict";n("6a48")},a881:function(e,t,n){},a92a:function(e,t,n){},aa6c:function(e,t,n){"use strict";n("31ce")},aaef:function(e,t,n){},abf9:function(e,t,n){},ac36:function(e,t,n){},b000:function(e,t,n){"use strict";n("883d")},b2bf8:function(e,t,n){"use strict";n("49f7")},b5e6:function(e,t,n){},b8b7:function(e,t,n){},ba24:function(e,t,n){},ba8d:function(e,t,n){"use strict";n("1164")},bba2:function(e,t,n){"use strict";n("a881")},bbf5:function(e,t,n){"use strict";n("86c0")},bfa4:function(e,t,n){"use strict";n("d10d")},c7c9:function(e,t,n){"use strict";n("0f56")},c906:function(e,t,n){},c936:function(e,t,n){},ca2b:function(e,t,n){"use strict";n("d231")},cbfe:function(e,t,n){"use strict";n("12ab")},d10d:function(e,t,n){},d180:function(e,t,n){var a=n("ecf6"),r=n("cd9d");function c(e){return e&&e.length?a(e,r):0}e.exports=c},d231:function(e,t,n){},d5bf:function(e,t,n){"use strict";n("5170")},d7a8f:function(e,t,n){"use strict";n("10207")},d86b2:function(e,t,n){"use strict";n("aaef")},de18:function(e,t,n){},dffe:function(e,t,n){},e3c4:function(e,t,n){"use strict";n("40d0")},e9c41:function(e,t,n){"use strict";n("ac36")},ec8a:function(e,t,n){},ecf6:function(e,t){function n(e,t){var n,a=-1,r=e.length;while(++a<r){var c=t(e[a]);void 0!==c&&(n=void 0===n?c:n+c)}return n}e.exports=n},f00d:function(e,t,n){"use strict";n.r(t),n.d(t,"MultisidebarItemConfigsMap",(function(){return Dm})),n.d(t,"MultisidebarItemConfigs",(function(){return Lm}));var a=n("5530"),r=(n("b0c0"),n("d81d"),n("c1f9"),n("7a23")),c=n("be0f"),o=n("2afc"),i=n("099a"),s={class:"multisidebar-content__main"};function l(e,t,n,a,c,o){var i=Object(r["P"])("LiveLabel"),l=Object(r["P"])("SidebarHeader"),u=Object(r["P"])("NTabs"),d=Object(r["P"])("EventInfoSidebarContent"),m=Object(r["P"])("EpisodeEventsPage");return Object(r["F"])(),Object(r["i"])(r["a"],null,[Object(r["m"])(l,{"model-acl":e.modelAcl,label:e.headerLabel,changed:!1,actions:e.actions,onAction:t[0]||(t[0]=function(t){return e.actionHandler(t,e.sidebarItem)})},Object(r["k"])({_:2},[e.isLiveEpisode?{name:"extra-status",fn:Object(r["eb"])((function(){return[Object(r["m"])(i)]}))}:void 0]),1032,["model-acl","label","actions"]),e.tabsItems?(Object(r["F"])(),Object(r["g"])(u,{key:0,items:e.tabsItems,modelValue:e.tabName,"onUpdate:modelValue":t[1]||(t[1]=function(t){return e.tabName=t}),class:"multisidebar-content__tabs control-m"},null,8,["items","modelValue"])):Object(r["h"])("",!0),Object(r["j"])("div",s,[e.currentItem?(Object(r["F"])(),Object(r["i"])(r["a"],{key:0},[e.isEvents||e.tabName===e.TabNames.Info?(Object(r["F"])(),Object(r["g"])(d,{key:0,item:e.currentItem,"event-view":e.currentEventViewItem,"card-type":e.cardType,"object-type":e.objectType,"model-acl":e.modelAcl,onAction:t[2]||(t[2]=function(){return e.actionHandler.apply(e,arguments)})},null,8,["item","event-view","card-type","object-type","model-acl"])):Object(r["h"])("",!0),e.tabName===e.TabNames.Events?(Object(r["F"])(),Object(r["g"])(m,{key:1,item:e.currentItem,type:e.rawType,onAction:e.episodeEventActionHandler},null,8,["item","type","onAction"])):Object(r["h"])("",!0)],64)):Object(r["h"])("",!0)])],64)}var u=n("1da1"),d=n("d4ec"),m=n("bee2"),b=n("262e"),p=n("2caf"),f=(n("96cf"),n("07ac"),n("ac1f"),n("1276"),n("4de4"),n("d3b7"),n("99af"),n("d9e2"),n("9ab4")),h=n("ce1f"),v=n("1b40"),j=n("9926"),O=n("3efe"),y=n("1a10"),g={class:"sidebar-page-content"},_={class:"events-sidebar__previews"},k={class:"frame"},w={class:"frame__overview"},C={class:"frame__header label-m"},x=Object(r["j"])("div",{class:"line"},null,-1),T={class:"frame"},I={class:"frame__overview"},A={class:"frame__header label-m"},F=Object(r["j"])("div",{class:"line"},null,-1),N={key:0,class:"frame attributes"},S={class:"frame__overview"},V={class:"frame__header label-m"},P=Object(r["j"])("div",{class:"line"},null,-1),R={class:"attributes__content"},M={class:"frame acknowledgment"},E={class:"frame__overview"},L={class:"frame__header label-m"},D=Object(r["j"])("div",{class:"line"},null,-1),$={class:"acknowledgment__content label-mono-m"},U={class:"frame"},B={class:"frame__overview"},q={class:"frame__header label-m"},H=Object(r["j"])("div",{class:"line"},null,-1);function G(e,t,n,a,c,o){var i,s=Object(r["P"])("NThumbnail"),l=Object(r["P"])("MatchedCardInfo"),u=Object(r["P"])("WatchListsGroup"),d=Object(r["P"])("CameraLabelsV2"),m=Object(r["P"])("Attributes"),b=Object(r["P"])("Acknowledge"),p=Object(r["P"])("AcknowledgeInfo"),f=Object(r["P"])("NForm");return Object(r["F"])(),Object(r["i"])("div",g,[Object(r["j"])("div",_,[Object(r["m"])(s,{class:"events-sidebar__previews-event","model-value":e.eventView.thumbnail,size:"extra-large",onClick:e.showFullscreen},null,8,["model-value","onClick"]),e.eventView.matched_card?(Object(r["F"])(),Object(r["g"])(l,{key:0,id:e.eventView.matched_card,type:e.cardType,"object-id":e.eventView.matched_object,"object-type":e.objectType,confidence:e.eventView.confidence},null,8,["id","type","object-id","object-type","confidence"])):Object(r["h"])("",!0)]),Object(r["j"])("div",k,[Object(r["j"])("div",w,[Object(r["j"])("span",C,Object(r["T"])(e.$t("common.watch_lists","f")),1),x]),null!==(i=e.item)&&void 0!==i&&i.matched_lists?(Object(r["F"])(),Object(r["g"])(u,{key:0,items:e.item.matched_lists,marker:e.marker,"tag-view":"","text-size":"normal"},null,8,["items","marker"])):Object(r["h"])("",!0)]),Object(r["j"])("div",T,[Object(r["j"])("div",I,[Object(r["j"])("span",A,Object(r["T"])(e.$t("common.cameras","f")),1),F]),Object(r["m"])(d,{"camera-groups-ids":e.eventView.camera_groups,"cameras-ids":e.eventView.cameras,"video-archive-id":e.eventView.video_archive,"has-play":e.hasPlay,onAction:t[0]||(t[0]=function(t,n){return e.handleCameraAction(t,n)})},null,8,["camera-groups-ids","cameras-ids","video-archive-id","has-play"])]),e.hasAttributes?(Object(r["F"])(),Object(r["i"])("div",N,[Object(r["j"])("div",S,[Object(r["j"])("span",V,Object(r["T"])(e.$t("common.attributes","f")),1),P]),Object(r["j"])("div",R,[Object(r["m"])(m,{items:e.attributesItems},null,8,["items"])])])):Object(r["h"])("",!0),Object(r["j"])("div",M,[Object(r["j"])("div",E,[Object(r["j"])("span",L,Object(r["T"])(e.$t("common.acknowledgement","f")),1),D]),Object(r["j"])("div",$,[Object(r["m"])(b,{item:e.item,style:{width:"160px"},onAction:t[1]||(t[1]=function(t,n){return t&&e.$emit("action",t,n)}),disabled:!e.modelAcl.update},null,8,["item","disabled"]),e.item.acknowledged?(Object(r["F"])(),Object(r["g"])(p,{key:0,item:e.item,onAction:t[2]||(t[2]=function(t,n){return t&&e.$emit("action",t,n)})},null,8,["item"])):Object(r["h"])("",!0)])]),Object(r["j"])("div",U,[Object(r["j"])("div",B,[Object(r["j"])("span",q,Object(r["T"])(e.$t("common.other","f")),1),H]),Object(r["m"])(f,{layout:e.infoFields,model:e.item},null,8,["layout","model"])])])}n("b64b");var z=n("7bb9"),W=n("42ea"),Y=n("c0fc"),K=n("3e30"),X={class:"acknowledge-info"},J={key:0,class:"acknowledge-info__date"};function Z(e,t,n,a,c,o){var i=Object(r["P"])("NButton");return Object(r["F"])(),Object(r["i"])("div",X,[e.item.acknowledged_date?(Object(r["F"])(),Object(r["i"])("span",J,Object(r["T"])(e.acknowledgedDate),1)):Object(r["h"])("",!0),e.item.acknowledged_by?(Object(r["F"])(),Object(r["g"])(i,{key:1,type:"link",onClick:e.navigateToUser},{default:Object(r["eb"])((function(){return[Object(r["l"])(Object(r["T"])(e.acknowledgedBy),1)]})),_:1},8,["onClick"])):Object(r["h"])("",!0)])}n("7db0");var Q=n("17f6"),ee=n("87b9"),te=n("1e37"),ne=function(e){Object(b["a"])(n,e);var t=Object(p["a"])(n);function n(){return Object(d["a"])(this,n),t.apply(this,arguments)}return Object(m["a"])(n,[{key:"module",get:function(){var e=ee["d"].getUsersListViewModel();return e.aclModelName="user",e}},{key:"dataModule",get:function(){return Q["a"]}},{key:"acknowledgedDate",get:function(){return this.$filters.formatDateTime(this.item.acknowledged_date)}},{key:"acknowledgedBy",get:function(){return this.item.acknowledged_by&&this.dataModule.getUserNameById(this.item.acknowledged_by)}},{key:"users",get:function(){return Q["a"].usersModule.items}},{key:"acknowledgedByUser",get:function(){var e=this;return this.users.find((function(t){return t.real_name===e.acknowledgedBy}))}},{key:"navigateToUser",value:function(){this.$emit("action",te["b"].NavigateToUser,this.acknowledgedByUser)}}]),n}(h["b"]);Object(f["b"])([Object(v["c"])({type:Object,required:!0})],ne.prototype,"item",void 0),ne=Object(f["b"])([Object(h["a"])({name:"AcknowledgeInfo",components:{NButton:z["b"]}})],ne);var ae=ne,re=(n("ba8d"),n("6b0d")),ce=n.n(re);const oe=ce()(ae,[["render",Z]]);var ie=oe,se=n("c15e"),le=n("d646"),ue=n("1d9c"),de=n("1c27"),me=n("b72f"),be=n("07e7"),pe=n("2496"),fe=n("f705"),he=function(e){Object(b["a"])(n,e);var t=Object(p["a"])(n);function n(){return Object(d["a"])(this,n),t.apply(this,arguments)}return Object(m["a"])(n,[{key:"hasAttributes",get:function(){return!!Object.keys(this.eventView.features||this.eventView.faces_features||this.eventView.bodies_features||this.eventView.cars_features||{}).length}},{key:"attributesItems",get:function(){return{faces:{display:!!this.eventView.faces_features,features:this.eventView.faces_features},bodies:{display:!!this.eventView.bodies_features,features:this.eventView.bodies_features},cars:{display:!!this.eventView.cars_features,features:this.eventView.cars_features}}}},{key:"marker",get:function(){return de["a"].Circle}},{key:"infoFields",get:function(){return Object(me["b"])([me["a"].Id,me["a"].Created])}},{key:"hasPlay",get:function(){var e;return null===(e=fe["a"].config.vms)||void 0===e?void 0:e.enabled}},{key:"showFullscreen",value:function(){this.$emit("action",te["b"].ShowFullScreen,this.eventView)}},{key:"handleCameraAction",value:function(e,t){this.$emit("action",e,t)}}]),n}(h["b"]);Object(f["b"])([Object(v["c"])({type:Object,required:!0})],he.prototype,"item",void 0),Object(f["b"])([Object(v["c"])({type:Object,required:!0})],he.prototype,"eventView",void 0),Object(f["b"])([Object(v["c"])({type:String,required:!0})],he.prototype,"objectType",void 0),Object(f["b"])([Object(v["c"])({type:String,required:!0})],he.prototype,"cardType",void 0),Object(f["b"])([Object(v["c"])({type:Object,required:!0})],he.prototype,"modelAcl",void 0),he=Object(f["b"])([Object(h["a"])({name:"EventInfoSidebarContent",components:{NThumbnail:pe["a"],NForm:be["b"],AcknowledgeInfo:ie,MatchedCardInfo:K["a"],NButton:z["b"],SimpleReaction:W["a"],CameraLabelsV2:le["a"],WatchListsGroup:Y["a"],Acknowledge:se["a"],Attributes:ue["a"]}})],he);var ve=he;n("187f");const je=ce()(ve,[["render",G]]);var Oe=je,ye=n("b849"),ge=n("c720"),_e=n("c1b3"),ke=n("c27a"),we=n("500b"),Ce=n("9a69"),xe=n("a367"),Te=n("79f6"),Ie={class:"live-label header-m"};function Ae(e,t,n,a,c,o){return Object(r["F"])(),Object(r["i"])("div",Ie,"LIVE")}var Fe=function(e){Object(b["a"])(n,e);var t=Object(p["a"])(n);function n(){return Object(d["a"])(this,n),t.apply(this,arguments)}return Object(m["a"])(n)}(h["b"]);Fe=Object(f["b"])([Object(h["a"])({name:"LiveLabel"})],Fe);var Ne=Fe;n("4bec");const Se=ce()(Ne,[["render",Ae]]);var Ve=Se,Pe=n("2453"),Re=n("198a"),Me=n("772a"),Ee={Info:"info",Events:"events"},Le=Object.values(Ee),De=function(e){Object(b["a"])(n,e);var t=Object(p["a"])(n);function n(){var e;return Object(d["a"])(this,n),e=t.apply(this,arguments),e.tabName="",e}return Object(m["a"])(n,[{key:"headerLabel",get:function(){var e,t;return this.isEvents?this.$t(null!==(t=this.currentEventViewItem)&&void 0!==t&&t.matched_card?"events.matched_event":"events.unmatched_event","f"):this.$t(null!==(e=this.currentEventViewItem)&&void 0!==e&&e.matched_card?"events.matched_episode":"events.unmatched_episode","f")}},{key:"rawType",get:function(){return this.sidebarItem.type.split("_")[1]}},{key:"rawItem",get:function(){return this.sidebarItem.model.item}},{key:"objectType",get:function(){return this.isEvents?this.rawType:we["a"].getObjectTypeByEpisode(this.rawItem)}},{key:"cardType",get:function(){return this.isEvents?we["a"].getCardTypeByObjectType(this.rawType):we["a"].getCardTypeByEpisodeType(this.rawType)}},{key:"isEvents",get:function(){return this.pageType===ge["r"].events}},{key:"pageType",get:function(){return this.sidebarItem.type.split("_")[0]}},{key:"isLiveEpisode",get:function(){var e;return!this.isEvents&&(null===(e=this.currentEventViewItem)||void 0===e?void 0:e.open)}},{key:"TabNames",get:function(){return Ee}},{key:"tabsItems",get:function(){var e=this,t=null;switch(this.pageType){case ge["r"].episodes:t=Le.map((function(t){return{name:t,label:e.$t("common.".concat(t),"f")}}));break}return t}},{key:"currentItem",get:function(){return this.module.item}},{key:"module",get:function(){return this.sidebarItem.model}},{key:"currentEventViewItem",get:function(){return this.currentItem?Object(_e["c"])(this.currentItem,this.objectType):null}},{key:"actions",get:function(){return this.isEvents?[{name:te["b"].Search,i18n_label:"common.search",hidden:!0},{name:te["b"].CreateCard,i18n_label:"common.create_card",hidden:!0}]:[]}},{key:"websocketModule",get:function(){return Me["a"]}},{key:"episodeEventActionHandler",value:function(e,t,n){switch(e){case Ce["a"].ShowInfo:xe["a"].run(te["b"].ShowItem,{type:"events_".concat(this.objectType),rawItem:n||t});break}}},{key:"showPlayer",value:function(e){var t=new Date(this.module.item.created_date).getTime()/1e3;this.$videoPlayer.playArchive(e,t-3)}},{key:"actionHandler",value:function(e,t){switch(e){case te["b"].ShowPlayer:this.showPlayer(t);break;case te["b"].Acknowledge:this.acknowledge(t);break;case te["b"].NavigateToUser:this.navigateToUser(t);break;case te["b"].CreateCard:this.createCardFromEvent(t);break;default:xe["a"].run(e,t)}}},{key:"navigateToUser",value:function(e){xe["a"].run(te["b"].ShowItem,{type:Pe["c"].Users,rawItem:e})}},{key:"acknowledge",value:function(){var e=Object(u["a"])(regeneratorRuntime.mark((function e(t){var n,a,r,c,o,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(a=null===(n=this.sidebarItem.model.item)||void 0===n?void 0:n.id,!this.isEvents){e.next=6;break}return e.next=4,this.sidebarItem.model.update({id:a,acknowledged:t.value});case 4:e.next=10;break;case 6:return r=this.sidebarItem.model.item,c=r.best_car_event,o=r.best_body_event,i=r.best_face_event,e.next=9,this.sidebarItem.model.update({id:a,acknowledged:t.value});case 9:Object.assign(this.sidebarItem.model.item,{best_car_event:c,best_body_event:o,best_face_event:i});case 10:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"getCardType",value:function(e){var t=e.split("_")[1];return we["a"].getCardTypeByObjectType(t)}},{key:"getDetectionObjectType",value:function(e){var t=e.split("_")[1];return ke["l"][t]}},{key:"extractPlaceNumber",value:function(e){var t;return null===(t=e.features.license_plate_number)||void 0===t?void 0:t.name}},{key:"createCard",value:function(){var e=Object(u["a"])(regeneratorRuntime.mark((function e(t,n){var a,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:a=t.matched_lists.filter((function(e){return e>0})),r={name:t.id,watch_lists:a.length>0?a:[1]},e.t0=n,e.next=e.t0===ke["b"].Humans?5:e.t0===ke["b"].Cars?6:8;break;case 5:return e.abrupt("return",Te["h"].cardsHumansCreate(r));case 6:return this.extractPlaceNumber(t)&&Object.assign(r,{license_plate_number:this.extractPlaceNumber(t)}),e.abrupt("return",Te["h"].cardsCarsCreate(r));case 8:case"end":return e.stop()}}),e,this)})));function t(t,n){return e.apply(this,arguments)}return t}()},{key:"addObjectToCard",value:function(){var e=Object(u["a"])(regeneratorRuntime.mark((function e(t,n){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:e.t0=n,e.next=e.t0===Re["a"].Face?3:e.t0===Re["a"].Body?4:e.t0===Re["a"].Car?5:6;break;case 3:return e.abrupt("return",Te["p"].objectsFacesCreate(t));case 4:return e.abrupt("return",Te["p"].objectsBodiesCreate(t));case 5:return e.abrupt("return",Te["p"].objectsCarsCreate(t));case 6:case"end":return e.stop()}}),e)})));function t(t,n){return e.apply(this,arguments)}return t}()},{key:"createCardFromEvent",value:function(){var e=Object(u["a"])(regeneratorRuntime.mark((function e(t){var n,a,r,c,o;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return n=this.getCardType(t.type),a=t.model.item,e.prev=2,e.next=5,this.createCard(a,n);case 5:return r=e.sent,c=this.getDetectionObjectType(t.type),o={create_from:"".concat(c,"event:").concat(a.id),card:r.id},e.next=10,this.addObjectToCard(o,c);case 10:return e.next=12,xe["a"].run(te["b"].ShowItem,{type:"cards_".concat(n),rawItem:null===r||void 0===r?void 0:r.id});case 12:e.next=17;break;case 14:throw e.prev=14,e.t0=e["catch"](2),new Error(e.t0);case 17:case"end":return e.stop()}}),e,this,[[2,14]])})));function t(t){return e.apply(this,arguments)}return t}()}]),n}(h["b"]);Object(f["b"])([Object(v["c"])({type:Object,required:!0})],De.prototype,"sidebarItem",void 0),Object(f["b"])([Object(v["c"])({type:Object,required:!0})],De.prototype,"modelAcl",void 0),De=Object(f["b"])([Object(h["a"])({name:"EventContentItem",components:{EpisodeEventsPage:ye["a"],EventInfoSidebarContent:Oe,NTabs:y["a"],Confidence:O["a"],SidebarHeader:j["a"],LiveLabel:Ve}})],De);var $e=De;n("aa6c");const Ue=ce()($e,[["render",l]]);var Be=Ue,qe={class:"multisidebar-content__main"};function He(e,t,n,a,c,o){var i,s=Object(r["P"])("CardMonitoringStatus"),l=Object(r["P"])("SidebarHeader"),u=Object(r["P"])("NTabs"),d=Object(r["P"])("CardForm"),m=Object(r["P"])("NForm"),b=Object(r["P"])("ItemsView"),p=Object(r["P"])("CaseCardsView"),f=Object(r["P"])("DetectionDialog"),h=Object(r["P"])("MultisidebarSaveActions"),v=Object(r["P"])("CardsDuplicateDialog");return Object(r["F"])(),Object(r["i"])("div",null,[Object(r["m"])(l,{"model-acl":e.modelAcl,label:e.currentItem.name,inactivated:!(null!==(i=e.currentItem)&&void 0!==i&&i.active),changed:e.module.hasChanges,actions:e.headerActions,onAction:t[0]||(t[0]=function(t){return e.actionHandler(t,e.sidebarItem)})},Object(r["k"])({_:2},[e.isPuppeteerEnabled&&e.currentItemMonitoringRecord?{name:"extra-status",fn:Object(r["eb"])((function(){return[Object(r["m"])(s,{item:e.currentItemMonitoringRecord},null,8,["item"])]}))}:void 0]),1032,["model-acl","label","inactivated","changed","actions"]),Object(r["m"])(u,{items:e.tabsItems,modelValue:e.tabName,"onUpdate:modelValue":t[1]||(t[1]=function(t){return e.tabName=t}),class:"multisidebar-content__tabs control-m"},null,8,["items","modelValue"]),Object(r["j"])("div",qe,[e.tabName===e.TabItemsMap.Info?(Object(r["F"])(),Object(r["g"])(d,{key:0,ref:"cardFormInstance",item:e.currentItem,"card-type":e.cardType,disabled:e.disabled},null,8,["item","card-type","disabled"])):Object(r["h"])("",!0),e.isMetaTab?(Object(r["F"])(),Object(r["g"])(m,{key:1,ref:"cardFormInstance",model:e.currentItem.meta,layout:e.metaTabFormSchema,disabled:e.disabled},null,8,["model","layout","disabled"])):Object(r["h"])("",!0),e.itemsModule?(Object(r["F"])(),Object(r["g"])(b,{key:e.itemsModule.name,module:e.itemsModule,"model-acl":e.tabModelAcl,sortTypes:e.itemsSortTypes,"upload-feature":e.uploadFeature,participants:e.itemsModule===e.participantsVM,onAction:t[2]||(t[2]=function(t,n){return e.itemActionHandler(t,n)})},null,8,["module","model-acl","sortTypes","upload-feature","participants"])):Object(r["h"])("",!0),e.tabName===e.TabItemsMap.CaseHumanCards?(Object(r["F"])(),Object(r["g"])(p,{key:3,"card-id":e.currentItem.id,onAction:e.actionHandler},null,8,["card-id","onAction"])):Object(r["h"])("",!0),Object(r["j"])("input",{name:"file",type:"file",ref:"fileInput",onChange:t[3]||(t[3]=function(){return e.setFile&&e.setFile.apply(e,arguments)}),class:"hide-element"},null,544),e.showDetectionDialog?(Object(r["F"])(),Object(r["g"])(f,{key:4,"image-file":e.file,options:e.objectType,onApply:e.applyDetection,onClose:t[4]||(t[4]=function(t){return e.showDetectionDialog=!1})},null,8,["image-file","options","onApply"])):Object(r["h"])("",!0)]),Object(r["m"])(h,{"model-acl":e.modelAcl,"sidebar-item":e.sidebarItem},null,8,["model-acl","sidebar-item"]),e.showDuplicateDialog?(Object(r["F"])(),Object(r["g"])(v,{key:0,image:e.cardsDuplicate.thumbnail,cards:e.cardsDuplicate.cards,cardType:e.cardType,onClose:t[5]||(t[5]=function(t){return e.showDuplicateDialog=!1}),onAddToCard:e.addPhotoToCard},null,8,["image","cards","cardType","onAddToCard"])):Object(r["h"])("",!0)])}var Ge=n("ade3"),ze=(n("fb6a"),n("15fe")),We=n("feb0"),Ye=n("ec49"),Ke=n("2cf6"),Xe={class:"case-cards-view"},Je={key:0,class:"case-cards-view__body"},Ze={class:"case-cards-view__case"},Qe={class:"case-cards-view__cards"},et={key:1,class:"case-cards-view__empty"};function tt(e,t,n,a,c,o){var i,s,l=Object(r["P"])("ExtendedCaseDescription"),u=Object(r["P"])("CardItem");return Object(r["F"])(),Object(r["i"])("div",Xe,[null!==(i=e.caseCardsData)&&void 0!==i&&i.cases.length?(Object(r["F"])(),Object(r["i"])("div",Je,[(Object(r["F"])(!0),Object(r["i"])(r["a"],null,Object(r["N"])(null===(s=e.caseCardsData)||void 0===s?void 0:s.cases,(function(t){var n;return Object(r["F"])(),Object(r["i"])(r["a"],{key:t.id},[null!==(n=e.getCaseCards(t.id))&&void 0!==n&&n.length?(Object(r["F"])(),Object(r["i"])(r["a"],{key:0},[Object(r["j"])("div",Ze,[Object(r["m"])(l,{item:t},null,8,["item"])]),Object(r["j"])("div",Qe,[(Object(r["F"])(!0),Object(r["i"])(r["a"],null,Object(r["N"])(e.getCaseCards(t.id),(function(t){return Object(r["F"])(),Object(r["g"])(u,{key:t.id,type:e.cardType,item:t,selectable:!1,displayType:e.displayType,"show-fullframe":!0,onAction:function(n){return e.actionHandler(n,t)}},null,8,["type","item","displayType","onAction"])})),128))])],64)):Object(r["h"])("",!0)],64)})),128))])):e.loading?Object(r["h"])("",!0):(Object(r["F"])(),Object(r["i"])("div",et,Object(r["T"])(e.$t("common.no_data","f")),1))])}n("a630"),n("3ca3"),n("6062"),n("ddb0"),n("a9e3");var nt={class:"object-item"},at={class:"object-item__thumbnail"},rt={class:"object-item__information"},ct={class:"object-item__information-content"},ot={class:"object-item__name heading-s"};function it(e,t,n,a,c,o){var i=Object(r["P"])("NThumbnail");return Object(r["F"])(),Object(r["i"])("div",nt,[Object(r["j"])("div",at,[Object(r["m"])(i,{modelValue:e.item.thumbnail,actions:e.computedActions,onAction:t[0]||(t[0]=function(t){return e.$emit("action",t,e.item)})},null,8,["modelValue","actions"])]),Object(r["j"])("div",rt,[Object(r["j"])("div",ct,[Object(r["j"])("div",ot,Object(r["T"])(e.item.id),1)])])])}var st=n("45f3"),lt=n("0613"),ut=function(e){Object(b["a"])(n,e);var t=Object(p["a"])(n);function n(){return Object(d["a"])(this,n),t.apply(this,arguments)}return Object(m["a"])(n,[{key:"computedActions",get:function(){var e,t=[{icon:"eye-open",name:lt["a"].ShowFullScreen,position:lt["c"].BottomRight}];return null!==(e=this.acl)&&void 0!==e&&e.delete&&t.unshift({icon:"trash",name:lt["a"].Remove,position:lt["c"].BottomLeft}),this.actions||t}}]),n}(h["b"]);Object(f["b"])([Object(v["c"])({type:Object,required:!0})],ut.prototype,"item",void 0),Object(f["b"])([Object(v["c"])({type:Array})],ut.prototype,"actions",void 0),Object(f["b"])([Object(v["c"])({type:Object})],ut.prototype,"acl",void 0),ut=Object(f["b"])([Object(h["a"])({name:"ParticipantItemRow",components:{NButton:st["c"],NThumbnail:pe["a"]}})],ut);var dt=ut;n("747f");const mt=ce()(dt,[["render",it]]);var bt=mt,pt=n("db34"),ft=n("2164"),ht={class:"camera-shot-attach"},vt={class:"camera-shot-attach__content"},jt={class:"camera-shot-attach__video",ref:"canvas"},Ot={class:"camera-shot-attach__video",autoplay:"",ref:"video"},yt={class:"camera-shot-attach__actions"};function gt(e,t,n,a,c,o){var i=Object(r["P"])("NButton"),s=Object(r["P"])("NModalWindow");return Object(r["F"])(),Object(r["i"])("div",ht,[Object(r["m"])(i,{icon:e.icon,type:e.type,onClick:e.openCameraDialog,disabled:!e.hasCamera},{default:Object(r["eb"])((function(){return[Object(r["l"])(Object(r["T"])(e.i18n_label?e.$t(e.i18n_label):""),1)]})),_:1},8,["icon","type","onClick","disabled"]),e.isCameraDialogEnabled?(Object(r["F"])(),Object(r["g"])(s,{key:0,onClose:e.closeCameraDialog,"has-margins":!1},{content:Object(r["eb"])((function(){return[Object(r["j"])("div",vt,[Object(r["fb"])(Object(r["j"])("canvas",jt,null,512),[[r["cb"],e.evaluating]]),Object(r["fb"])(Object(r["j"])("video",Ot,null,512),[[r["cb"],!e.evaluating]])])]})),footer:Object(r["eb"])((function(){return[Object(r["j"])("div",yt,[e.evaluating?(Object(r["F"])(),Object(r["i"])(r["a"],{key:0},[Object(r["m"])(i,{icon:"upload",onClick:e.attach},{default:Object(r["eb"])((function(){return[Object(r["l"])(Object(r["T"])(e.$t("common.photo_upload")),1)]})),_:1},8,["onClick"]),Object(r["m"])(i,{type:"secondary",onClick:t[0]||(t[0]=function(t){return e.evaluating=!1})},{default:Object(r["eb"])((function(){return[Object(r["l"])(Object(r["T"])(e.$t("common.redo_picture")),1)]})),_:1})],64)):(Object(r["F"])(),Object(r["g"])(i,{key:1,icon:"photo",onClick:e.capture},{default:Object(r["eb"])((function(){return[Object(r["l"])(Object(r["T"])(e.$t("common.take_picture")),1)]})),_:1},8,["onClick"]))])]})),_:1},8,["onClose"])):Object(r["h"])("",!0)])}n("25f0");var _t=n("1d65"),kt=Object(r["n"])({name:"CameraShotAttach",components:{NButton:z["b"],NModalWindow:z["u"]},props:{icon:{type:String,default:"photo"},type:{type:String,default:st["b"].Secondary},i18n_label:{type:String,default:""}},setup:function(e,t){var n=t.emit,c=Object(r["K"])({stream:null,video:null,canvas:null,context:null,evaluating:!1,isCameraDialogEnabled:!1,hasCamera:!0,cameraShot:null});function o(){return i.apply(this,arguments)}function i(){return i=Object(u["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(e.prev=0,!Object(_t["e"])()){e.next=9;break}return e.next=4,Object(_t["a"])();case 4:return c.stream=e.sent,c.isCameraDialogEnabled=!0,e.next=8,Object(r["v"])();case 8:c.video&&c.canvas&&(c.video.srcObject=c.stream,c.context=c.canvas.getContext("2d"),c.video.addEventListener("loadedmetadata",s));case 9:e.next=14;break;case 11:e.prev=11,e.t0=e["catch"](0),console.warn(e.t0);case 14:case"end":return e.stop()}}),e,null,[[0,11]])}))),i.apply(this,arguments)}function s(){c.canvas&&c.video&&(c.canvas.width=c.video.videoWidth,c.canvas.height=c.video.videoHeight)}function l(){c.evaluating=!1,c.isCameraDialogEnabled=!1,d()}function d(){c.stream&&Object(_t["b"])(c.stream),c.stream=null}function m(){d(),c.video&&c.video.removeEventListener("loadedmetadata",s)}function b(){var e=c.video,t=c.canvas,n=c.context;e&&n&&t&&(n.fillRect(0,0,t.width,t.height),n.drawImage(e,0,0,t.width,t.height),t.toBlob((function(e){c.cameraShot=e,c.evaluating=!0})))}function p(){if(c.cameraShot){var e=Math.random().toString().slice(2,8)+".png",t=new File([c.cameraShot],e,{type:c.cameraShot.type,lastModified:Date.now()});return t}}function f(){n("attach",p()),l()}return Object(_t["c"])().then((function(e){return c.hasCamera=Boolean(e.length)})),Object(r["B"])(m),Object(a["a"])(Object(a["a"])({},Object(r["X"])(c)),{},{openCameraDialog:o,closeCameraDialog:l,capture:b,attach:f})}});n("b000");const wt=ce()(kt,[["render",gt]]);var Ct=wt,xt=n("3b9e"),Tt=n("dea8"),It=n("0836"),At={class:"control-m ex-case-description__date"};function Ft(e,t,n,a,c,o){return Object(r["F"])(),Object(r["i"])("div",{class:Object(r["w"])(["ex-case-description",e.classes])},[Object(r["j"])("span",{class:"control-m ex-case-description__link",onClick:t[0]||(t[0]=function(){return e.clickHandler&&e.clickHandler.apply(e,arguments)})},Object(r["T"])(e.item.name),1),Object(r["j"])("span",At,Object(r["T"])(e.$filters.formatDate(e.item.incident_date)),1)],2)}var Nt=n("8fc83"),St=function(e){Object(b["a"])(n,e);var t=Object(p["a"])(n);function n(){return Object(d["a"])(this,n),t.apply(this,arguments)}return Object(m["a"])(n,[{key:"classes",get:function(){return Object(Ge["a"])({},"case-description_row",!0)}},{key:"clickHandler",value:function(){Nt["a"].navigateToCase(this.item.id,{subPage:"participants"})}}]),n}(h["b"]);Object(f["b"])([Object(v["c"])({type:Object,required:!0})],St.prototype,"item",void 0),St=Object(f["b"])([Object(h["a"])({name:"ExtendedCaseDescription",components:{NButton:st["c"]}})],St);var Vt=St;n("cbfe");const Pt=ce()(Vt,[["render",Ft]]);var Rt=Pt,Mt=function(e){Object(b["a"])(n,e);var t=Object(p["a"])(n);function n(){var e;return Object(d["a"])(this,n),e=t.apply(this,arguments),e.sortTypes=[],e.caseCardsData=null,e.loading=!1,e}return Object(m["a"])(n,[{key:"cardType",get:function(){return ke["b"].Humans}},{key:"displayType",get:function(){return ke["f"].Short}},{key:"cardChangeHandler",value:function(){this.load()}},{key:"mounted",value:function(){var e=Object(u["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.load();case 2:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"load",value:function(){var e=Object(u["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return this.caseCardsData=null,e.prev=1,this.loading=!0,e.next=5,Ye["a"].getLinkedCaseHumanCardsByCardID(this.cardId);case 5:this.caseCardsData=e.sent,e.next=11;break;case 8:e.prev=8,e.t0=e["catch"](1),console.warn("case cards load error",e.t0);case 11:return e.prev=11,this.loading=!1,e.finish(11);case 14:case"end":return e.stop()}}),e,this,[[1,8,11,14]])})));function t(){return e.apply(this,arguments)}return t}()},{key:"getCaseCards",value:function(e){var t,n,a=this,r=null===(t=this.caseCardsData)||void 0===t||null===(n=t.caseParticipants)||void 0===n?void 0:n.filter((function(t){return t.case===e}));if(!r)return[];var c=r.reduce((function(e,t){return Array.isArray(t.related_human_cards)&&(e=e.concat(t.related_human_cards)),e}),[]),o=Array.from(new Set(c));return o.map((function(e){var t;return null===(t=a.caseCardsData)||void 0===t?void 0:t.caseCards.find((function(t){return t.id===e}))})).filter((function(e){return!!e})).filter((function(e){return e.id!=a.cardId}))}},{key:"actionHandler",value:function(e,t){this.$emit("action",e,{item:t})}}]),n}(h["b"]);Object(f["b"])([Object(v["c"])({type:Array,required:!1})],Mt.prototype,"sortTypes",void 0),Object(f["b"])([Object(v["c"])({type:Number,required:!0})],Mt.prototype,"cardId",void 0),Object(f["b"])([Object(v["f"])("cardId")],Mt.prototype,"cardChangeHandler",null),Mt=Object(f["b"])([Object(h["a"])({components:{ExtendedCaseDescription:Rt,CardItem2:Tt["a"],CardItem:It["a"],ParticipantItem:xt["a"],SortDropdown:pt["a"],NButton:st["c"],ObjectItem:bt,DetectionDialog:ft["a"],CameraShotAttach:Ct}})],Mt);var Et=Mt;n("a697");const Lt=ce()(Et,[["render",tt]]);var Dt=Lt;function $t(e,t,n,a,c,o){var i=Object(r["P"])("NDateTimeLabel"),s=Object(r["P"])("NTag"),l=Object(r["P"])("NHint");return Object(r["F"])(),Object(r["g"])(l,{placement:"bottom",class:"cards-sidebar__monitoring-hint",type:"light"},{content:Object(r["eb"])((function(){return[Object(r["m"])(i,{size:"2xs","model-value":e.item.created_date},null,8,["model-value"])]})),default:Object(r["eb"])((function(){return[Object(r["m"])(s,{type:"pink","label-size":"2xs"},{default:Object(r["eb"])((function(){return[Object(r["l"])(Object(r["T"])(e.$t("remote_monitoring.monitoring")),1)]})),_:1})]})),_:1})}var Ut=function(e){Object(b["a"])(n,e);var t=Object(p["a"])(n);function n(){return Object(d["a"])(this,n),t.apply(this,arguments)}return Object(m["a"])(n)}(h["b"]);Object(f["b"])([Object(v["c"])({type:Object,required:!0})],Ut.prototype,"item",void 0),Ut=Object(f["b"])([Object(h["a"])({name:"CardMonitoringStatus",components:{NHint:z["o"],NTag:z["A"],NDateTimeLabel:z["j"]}})],Ut);var Bt=Ut;const qt=ce()(Bt,[["render",$t]]);var Ht=qt,Gt={class:"items-view"},zt={class:"items-view__header"},Wt=Object(r["j"])("div",{class:"items-view__ex"},null,-1),Yt={key:0,class:"items-view__body"},Kt={key:1,class:"items-view__empty"};function Xt(e,t,n,a,c,o){var i=Object(r["P"])("SortDropdown"),s=Object(r["P"])("NButton"),l=Object(r["P"])("CameraShotAttach"),u=Object(r["P"])("ParticipantItem"),d=Object(r["P"])("ObjectItem");return Object(r["F"])(),Object(r["i"])("div",Gt,[Object(r["j"])("div",zt,[e.sortTypes&&e.items.length?(Object(r["F"])(),Object(r["g"])(i,{key:0,items:e.sortTypes,modelValue:e.module.filter.current.ordering,"onUpdate:modelValue":t[0]||(t[0]=function(t){return e.module.filter.current.ordering=t})},null,8,["items","modelValue"])):Object(r["h"])("",!0),Wt,e.uploadFeature&&e.modelAcl.add?(Object(r["F"])(),Object(r["i"])(r["a"],{key:1},[Object(r["m"])(s,{icon:"upload",type:"secondary",onClick:t[1]||(t[1]=function(t){return e.$emit("action","upload-file")})},{default:Object(r["eb"])((function(){return[Object(r["l"])(Object(r["T"])(e.$t("cards.upload_photo","f")),1)]})),_:1}),Object(r["m"])(l,{onAttach:e.attachHandler},null,8,["onAttach"])],64)):Object(r["h"])("",!0)]),e.items.length?(Object(r["F"])(),Object(r["i"])("div",Yt,[e.participants?(Object(r["F"])(!0),Object(r["i"])(r["a"],{key:0},Object(r["N"])(e.items,(function(t){return Object(r["F"])(),Object(r["g"])(u,{key:t.id,item:t,"show-fullframe":!0,"show-case":!0,onClick:function(n){return e.participantClickHandler(t)}},null,8,["item","onClick"])})),128)):(Object(r["F"])(!0),Object(r["i"])(r["a"],{key:1},Object(r["N"])(e.items,(function(n){return Object(r["F"])(),Object(r["g"])(d,{key:n.id,item:n,acl:e.modelAcl,onAction:t[2]||(t[2]=function(t,n){return e.$emit("action",t,n)})},null,8,["item","acl"])})),128))])):e.module.loading?Object(r["h"])("",!0):(Object(r["F"])(),Object(r["i"])("div",Kt,Object(r["T"])(e.$t("common.no_data","f")),1))])}var Jt=n("aa7e"),Zt=function(e){Object(b["a"])(n,e);var t=Object(p["a"])(n);function n(){var e;return Object(d["a"])(this,n),e=t.apply(this,arguments),e.sortTypes=[],e.uploadFeature=!1,e.participants=!1,e.modelAcl={add:!0,view:!0,delete:!0,update:!1},e.participantsItems=[],e}return Object(m["a"])(n,[{key:"items",get:function(){return this.participants?this.participantsItems:this.module.items}},{key:"moduleHandler",value:function(){var e=Object(u["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.load();case 2:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"mounted",value:function(){var e=Object(u["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.load();case 2:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"enrichParticipants",value:function(){var e=Object(u["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(this.participants){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,Object(Jt["a"])(this.module.items,this.participantsItems);case 4:this.participantsItems=e.sent;case 5:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"changeFilterHandler",value:function(e,t){(null===e||void 0===e?void 0:e.page)===t.page&&(null===e||void 0===e?void 0:e.limit)===t.limit&&this.load()}},{key:"load",value:function(){var e=Object(u["a"])(regeneratorRuntime.mark((function e(){var t,n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t=this.module.filter.current,n=t.cluster_in&&t.cluster_in.length&&0===t.cluster_in[0],!n){e.next=4;break}return e.abrupt("return");case 4:return e.next=6,this.module.get();case 6:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"attachHandler",value:function(e){var t=e[0];this.$emit("action",te["b"].Detect,t)}},{key:"participantClickHandler",value:function(e){Nt["a"].navigateToParticipants(e)}}]),n}(h["b"]);Object(f["b"])([Object(v["c"])({type:Object,required:!0})],Zt.prototype,"module",void 0),Object(f["b"])([Object(v["c"])({type:Array,required:!1})],Zt.prototype,"sortTypes",void 0),Object(f["b"])([Object(v["c"])({type:Boolean,required:!1})],Zt.prototype,"uploadFeature",void 0),Object(f["b"])([Object(v["c"])({type:Boolean,required:!1})],Zt.prototype,"participants",void 0),Object(f["b"])([Object(v["c"])({type:Object,default:{add:!0,view:!0,delete:!0,update:!1}})],Zt.prototype,"modelAcl",void 0),Object(f["b"])([Object(v["f"])("module")],Zt.prototype,"moduleHandler",null),Object(f["b"])([Object(v["f"])("module.items")],Zt.prototype,"enrichParticipants",null),Object(f["b"])([Object(v["f"])("module.filter.current",{deep:!0})],Zt.prototype,"changeFilterHandler",null),Zt=Object(f["b"])([Object(h["a"])({components:{ParticipantItem:xt["a"],SortDropdown:pt["a"],NButton:st["c"],ObjectItem:bt,DetectionDialog:ft["a"],CameraShotAttach:Ct}})],Zt);var Qt=Zt;n("9bfc");const en=ce()(Qt,[["render",Xt]]);var tn=en,nn={class:"card-form"};function an(e,t,n,a,c,o){var i=Object(r["P"])("NButton"),s=Object(r["P"])("NForm"),l=Object(r["P"])("NAttachments"),u=Object(r["P"])("BatchLoaderModal");return Object(r["F"])(),Object(r["i"])(r["a"],null,[Object(r["j"])("div",nn,[!e.isCreated&&e.hasBatchUploadPermissions?(Object(r["F"])(),Object(r["i"])(r["a"],{key:0},[Object(r["l"])(Object(r["T"])(e.$t("cards.do_you_have_many_cards"))+" ",1),Object(r["m"])(i,{type:"link",onClick:t[0]||(t[0]=function(t){return e.batchLoader=!0})},{default:Object(r["eb"])((function(){return[Object(r["l"])(Object(r["T"])(e.$t("cards.batch_cards_upload__after_try")),1)]})),_:1})],64)):Object(r["h"])("",!0),Object(r["m"])(s,{ref:"itemForm",layout:e.schema,model:e.item,disabled:e.disabled},null,8,["layout","model","disabled"]),Object(r["m"])(s,{ref:"itemMetaForm",layout:e.metaSchema,model:e.item.meta,disabled:e.disabled},null,8,["layout","model","disabled"]),e.isCreated?(Object(r["F"])(),Object(r["g"])(l,{key:1,"disallow-attach":!e.hasUploadPermission,"disallow-remove":!e.hasUploadPermission,"handle-attach":e.handleAttachmentAttach,"handle-remove":e.handleAttachmentRemove,i18n:e.attachmentLabels,class:"card-form__upload",attachments:e.attachments,"onUpdate:attachments":t[1]||(t[1]=function(t){return e.attachments=t})},null,8,["disallow-attach","disallow-remove","handle-attach","handle-remove","i18n","attachments"])):Object(r["h"])("",!0),e.isCreated?(Object(r["F"])(),Object(r["g"])(s,{key:2,layout:e.infoFields,model:e.item},null,8,["layout","model"])):Object(r["h"])("",!0)]),e.batchLoader?(Object(r["F"])(),Object(r["g"])(u,{key:0,onClose:t[2]||(t[2]=function(t){return e.batchLoader=!1})})):Object(r["h"])("",!0)],64)}var rn={class:"batch-loader"},cn={class:"batch-loader__file"},on={class:"label-xs n-drag-and-drop__label"},sn={class:"batch-loader__dnd-link label-m",for:"files"},ln=Object(r["l"])(" "),un={class:"label-2xs n-drag-and-drop__label"},dn=Object(r["l"])(" "),mn={class:"batch-loader__dnd-link label-m",for:"folder"},bn=Object(r["l"])(),pn=Object(r["j"])("br",null,null,-1),fn={class:"batch-loader__form"},hn={class:"batch-loader__results"},vn={class:"batch-loader__statistics"},jn={class:"label-m"},On={class:"batch-loader_selected"},yn={class:"label-m"},gn={class:"batch-loader_uploaded"},_n={class:"label-m"},kn={class:"batch-loader_errors"};function wn(e,t,n,a,c,o){var i=Object(r["P"])("NButtonGroup"),s=Object(r["P"])("NButton"),l=Object(r["P"])("NAttachments"),u=Object(r["P"])("NForm"),d=Object(r["P"])("NLoadingProgress"),m=Object(r["P"])("BatchLoaderModalResult"),b=Object(r["P"])("NModalWindow");return Object(r["F"])(),Object(r["g"])(b,{layout:!0,customSize:"1000px","close-icon":!0,onClose:t[6]||(t[6]=function(t){return e.$emit("close")})},{header:Object(r["eb"])((function(){return[Object(r["m"])(i,{items:e.dataAssetsModule.eventObjectTypeButtonItems,modelValue:e.objectType,"onUpdate:modelValue":t[0]||(t[0]=function(t){return e.objectType=t}),disabled:e.loading},null,8,["items","modelValue","disabled"]),Object(r["m"])(s,{icon:"close",type:"secondary",round:"",onClick:t[1]||(t[1]=function(t){return e.$emit("close")})})]})),content:Object(r["eb"])((function(){return[Object(r["j"])("div",{class:Object(r["w"])({"batch-loader-modal":e.resultItems.length>=2})},[Object(r["j"])("div",rn,[Object(r["j"])("div",cn,[Object(r["m"])(l,{onAttach:e.uploadDNDHandler,"disallow-attach":"",drag:"","hide-amount":"","hide-attachments":"",multiple:""},{droparea:Object(r["eb"])((function(){return[Object(r["j"])("span",on,Object(r["T"])(e.$t("common.drag_and_drop_files")),1),Object(r["j"])("div",{onClick:t[4]||(t[4]=Object(r["hb"])((function(){}),["stop"])),class:"batch-loader__dnd-text"},[Object(r["j"])("label",sn,Object(r["T"])(e.$t("cards.select_files")),1),ln,Object(r["j"])("span",un,Object(r["T"])(e.$t("cards.or")),1),dn,Object(r["j"])("label",mn,Object(r["T"])(e.$t("cards.select_folder")),1),Object(r["j"])("input",{type:"file",multiple:"",id:"files",onChange:t[2]||(t[2]=function(){return e.uploadHandler&&e.uploadHandler.apply(e,arguments)}),class:"hide-element"},null,32),bn,pn,Object(r["j"])("input",{type:"file",webkitdirectory:"",id:"folder",onChange:t[3]||(t[3]=function(){return e.uploadHandler&&e.uploadHandler.apply(e,arguments)}),class:"hide-element"},null,32)])]})),_:1},8,["onAttach"])]),Object(r["j"])("div",fn,[Object(r["m"])(u,{ref:"itemForm",layout:e.schema,model:e.form,disabled:e.loading},null,8,["layout","model","disabled"])])]),Object(r["j"])("div",hn,[e.resultItems.length?(Object(r["F"])(),Object(r["i"])(r["a"],{key:0},[Object(r["m"])(d,{percent:e.totalStatistics.progress},null,8,["percent"]),Object(r["j"])("div",vn,[Object(r["j"])("div",jn,[Object(r["l"])(Object(r["T"])(e.$t("cards.selected","f"))+": ",1),Object(r["j"])("span",On,Object(r["T"])(e.resultItems.length),1)]),Object(r["j"])("div",yn,[Object(r["l"])(Object(r["T"])(e.$t("cards.uploaded","f"))+": ",1),Object(r["j"])("span",gn,Object(r["T"])(e.totalStatistics.uploaded),1)]),Object(r["j"])("div",_n,[Object(r["l"])(Object(r["T"])(e.$t("cards.errors","f"))+": ",1),Object(r["j"])("span",kn,Object(r["T"])(e.totalStatistics.errors),1)])]),(Object(r["F"])(!0),Object(r["i"])(r["a"],null,Object(r["N"])(e.resultItems,(function(n){return Object(r["F"])(),Object(r["g"])(m,{key:n.file.fileName,item:n,"card-type":e.cardType,onMoveToCard:t[5]||(t[5]=function(t){return e.$emit("close")})},null,8,["item","card-type"])})),128))],64)):Object(r["h"])("",!0),e.finished?Object(r["h"])("",!0):(Object(r["F"])(),Object(r["i"])("div",{key:1,class:Object(r["w"])(["batch-loader__buttons",{"batch-loader_fix":e.resultItems.length}])},[Object(r["m"])(s,{type:"primary",size:"big",onClick:e.batchUpload,disabled:0===e.resultItems.length||e.loading},{default:Object(r["eb"])((function(){return[Object(r["l"])(Object(r["T"])(e.$t("cards.start","f")),1)]})),_:1},8,["onClick","disabled"]),e.loading?(Object(r["F"])(),Object(r["g"])(s,{key:0,type:"secondary",size:"big",onClick:e.pauseUpload},{default:Object(r["eb"])((function(){return[Object(r["l"])(Object(r["T"])(e.$t("cards.pause","f")),1)]})),_:1},8,["onClick"])):Object(r["h"])("",!0)],2))])],2)]})),_:1})}var Cn=n("2909"),xn={class:"batch-loader-result"},Tn=["src"],In={class:"batch-loader-result__info"},An={class:"control-s batch-loader-result__file-name"},Fn={class:"label-xs batch-loader-result__file-size"},Nn={key:1,class:"label-xs"},Sn={class:"label-xs batch-loader-result__cards-ids"};function Vn(e,t,n,a,c,o){var i=Object(r["P"])("NButton");return Object(r["F"])(),Object(r["i"])("div",xn,[Object(r["j"])("img",{src:e.item.file.src,class:"batch-loader-result__image"},null,8,Tn),Object(r["j"])("div",In,[Object(r["j"])("div",An,Object(r["T"])(e.item.file.fileName),1),Object(r["j"])("div",Fn,Object(r["T"])(e.item.file.size),1),e.getStatusBadge(e.item)?(Object(r["F"])(),Object(r["i"])("div",{key:0,class:Object(r["w"])(["label-m batch-loader-result__badge",{"batch-loader-result_error":e.item.statistics.errorCode,"batch-loader-result_success":e.item.statistics.statusCode}])},Object(r["T"])(e.getStatusBadge(e.item)),3)):(Object(r["F"])(),Object(r["i"])("div",Nn,Object(r["T"])(e.$t("cards.in_queue")),1)),Object(r["j"])("div",Sn,[(Object(r["F"])(!0),Object(r["i"])(r["a"],null,Object(r["N"])(e.item.file.cards,(function(t){return Object(r["F"])(),Object(r["g"])(i,{key:t,type:"link",onClick:function(n){return e.goToCard(t)}},{default:Object(r["eb"])((function(){return[Object(r["l"])(Object(r["T"])(e.getResultCardTitle(t)),1)]})),_:2},1032,["onClick"])})),128))])])])}var Pn=function(e){Object(b["a"])(n,e);var t=Object(p["a"])(n);function n(){return Object(d["a"])(this,n),t.apply(this,arguments)}return Object(m["a"])(n,[{key:"getStatusBadge",value:function(e){return console.log("getStatusBadge item",e.statistics.errorCode),"no_objects"===e.statistics.errorCode?this.$t("cards.no_objects","f"):"detection_error"===e.statistics.errorCode?this.$t("cards.detection_error","f"):"success"===e.statistics.statusCode?this.$t("cards.success","f"):""}},{key:"getResultCardTitle",value:function(e){return"".concat(this.$t("common.card","f"),": ").concat(e)}},{key:"goToCard",value:function(e){Nt["a"].navigateToCard(e,this.cardType),this.$emit("move-to-card")}}]),n}(h["b"]);Object(f["b"])([Object(v["c"])({type:Object,required:!0})],Pn.prototype,"item",void 0),Object(f["b"])([Object(v["c"])({type:String,required:!0})],Pn.prototype,"cardType",void 0),Pn=Object(f["b"])([Object(h["a"])({components:{NButton:st["c"]}})],Pn);var Rn=Pn;n("8161");const Mn=ce()(Rn,[["render",Vn]]);var En=Mn,Ln=n("6776"),Dn=n("f35e");function $n(){var e=[[{path:"prefixName",classes:"n-form-w-7 control-m n-form-pad-10",i18n_label:"cards.prefix_name",component:z["q"]},{path:"filenameAsName",classes:"n-form-w-2 n-form-self-align_end control-m n-form-pad-10",component:Ln["a"],props:{i18n_label:"cards.filename_as_name"}},{path:"suffixName",classes:"n-form-w-7 control-m n-form-pad-10",i18n_label:"cards.suffix_name",component:z["q"]}],[{path:"prefixComment",classes:"n-form-w-7 control-m n-form-pad-10",i18n_label:"cards.prefix_comment",component:z["q"]},{path:"filenameAsComment",classes:"n-form-w-2 n-form-self-align_end control-m n-form-pad-10",component:Ln["a"],props:{i18n_label:"cards.filename_as_name"}},{path:"suffixComment",classes:"n-form-w-7  control-m n-form-pad-10",i18n_label:"cards.suffix_comment",component:z["q"]}],{path:"watch_lists",classes:"n-form-w-6  control-m n-form-pad-10",i18n_label:"common.watch_lists",component:z["x"],validators:[{name:"required"}],props:{multiple:!0,color:!0,items:Q["a"].watchListsWithoutUnknown.map((function(e){return{label:e.name,value:e.id,color:"#"+e.color}}))}},[{path:"photo_group",classes:"n-form-w-3 control-m n-form-pad-10",i18n_label:"cards.photo_group",component:z["x"],validators:[{name:"required"}],props:{selectonly:!0,items:[{i18n_label:"cards.reject",value:"reject"},{i18n_label:"cards.biggest",value:"biggest"},{i18n_label:"cards.all",value:"all"}]}},{path:"parallel_upload",classes:"n-form-pad-10",i18n_label:"cards.parallel_upload",component:Dn["b"],props:{items:[{value:2,label:"2"},{value:5,label:"5"},{value:10,label:"10"},{value:20,label:"20"}]}}]];return e}var Un=n("b85c"),Bn=(n("cb29"),n("2b3d"),n("9861"),n("5319"),n("ab42")),qn={filenameAsName:!1,prefixName:"",suffixName:"",filenameAsComment:!1,prefixComment:"",suffixComment:"",watch_lists:[1],photo_group:"reject",parallel_upload:5},Hn={ALL:"all",BIGGEST:"biggest",REJECT:"reject"},Gn=function(e){return(e.bottom-e.top)*(e.right-e.left)},zn=function(e){return e.reduce((function(e,t){return Gn(t.bbox)>Gn(e.bbox)?t:e}))},Wn=function(){function e(t){Object(d["a"])(this,e),this.detectItems=[],this.batchUploaderFormItem=qn,this.filesAsArray=[],this.total_uploaded=0,this.loading=!1,this.paused=!1,this.finished=!1,this.objectType=t}return Object(m["a"])(e,[{key:"dataService",get:function(){return ee["a"]}},{key:"ObjectsFaces",get:function(){return ee["d"].getObjectsFacesItemViewModel()}},{key:"detectionObjectType",get:function(){return ke["l"][this.objectType]}},{key:"cardType",get:function(){return we["a"].getCardTypeByObjectType(this.objectType)}},{key:"currentUserLogin",get:function(){var e;return null===(e=Q["a"].currentUserModule.item)||void 0===e?void 0:e.name}},{key:"parallelRequestAmount",get:function(){return new Array(this.batchUploaderFormItem.parallel_upload).fill(0)}},{key:"nameForBatchUpload",get:function(){return this.currentUserLogin+"-"+1e3*(new Date).getTime()+Math.floor(1e3*Math.random())}},{key:"formState",set:function(e){this.batchUploaderFormItem=e}},{key:"progress",get:function(){return 100*this.total_uploaded/this.detectItems.length}},{key:"totalErrors",get:function(){return this.detectItems.filter((function(e){return!!e.statistics.errorCode})).length}},{key:"total",get:function(){return{uploaded:this.total_uploaded,errors:this.totalErrors,progress:this.progress}}},{key:"addFiles",value:function(e){this.finished=!1;var t=e.map((function(e){return{file:{blob:e,src:URL.createObjectURL(e),fileName:e.name,size:Object(Bn["formatFileSize"])(e.size,!0),cards:[]},statistics:{statusCode:"",errorCode:""}}}));this.detectItems=t,this.filesAsArray=Object(Cn["a"])(t)}},{key:"upload",value:function(){var e=Object(u["a"])(regeneratorRuntime.mark((function e(){var t=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Te["c"].batchUploadCreate({name:this.nameForBatchUpload});case 2:this.upload_list=e.sent,this.loading=!0,Promise.all(this.parallelRequestAmount.map((function(){return t.startProcess()}))).finally((function(){t.loading=!1,t.finished=!0}));case 5:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"startProcess",value:function(){var e=Object(u["a"])(regeneratorRuntime.mark((function e(){var t,n,a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(0!==this.filesAsArray.length&&!this.paused){e.next=2;break}return e.abrupt("return",Promise.resolve(!0));case 2:if(t=this.filesAsArray.shift(),e.prev=3,e.t0=t.file,!e.t0){e.next=9;break}return e.next=8,this.detect(t);case 8:e.t0=e.sent;case 9:return n=e.t0,a=this.checkGroupPhoto(n),e.next=13,this.createCardsWithObjects(a,t);case 13:e.next=18;break;case 15:e.prev=15,e.t1=e["catch"](3),t.statistics.errorCode=e.t1.message;case 18:return e.abrupt("return",this.startProcess());case 19:case"end":return e.stop()}}),e,this,[[3,15]])})));function t(){return e.apply(this,arguments)}return t}()},{key:"createCardsWithObjects",value:function(){var e=Object(u["a"])(regeneratorRuntime.mark((function e(t,n){var a,r,c,o,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:a=Object(Un["a"])(t),e.prev=1,a.s();case 3:if((r=a.n()).done){e.next=23;break}return c=r.value,o=t.indexOf(c),e.next=8,this.createCard(n.file.fileName,o);case 8:return i=e.sent,e.prev=9,e.next=12,this.addObjectToCard({card:i.id,source_photo:n.file.blob,detect_id:c.id});case 12:this.total_uploaded+=1,n.file.cards.push(i.id),n.statistics.statusCode="success",e.next=21;break;case 17:return e.prev=17,e.t0=e["catch"](9),e.next=21,this.deleteCard(i.id);case 21:e.next=3;break;case 23:e.next=28;break;case 25:e.prev=25,e.t1=e["catch"](1),a.e(e.t1);case 28:return e.prev=28,a.f(),e.finish(28);case 31:case"end":return e.stop()}}),e,this,[[1,25,28,31],[9,17]])})));function t(t,n){return e.apply(this,arguments)}return t}()},{key:"detect",value:function(){var e=Object(u["a"])(regeneratorRuntime.mark((function e(t){var n,r,c;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return n=t.file,r={objects:{}},c={photo:n.blob,attributes:Object(Ge["a"])({},this.detectionObjectType,{})},e.prev=3,e.next=6,Te["l"].detectCreate(c);case 6:r=e.sent,e.next=12;break;case 9:throw e.prev=9,e.t0=e["catch"](3),new Error("detection_error");case 12:return e.abrupt("return",0!==Object.keys(r.objects).length?Object(a["a"])({},r.objects):null);case 13:case"end":return e.stop()}}),e,this,[[3,9]])})));function t(t){return e.apply(this,arguments)}return t}()},{key:"createCard",value:function(){var e=Object(u["a"])(regeneratorRuntime.mark((function e(t,n){var a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:a=this.prepareFormData(t,n),e.t0=this.cardType,e.next=e.t0===ke["b"].Humans?4:e.t0===ke["b"].Cars?5:6;break;case 4:return e.abrupt("return",Te["h"].cardsHumansCreate(a));case 5:return e.abrupt("return",Te["h"].cardsCarsCreate(a));case 6:case"end":return e.stop()}}),e,this)})));function t(t,n){return e.apply(this,arguments)}return t}()},{key:"deleteCard",value:function(){var e=Object(u["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:e.t0=this.cardType,e.next=e.t0===ke["b"].Humans?3:e.t0===ke["b"].Cars?4:5;break;case 3:return e.abrupt("return",Te["h"].cardsHumansDestroy(t));case 4:return e.abrupt("return",Te["h"].cardsCarsDestroy(t));case 5:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"addObjectToCard",value:function(){var e=Object(u["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:e.t0=this.detectionObjectType,e.next=e.t0===Re["a"].Face?3:e.t0===Re["a"].Body?4:e.t0===Re["a"].Car?5:6;break;case 3:return e.abrupt("return",Te["p"].objectsFacesCreate(t));case 4:return e.abrupt("return",Te["p"].objectsBodiesCreate(t));case 5:return e.abrupt("return",Te["p"].objectsCarsCreate(t));case 6:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"prepareFormData",value:function(e,t){return{name:this.getName(e)+(t>0?"_".concat(t):""),comment:this.getComment(e),watch_lists:this.batchUploaderFormItem.watch_lists,active:!0,upload_list:this.upload_list.id}}},{key:"getPurifiedFileName",value:function(e){return e.replace(/\.[^/.]+$/,"")}},{key:"getComment",value:function(e){return this.batchUploaderFormItem.prefixComment+(this.batchUploaderFormItem.filenameAsComment?this.getPurifiedFileName(e):"")+this.batchUploaderFormItem.suffixComment}},{key:"getName",value:function(e){return this.batchUploaderFormItem.prefixName+(this.batchUploaderFormItem.filenameAsName?this.getPurifiedFileName(e):Math.round(1e12*Math.random()).toString())+this.batchUploaderFormItem.suffixName}},{key:"checkGroupPhoto",value:function(e){var t=this.batchUploaderFormItem.photo_group,n=e[this.detectionObjectType],a=n.filter((function(e){var t=e.low_quality;return!t}));if(0===a.length)throw new Error("no_objects");if(t===Hn.ALL||1===a.length)return a;if(t===Hn.REJECT&&a.length>1)throw new Error("detection_error");return t===Hn.BIGGEST?[zn(a)]:void 0}}]),e}(),Yn=function(e){return new Wn(e)},Kn={class:"progress"};function Xn(e,t,n,a,c,o){return Object(r["F"])(),Object(r["i"])("div",Kn,[Object(r["j"])("div",{class:"progress__inner",style:Object(r["y"])({width:"".concat(e.percent,"%")})},null,4)])}var Jn=Object(r["n"])({name:"NLoadingProgress",props:{percent:{type:Number,default:0}}});n("f63d");const Zn=ce()(Jn,[["render",Xn]]);var Qn=Zn,ea=n("563a"),ta=n("4f29"),na=function(e){Object(b["a"])(n,e);var t=Object(p["a"])(n);function n(){var e;return Object(d["a"])(this,n),e=t.apply(this,arguments),e.form=qn,e.objectType="faces",e.logs={},e.files=[],e.startingTimeout=!1,e.dndResult=[],e}return Object(m["a"])(n,[{key:"batchModule",get:function(){return Object(r["K"])(Yn(this.objectType))}},{key:"schema",get:function(){return $n()}},{key:"dataAssetsModule",get:function(){return we["a"]}},{key:"resultItems",get:function(){return this.batchModule.detectItems}},{key:"totalStatistics",get:function(){return this.batchModule.total}},{key:"cardType",get:function(){return this.dataAssetsModule.getCardTypeByObjectType(this.objectType)}},{key:"loading",get:function(){return this.batchModule.loading}},{key:"finished",get:function(){return this.batchModule.finished}},{key:"uploadHandler",value:function(e){var t=e.target;t&&t.files&&(this.batchModule.addFiles(Array.from(t.files)),t.value="")}},{key:"uploadDNDHandler",value:function(e){var t,n=this;(t=this.dndResult).push.apply(t,Object(Cn["a"])(e.map((function(e){return e.file})))),this.startingTimeout||(this.startingTimeout=!0,setTimeout((function(){n.files=n.dndResult,n.startingTimeout=!1}),500))}},{key:"handlerFiles",value:function(e,t){this.batchModule.addFiles(e)}},{key:"batchUpload",value:function(){this.batchModule.paused=!1,this.batchModule.formState=this.form,this.batchModule.upload()}},{key:"pauseUpload",value:function(){this.batchModule.paused=!0,this.batchModule.loading=!1}},{key:"showLogs",value:function(){var e=Object(u["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Te["c"].batchUploadList();case 2:this.logs=e.sent;case 3:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()}]),n}(h["b"]);Object(f["b"])([Object(v["f"])("files")],na.prototype,"handlerFiles",null),na=Object(f["b"])([Object(h["a"])({components:{BatchLoaderModalResult:En,NAttachments:ta["a"],NButton:st["c"],NButtonGroup:Dn["b"],NForm:be["b"],NLoadingProgress:Qn,NModalWindow:ea["b"]}})],na);var aa=na;n("e9c41");const ra=ce()(aa,[["render",wn]]);var ca=ra,oa={class:"card-form-first-objects"};function ia(e,t,n,a,c,o){var i=Object(r["P"])("NThumbnail");return Object(r["F"])(),Object(r["i"])("div",oa,[(Object(r["F"])(!0),Object(r["i"])(r["a"],null,Object(r["N"])(e.items,(function(t,n){return Object(r["F"])(),Object(r["i"])(r["a"],null,[null!==t&&void 0!==t&&t.thumbnail?(Object(r["F"])(),Object(r["g"])(i,{key:n,class:"card-form-first-objects__item",modelValue:t.thumbnail,onClick:function(n){return e.showFullscreen(t)}},null,8,["modelValue","onClick"])):Object(r["h"])("",!0)],64)})),256))])}var sa=function(e){Object(b["a"])(n,e);var t=Object(p["a"])(n);function n(){var e;return Object(d["a"])(this,n),e=t.apply(this,arguments),e.objectModels=[],e}return Object(m["a"])(n,[{key:"items",get:function(){return this.objectModels.map((function(e){return e.items[0]}))}},{key:"availableObjectsMap",get:function(){return we["a"].availableObjectsMap}},{key:"isAllowedId",get:function(){return this.modelValue>0}},{key:"initObjectModels",value:function(){var e=Object(u["a"])(regeneratorRuntime.mark((function e(){var t,n,a,r,c;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(this.objectModels=[],this.isAllowedId){e.next=3;break}return e.abrupt("return");case 3:t=this.cardType===ke["b"].Humans?["faces","bodies"]:["cars"],n=0,a=t;case 5:if(!(n<a.length)){e.next=15;break}if(r=a[n],!(ke["l"][r]in this.availableObjectsMap)){e.next=12;break}return c=Ye["a"].getObjectsLVMByCardID({id:this.modelValue,limit:1,type:r,ordering:"id",autoload:!1}),e.next=11,c.get();case 11:this.objectModels.push(c);case 12:n++,e.next=5;break;case 15:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"showFullscreen",value:function(e){xe["a"].run(te["b"].ShowFullScreen,e)}}]),n}(h["b"]);Object(f["b"])([Object(v["c"])({type:Number,required:!0})],sa.prototype,"modelValue",void 0),Object(f["b"])([Object(v["c"])({type:String,required:!0})],sa.prototype,"cardType",void 0),Object(f["b"])([Object(v["f"])("modelValue",{immediate:!0})],sa.prototype,"initObjectModels",null),sa=Object(f["b"])([Object(h["a"])({name:"CardFormFirstObjects",components:{NThumbnail:pe["a"],ObjectItem:bt},emits:["action"]})],sa);var la=sa;n("44bd");const ua=ce()(la,[["render",ia]]);var da=ua,ma=n("732f");function ba(e){var t=e===ke["b"].Humans,n={path:"license_plate_number",classes:"n-form-w-6  control-m n-form-pad-10",i18n_label:"cards.license_plate",component:z["q"]},a=[{path:"id",classes:"n-form-w-6  control-m n-form-pad-10",component:da,props:{cardType:e}},{path:"name",classes:"n-form-w-6  control-m n-form-pad-10",i18n_label:"cards.name",component:z["q"],validators:[{name:"required"}]},{path:"watch_lists",classes:"n-form-w-6  control-m n-form-pad-10",i18n_label:"common.watch_lists",component:z["x"],validators:[{name:"required"}],props:{multiple:!0,multiline:!0,color:!0,items:Q["a"].watchListsWithoutUnknown.map((function(e){return{label:e.name,value:e.id,color:"#"+e.color}}))}},t?null:n,{path:"comment",classes:"n-form-w-6  control-m n-form-pad-10",i18n_label:"common.comment",component:ma["a"]},{path:"active",classes:"n-form-w-6  control-m n-form-pad-10",component:Ln["a"],props:{i18n_label:"cards.active"}}];return a.filter((function(e){return!!e}))}var pa=n("551c"),fa=function(e){Object(b["a"])(n,e);var t=Object(p["a"])(n);function n(){var e;return Object(d["a"])(this,n),e=t.apply(this,arguments),e.disabled=!1,e.attachments=[],e.batchLoader=!1,e}return Object(m["a"])(n,[{key:"form",get:function(){return this.$refs.itemForm}},{key:"infoFields",get:function(){return Object(me["b"])()}},{key:"attachmentModule",get:function(){return new pa["a"]({url:"/".concat(ke["c"][this.cardType],"-card-attachments/"),source_id:this.item.id,source_form_field_name:"card",source_filter_name:"card"})}},{key:"attachmentLabels",get:function(){return{attach_first_one:this.$t("common.attach_first_one"),attach_more:this.$t("common.attach_more"),cancel:this.$t("common.cancel","f"),files:this.$tm("common.files_mf",{count:this.attachments.length}),no_files:this.$t("common.no_files"),removing_confirmation:this.$t("common.removing_confirmation"),yes:this.$t("common.yes","f")}}},{key:"schema",get:function(){return ba(this.cardType)}},{key:"metaSchema",get:function(){var e=ze["a"].getMetaFormItemsByTab(We["a"].Info,this.cardType);return e}},{key:"isCreated",get:function(){return this.item.id>0}},{key:"hasUploadPermission",get:function(){var e=ke["c"][this.cardType];return Ke["f"].getAccess("ffsecurity.change_".concat(e,"card"))}},{key:"hasBatchUploadPermissions",get:function(){return Ke["f"].getAccess("ffsecurity.batchupload_cards")&&Ke["f"].getAccess("ffsecurity.add_uploadlist")}},{key:"changeItemHandler",value:function(){this.isCreated&&this.attachmentModule.loadAttachments()}},{key:"handleAttachmentsChange",value:function(e){this.attachments=e.map((function(e){var t;return{file:e.file,id:e.id,name:null!==(t=e.name)&&void 0!==t?t:"",progress:100,size:e.size,status:"done"}}))}},{key:"mounted",value:function(){this.isCreated&&this.attachmentModule.loadAttachments()}},{key:"handleAttachmentAttach",value:function(e,t){this.attachmentModule.uploadAttachmentHandler(e).finally(t)}},{key:"handleAttachmentRemove",value:function(e,t){this.attachmentModule.deleteAttachmentHandler(e).finally(t)}}]),n}(h["b"]);Object(f["b"])([Object(v["c"])({type:Object,required:!0})],fa.prototype,"item",void 0),Object(f["b"])([Object(v["c"])({type:Boolean,required:!0})],fa.prototype,"disabled",void 0),Object(f["b"])([Object(v["c"])({type:String,required:!0})],fa.prototype,"cardType",void 0),Object(f["b"])([Object(v["f"])("item.id")],fa.prototype,"changeItemHandler",null),Object(f["b"])([Object(v["f"])("attachmentModule.module.items",{immediate:!0})],fa.prototype,"handleAttachmentsChange",null),fa=Object(f["b"])([Object(h["a"])({components:{BatchLoaderModal:ca,NAttachments:ta["a"],NButton:st["c"],NForm:z["n"]}})],fa);var ha=fa;n("79e5");const va=ce()(ha,[["render",an]]);var ja=va,Oa=n("8ad5"),ya=n("4440"),ga=n("14c1");function _a(e,t,n,a,c,o){var i,s=Object(r["P"])("NButton"),l=Object(r["P"])("MultisidebarActions");return e.saveAvailable&&null!==(i=e.sidebarItem)&&void 0!==i&&i.model.hasChanges?(Object(r["F"])(),Object(r["g"])(l,{key:0},{default:Object(r["eb"])((function(){return[Object(r["m"])(s,{class:"multisidebar-actions__save",onAction:e.save,size:"big",loading:e.sidebarItem.model.loading},{default:Object(r["eb"])((function(){return[Object(r["l"])(Object(r["T"])(e.$t("common.save","f")),1)]})),_:1},8,["onAction","loading"]),Object(r["m"])(s,{onAction:e.discard,type:"link",size:"big",disabled:e.sidebarItem.model.loading},{default:Object(r["eb"])((function(){return[Object(r["l"])(Object(r["T"])(e.$t("common.discard","f")),1)]})),_:1},8,["onAction","disabled"])]})),_:1})):Object(r["h"])("",!0)}var ka={class:"multisidebar-actions"};function wa(e,t,n,a,c,o){return Object(r["F"])(),Object(r["i"])("div",ka,[Object(r["O"])(e.$slots,"default")])}var Ca=function(e){Object(b["a"])(n,e);var t=Object(p["a"])(n);function n(){return Object(d["a"])(this,n),t.apply(this,arguments)}return Object(m["a"])(n)}(h["b"]);Ca=Object(f["b"])([Object(h["a"])({name:"MultisidebarActions"})],Ca);var xa=Ca;n("01956");const Ta=ce()(xa,[["render",wa]]);var Ia=Ta,Aa=function(e){Object(b["a"])(n,e);var t=Object(p["a"])(n);function n(){return Object(d["a"])(this,n),t.apply(this,arguments)}return Object(m["a"])(n,[{key:"saveAvailable",get:function(){return this.sidebarItem.model.isNew?this.modelAcl.add:this.itemAcl.update&&this.modelAcl.update}},{key:"save",value:function(){xe["a"].run(te["b"].Save,this.sidebarItem)}},{key:"discard",value:function(){xe["a"].run(te["b"].Reset,this.sidebarItem)}}]),n}(h["b"]);Object(f["b"])([Object(v["c"])({type:Object,required:!0})],Aa.prototype,"sidebarItem",void 0),Object(f["b"])([Object(v["c"])({type:Object,default:function(){return Object(a["a"])({},Ke["e"])}})],Aa.prototype,"modelAcl",void 0),Object(f["b"])([Object(v["c"])({type:Object,default:function(){return Object(a["a"])({},Ke["d"])}})],Aa.prototype,"itemAcl",void 0),Aa=Object(f["b"])([Object(h["a"])({name:"MultisidebarSaveActions",components:{MultisidebarActions:Ia,NButton:st["c"]},emits:["action"]})],Aa);var Fa=Aa;n("1757");const Na=ce()(Fa,[["render",_a]]);var Sa=Na,Va={class:"cards-duplicate-dialog"},Pa={class:"cards-duplicate-dialog__duplicate"},Ra={class:"cards-duplicate-dialog__cards"};function Ma(e,t,n,a,c,o){var i=Object(r["P"])("ThumbnailItem"),s=Object(r["P"])("NButton"),l=Object(r["P"])("CardItemTile"),u=Object(r["P"])("NModalWindow");return Object(r["F"])(),Object(r["g"])(u,{label:e.$t("cards.duplicate","f"),onClose:t[1]||(t[1]=function(t){return e.$emit("close")}),size:"medium"},{content:Object(r["eb"])((function(){return[Object(r["j"])("div",Va,[Object(r["j"])("p",null,Object(r["T"])(e.$t("cards.duplicate_card","f")),1),Object(r["j"])("div",Pa,[Object(r["m"])(i,{item:{thumbnail:e.image}},null,8,["item"]),Object(r["m"])(s,{type:"secondary",onClick:t[0]||(t[0]=function(t){return e.$emit("addToCard")})},{default:Object(r["eb"])((function(){return[Object(r["l"])(Object(r["T"])(e.$t("cards.ignore_this_warning","f")),1)]})),_:1})]),Object(r["j"])("div",Ra,[(Object(r["F"])(!0),Object(r["i"])(r["a"],null,Object(r["N"])(e.cards,(function(t){return Object(r["F"])(),Object(r["i"])("div",{class:"cards-duplicate-dialog__card",key:t.id},[Object(r["m"])(l,{type:e.cardType,item:t,"show-short-comment":"",selectable:!1,hoverable:!1},null,8,["type","item"]),Object(r["m"])(s,{type:"secondary",onClick:function(n){return e.$emit("addToCard",t.id)}},{default:Object(r["eb"])((function(){return[Object(r["l"])(Object(r["T"])(e.$t("cards.add_photo_to_existing_card","f")),1)]})),_:2},1032,["onClick"])])})),128))])])]})),_:1},8,["label"])}var Ea=n("21af"),La=n("a370"),Da=function(e){Object(b["a"])(n,e);var t=Object(p["a"])(n);function n(){var e;return Object(d["a"])(this,n),e=t.apply(this,arguments),e.cardType="",e}return Object(m["a"])(n)}(h["b"]);Object(f["b"])([Object(v["c"])({type:String})],Da.prototype,"image",void 0),Object(f["b"])([Object(v["c"])({type:Array})],Da.prototype,"cards",void 0),Object(f["b"])([Object(v["c"])({type:String})],Da.prototype,"cardType",void 0),Da=Object(f["b"])([Object(h["a"])({name:"CardsDuplicateDialog",components:{ThumbnailItem:La["a"],NButton:st["c"],CardItemTile:Ea["a"],NModalWindow:ea["b"]}})],Da);var $a=Da;n("3211");const Ua=ce()($a,[["render",Ma]]);var Ba=Ua,qa=function(e){Object(b["a"])(n,e);var t=Object(p["a"])(n);function n(){var e;return Object(d["a"])(this,n),e=t.apply(this,arguments),e.tabName=We["a"].Info,e.showDetectionDialog=!1,e.showDuplicateDialog=!1,e.file=null,e.cardsDuplicate={cards:[],thumbnail:"",detection:[]},e.faceObjectsVM=null,e.bodyObjectsVM=null,e.carObjectsVM=null,e.faceClusterEventsVM=null,e.bodyClusterEventsVM=null,e.carClusterEventsVM=null,e.participantsVM=null,e.thumbnailsMap={},e.items=[],e}return Object(m["a"])(n,[{key:"disabled",get:function(){return!(this.module.isNew?this.modelAcl.add:this.modelAcl.update)}},{key:"TabItemsMap",get:function(){return We["a"]}},{key:"tabsItems",get:function(){var e=ze["a"].getCardTabsItems(this.cardType);return this.currentItem&&this.currentItem.id>0?e:e.slice(0,1)}},{key:"currentItem",get:function(){return this.module.item}},{key:"module",get:function(){return this.sidebarItem.model}},{key:"cardType",get:function(){return this.sidebarItem.type.split("_")[1]}},{key:"itemsSortTypes",get:function(){var e=this;return we["a"].getSortTypes({id:!0}).map((function(t){return Object(a["a"])(Object(a["a"])({},t),{},{label:e.$t(t.i18n_label)})}))}},{key:"isMetaTab",get:function(){var e=this;return!!ze["a"].getMetaTabs(this.cardType).find((function(t){return t.value===e.tabName}))}},{key:"metaTabFormSchema",get:function(){return this.isMetaTab?ze["a"].getMetaFormItemsByTab(this.tabName,this.cardType):null}},{key:"monitoringModule",get:function(){return ya["a"]}},{key:"isPuppeteerEnabled",get:function(){return this.cardType===ke["b"].Humans&&this.monitoringModule.isPuppeteerEnabled}},{key:"currentItemMonitoringRecord",get:function(){var e=this.isPuppeteerEnabled&&this.currentItem&&this.monitoringModule.getItemsByCardId(this.currentItem.id)[0];return e||null}},{key:"headerActions",get:function(){var e;return i["b"].getItemActions(this.modelAcl,null,{hasSearch:!0,hasCardFilterEvent:!0,hasActive:!0,hasDelete:!0,currentActive:null===(e=this.currentItem)||void 0===e?void 0:e.active,hasPuppeteer:!0,hasChanges:this.module.hasChanges,hasInteractions:this.cardType===ke["b"].Humans,hasPuppeteerMonitoringRecord:!!this.currentItemMonitoringRecord}).map(i["b"].computeActionByName)}},{key:"objectType",get:function(){var e=this.tabName.split("_")[0];return Object(Ge["a"])({},e,we["a"].detectFeatures[e])}},{key:"loadCurrentItemModules",value:function(){var e,t=this.currentItem||{},n=t.id,a=t.face_cluster,r=t.body_cluster,c=t.car_cluster;if(n&&!(n<=0))switch(this.cardType){case ke["b"].Humans:this.faceObjectsVM=Ye["a"].getObjectsLVMByCardID({id:n,type:"faces",autoload:!1}),this.faceClusterEventsVM=Ye["a"].getClusterEventsLVMByClusterID({id:a,type:"faces",autoload:!1}),this.bodyObjectsVM=Ye["a"].getObjectsLVMByCardID({id:n,type:"bodies",autoload:!1}),this.bodyClusterEventsVM=Ye["a"].getClusterEventsLVMByClusterID({id:r,type:"bodies",autoload:!1}),this.participantsVM=ee["d"].getCaseParticipantsListViewModel(),this.participantsVM.filter.current.limit=1e3,this.participantsVM.filter.current.ordering="-id",this.participantsVM.filter.current.related_human_card=null===(e=this.currentItem)||void 0===e?void 0:e.id;break;case ke["b"].Cars:this.carObjectsVM=Ye["a"].getObjectsLVMByCardID({id:n,type:"cars",autoload:!1}),this.carClusterEventsVM=Ye["a"].getClusterEventsLVMByClusterID({id:c,type:"cars",autoload:!1});break}}},{key:"itemIDHandler",value:function(e){e<-1e3&&(this.tabName=We["a"].Info)}},{key:"itemsModule",get:function(){switch(this.tabName){case We["a"].FaceObjects:return this.faceObjectsVM;case We["a"].BodyObjects:return this.bodyObjectsVM;case We["a"].CarObjects:return this.carObjectsVM;case We["a"].FaceClusterEvents:return this.faceClusterEventsVM;case We["a"].BodyClusterEvents:return this.bodyClusterEventsVM;case We["a"].CarClusterEvents:return this.carClusterEventsVM;case We["a"].HumanParticipants:return this.participantsVM}return null}},{key:"tabModelAcl",get:function(){switch(this.tabName){case We["a"].FaceObjects:return Ke["f"].getModelAclByName(Ke["a"].FaceObject);case We["a"].BodyObjects:return Ke["f"].getModelAclByName(Ke["a"].BodyObject);case We["a"].CarObjects:return Ke["f"].getModelAclByName(Ke["a"].CarObject);case We["a"].FaceClusterEvents:return Ke["f"].getModelAclByName(Ke["a"].FaceCluster);case We["a"].BodyClusterEvents:return Ke["f"].getModelAclByName(Ke["a"].BodyCluster);case We["a"].CarClusterEvents:return Ke["f"].getModelAclByName(Ke["a"].CarCluster)}}},{key:"uploadFeature",get:function(){switch(this.tabName){case We["a"].FaceObjects:case We["a"].BodyObjects:case We["a"].CarObjects:return!0}return!1}},{key:"addPhotoToCard",value:function(){var e=Object(u["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!t){e.next=5;break}return e.next=3,this.actionHandler("upload",{file:this.file,detection:this.cardsDuplicate.detection,id:t});case 3:e.next=7;break;case 5:return e.next=7,this.actionHandler("upload",{file:this.file,detection:this.cardsDuplicate.detection});case 7:this.sendUpdateEvent();case 8:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"sendUpdateEvent",value:function(){ga["b"].sendUpdate(this.sidebarItem.type,this.sidebarItem.model.item)}},{key:"applyDetection",value:function(){var e=Object(u["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return this.showDetectionDialog=!1,this.cardsDuplicate.detection=t,this.cardsDuplicate.thumbnail=t[0].thumbnail,e.next=5,this.hasDuplicate(t[0]);case 5:if(!e.sent){e.next=9;break}this.showDuplicateDialog=!0,e.next=10;break;case 9:this.addPhotoToCard();case 10:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"hasDuplicate",value:function(){var e=Object(u["a"])(regeneratorRuntime.mark((function e(t){var n,a,r=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return n=t.meta.id,this.cardsModule.filter.current.looks_like="detection:".concat(n),e.next=4,this.cardsModule.get();case 4:return a=this.cardsModule.items.filter((function(e){var t;return e.id!==(null===(t=r.currentItem)||void 0===t?void 0:t.id)})),this.cardsDuplicate.cards=a,e.abrupt("return",a.length>0);case 7:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"cardsModule",get:function(){switch(this.cardType){case ke["b"].Cars:return ee["d"].getCardsCarsListViewModel();case ke["b"].Humans:default:return ee["d"].getCardsHumansListViewModel()}}},{key:"setFile",value:function(e){var t=e.target.files&&e.target.files[0];this.$refs.fileInput.value=null,this.actionHandler("detect",t)}},{key:"itemActionHandler",value:function(){var e=Object(u["a"])(regeneratorRuntime.mark((function e(t,n){var a,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:e.t0=t,e.next=e.t0===te["b"].Remove?3:9;break;case 3:return e.next=5,null===(a=this.itemsModule)||void 0===a?void 0:a.delete(n.id);case 5:return e.next=7,null===(r=this.itemsModule)||void 0===r?void 0:r.get();case 7:return this.sendUpdateEvent(),e.abrupt("break",10);case 9:this.actionHandler(t,n);case 10:case"end":return e.stop()}}),e,this)})));function t(t,n){return e.apply(this,arguments)}return t}()},{key:"actionHandler",value:function(){var e=Object(u["a"])(regeneratorRuntime.mark((function e(t,n){var a,r,c,o,i,s;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t!==te["b"].Detect){e.next=4;break}return this.file=n,this.showDetectionDialog=!0,e.abrupt("return");case 4:if(t!==te["b"].UploadFile){e.next=7;break}return null===(a=this.$refs.fileInput)||void 0===a||a.click(),e.abrupt("return");case 7:if(t!==te["b"].ShowInteractions){e.next=10;break}return Nt["a"].navigateToInteractions({card:n.model.item.id}),e.abrupt("return");case 10:if(t!==te["b"].Upload){e.next=23;break}return i=new FormData,s=n.id?n.id:(null===(r=this.currentItem)||void 0===r?void 0:r.id)||"",i.append("source_photo",n.file),i.append("detect_id",n.detection[0].meta.id),i.append("card",String(s)),e.next=18,null===(c=this.itemsModule)||void 0===c?void 0:c.dataService.create(i);case 18:return e.next=20,null===(o=this.itemsModule)||void 0===o?void 0:o.get();case 20:return ga["b"].sendCreate(this.sidebarItem.type),this.showDuplicateDialog=!1,e.abrupt("return");case 23:return e.next=25,xe["a"].run(t,n);case 25:case"end":return e.stop()}}),e,this)})));function t(t,n){return e.apply(this,arguments)}return t}()},{key:"validateForm",value:function(){var e,t=null===(e=this.$refs.cardFormInstance)||void 0===e?void 0:e.form,n=!t||t.validate();return n||t.displayErrors(),n}},{key:"created",value:function(){this.loadCurrentItemModules(),xe["a"].getIsItemFormValid=this.validateForm.bind(this)}}]),n}(h["b"]);Object(f["b"])([Object(v["c"])({type:Object,required:!0})],qa.prototype,"sidebarItem",void 0),Object(f["b"])([Object(v["c"])({type:Object})],qa.prototype,"modelAcl",void 0),Object(f["b"])([Object(v["f"])("currentItem")],qa.prototype,"loadCurrentItemModules",null),Object(f["b"])([Object(v["f"])("currentItem.id")],qa.prototype,"itemIDHandler",null),qa=Object(f["b"])([Object(h["a"])({name:"CardsSidebar",components:{CardsDuplicateDialog:Ba,MultisidebarSaveActions:Sa,CaseCardsView:Dt,CardMonitoringStatus:Ht,ItemsView:tn,CardForm:ja,SidebarHeader:j["a"],SidebarTab:Oa["a"],NTabs:z["z"],NForm:z["n"],DetectionDialog:ft["a"]}})],qa);var Ha=qa;const Ga=ce()(Ha,[["render",He]]);var za=Ga;function Wa(e){return Ya.apply(this,arguments)}function Ya(){return Ya=Object(u["a"])(regeneratorRuntime.mark((function e(t){var n,a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return a=function(){var e=Object(u["a"])(regeneratorRuntime.mark((function e(){var n,a,r,c,o,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(a=null===(n=t.model.item)||void 0===n?void 0:n.id,!(a&&a>0)){e.next=9;break}return o=we["a"].getObjectTypeByCardType(t.type===Pe["c"].CardsHumans?"humans":"cars"),i=Ye["a"].getObjectsLVMByCardID({id:a,limit:1,type:o,ordering:"id",autoload:!1}),e.next=6,i.get();case 6:return e.abrupt("return",null!==(r=null===(c=i.items[0])||void 0===c?void 0:c.thumbnail)&&void 0!==r?r:"");case 9:return e.abrupt("return","");case 10:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),e.abrupt("return",{label:(null===(n=t.model.item)||void 0===n?void 0:n.name)||"",thumbnailSrc:a});case 2:case"end":return e.stop()}}),e)}))),Ya.apply(this,arguments)}var Ka=n("2d6e"),Xa={class:"external-vms-sidebar"};function Ja(e,t,n,a,c,o){var i=Object(r["P"])("SidebarHeader"),s=Object(r["P"])("NTabs"),l=Object(r["P"])("MultisidebarSaveActions");return Object(r["F"])(),Object(r["i"])("div",Xa,[Object(r["m"])(i,{actions:e.headerActions,changed:e.module.hasChanges,label:e.currentItem.verbose_name||e.currentItem.name,"model-acl":e.modelAcl,onAction:t[0]||(t[0]=function(t){return e.actionHandler(t,e.sidebarItem)}),class:"external-vms-sidebar__header"},null,8,["actions","changed","label","model-acl"]),e.info?(Object(r["F"])(),Object(r["g"])(s,{key:0,items:e.tabItems,modelValue:e.tabName,"onUpdate:modelValue":t[1]||(t[1]=function(t){return e.tabName=t}),class:"control-m external-vms-sidebar__tabs"},null,8,["items","modelValue"])):Object(r["h"])("",!0),e.info?(Object(r["F"])(),Object(r["g"])(Object(r["R"])(e.mainComponent),{key:1,config:e.currentItemConfig,info:e.info,item:e.currentItem,class:"external-vms-sidebar__content"},null,8,["config","info","item"])):Object(r["h"])("",!0),Object(r["m"])(l,{"sidebar-item":e.sidebarItem,"model-acl":e.modelAcl},null,8,["sidebar-item","model-acl"])])}function Za(e,t,n,a,c,o){var i=Object(r["P"])("NForm");return Object(r["F"])(),Object(r["g"])(i,{layout:e.layout,model:e.item,ref:"form"},null,8,["layout","model"])}n("a15b"),n("0481"),n("4069"),n("2ca0"),n("a4d3"),n("e01a");var Qa=n("c8a4");function er(e,t){var n=e.path?t[e.path]:"",a=function(){return!n},r={message:n,handler:a};return e.validators?e.validators.push(r):e.validators=[r],e}function tr(e){var t=[];return e.required&&t.push(Object(Qa["g"])()),e.min_length&&t.push(Object(Qa["h"])({min:e.min_length})),t}function nr(e){var t=e.type;switch(t){case"text":case"password":return z["q"];case"textarea":return ma["a"];default:throw Error("Unknown VMS options type: "+t)}}function ar(e){var t={disabled:!e.editable,modelValue:e.default||""};switch(e.type){case"password":t.password=!0;break;case"textarea":t.minRows=2;break}return t}function rr(e){return{path:"options.".concat(e.name),label:e.description,classes:"label-m n-form-w-full n-form-pad-10",component:nr(e),props:ar(e),validators:tr(e)}}var cr=function(e,t){return e?e.options.map(rr).map((function(e){return er(e,t)})):[]},or=n("a49d"),ir=n("2ef0");function sr(e){var t,n,a,r=null===(t=e.response)||void 0===t||null===(n=t.data)||void 0===n||null===(a=n.original_error)||void 0===a?void 0:a.param;return r?Object.fromEntries(r.map((function(e){return[e.loc.join("."),Object(ir["capitalize"])(e.msg)]}))):{}}var lr=function(e){Object(b["a"])(n,e);var t=Object(p["a"])(n);function n(){var e;return Object(d["a"])(this,n),e=t.apply(this,arguments),e.config=null,e}return Object(m["a"])(n,[{key:"module",get:function(){var e;return null===(e=or["b"].currentItem)||void 0===e?void 0:e.model}},{key:"isNew",get:function(){var e;return null===(e=this.module)||void 0===e?void 0:e.isNew}},{key:"availableVms",get:function(){return this.info.vms?Object.keys(this.info.vms):[]}},{key:"availableVmsVersions",get:function(){return this.availableVms&&this.item.name&&this.info.vms[this.item.name].map((function(e){return e.version}))||[]}},{key:"serverErrorsMap",get:function(){var e;return null!==(e=this.module)&&void 0!==e&&e.loadError?sr(this.module.loadError):{}}},{key:"layout",get:function(){return[{path:"verbose_name",classes:"n-form-w-6 n-form-pad-10 label-m",i18n_label:"external_vms.name",component:z["q"],validators:[{name:be["a"].Required,i18n_message:"errors.required.name"}]},[{path:"name",classes:"n-form-w-6 label-m n-form-pad-10",i18n_label:"external_vms.vms",component:z["x"],validators:[{name:be["a"].Required}],props:{items:this.availableVms.map((function(e){return{label:e,value:e}})),capitalizeLabels:!0,disabled:!this.isNew}},{path:"version",classes:"n-form-w-6 label-m n-form-pad-10",i18n_label:"external_vms.version",component:z["x"],validators:[{name:be["a"].Required}],props:{items:this.availableVmsVersions.map((function(e){return{label:e,value:e}})),disabled:!this.isNew}}]].concat(Object(Cn["a"])(cr(this.config,this.serverErrorsMap)))}},{key:"handleServerError",value:function(e){if(e){var t=this.$refs.form;t&&t.displayErrors()}}},{key:"fillVersion",value:function(){this.item.version=this.availableVmsVersions.length?this.availableVmsVersions[0]:""}},{key:"resetOptions",value:function(){this.isNew&&(this.item.options={})}},{key:"fillOptionsFields",value:function(e){var t,n=Object(Un["a"])(e.flat());try{for(n.s();!(t=n.n()).done;){var a,r=t.value;null!==(a=r.path)&&void 0!==a&&a.startsWith("options.")&&void 0===Object(ir["get"])(this.item,r.path)&&Object(ir["set"])(this.item,r.path,"")}}catch(c){n.e(c)}finally{n.f()}}},{key:"validateForm",value:function(){var e=Object(u["a"])(regeneratorRuntime.mark((function e(){var t,n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return this.module&&(this.module.loadError=null),e.next=3,this.$nextTick();case 3:return t=this.$refs.form,n=!t||t.validate(),n||t.displayErrors(),e.abrupt("return",n);case 7:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"mounted",value:function(){xe["a"].getIsItemFormValid=this.validateForm.bind(this)}}]),n}(h["b"]);Object(f["b"])([Object(v["c"])({type:Object,required:!0})],lr.prototype,"item",void 0),Object(f["b"])([Object(v["c"])({type:Object,required:!0})],lr.prototype,"info",void 0),Object(f["b"])([Object(v["c"])({type:Object,required:!1})],lr.prototype,"config",void 0),Object(f["b"])([Object(v["f"])("module.loadError")],lr.prototype,"handleServerError",null),Object(f["b"])([Object(v["f"])("item.name")],lr.prototype,"fillVersion",null),Object(f["b"])([Object(v["f"])("item.name"),Object(v["f"])("item.version")],lr.prototype,"resetOptions",null),Object(f["b"])([Object(v["f"])("layout")],lr.prototype,"fillOptionsFields",null),lr=Object(f["b"])([Object(h["a"])({name:"ExternalVmsInfo",components:{NForm:be["b"]},emits:[]})],lr);var ur=lr;const dr=ce()(ur,[["render",Za]]);var mr=dr,br={class:"vms-sidebar-cameras-tab"};function pr(e,t,n,a,c,o){var i=Object(r["P"])("VmsSidebarCamerasTabFilters"),s=Object(r["P"])("NButton"),l=Object(r["P"])("MultisidebarActions"),u=Object(r["P"])("VmsSidebarCamerasTabList");return Object(r["F"])(),Object(r["i"])("div",br,[Object(r["m"])(i,{"camera-groups":e.cameraGroups,class:"vms-sidebar-cameras-tab__filters",added:e.filters.added,"onUpdate:added":t[0]||(t[0]=function(t){return e.filters.added=t}),"group-contains":e.filters.groupContains,"onUpdate:group-contains":t[1]||(t[1]=function(t){return e.filters.groupContains=t}),"name-contains":e.filters.nameContains,"onUpdate:name-contains":t[2]||(t[2]=function(t){return e.filters.nameContains=t})},null,8,["camera-groups","added","group-contains","name-contains"]),e.streams.length?(Object(r["F"])(),Object(r["g"])(l,{key:0},{default:Object(r["eb"])((function(){return[Object(r["m"])(s,{label:e.$t("external_vms.add_selected_cameras"),onClick:e.createCameraFromSelectedStreams},null,8,["label","onClick"]),Object(r["m"])(s,{class:"vms-sidebar-cameras-tab__select-all",label:e.$t("external_vms.select_all_streams"),onClick:e.selectAll,icon:"select-all",type:"link"},null,8,["label","onClick"])]})),_:1})):Object(r["h"])("",!0),Object(r["m"])(u,{cameras:e.cameras,onSelect:e.createCameraFromSelectedStream,class:"vms-sidebar-cameras-tab__list"},null,8,["cameras","onSelect"])])}var fr=n("84d4"),hr={class:"vms-sidebar-cameras-tab-filters"};function vr(e,t,n,a,c,o){var i=Object(r["P"])("NInput"),s=Object(r["P"])("VmsSidebarCamerasTabFiltersCameraGroup"),l=Object(r["P"])("VmsSidebarCamerasTabFiltersStatus");return Object(r["F"])(),Object(r["i"])("div",hr,[Object(r["m"])(i,{placeholder:e.$t("common.search","f"),class:"vms-sidebar-cameras-tab-filters__name-contains","suffix-icon":"search",modelValue:e.model.nameContains,"onUpdate:modelValue":t[0]||(t[0]=function(t){return e.model.nameContains=t})},null,8,["placeholder","modelValue"]),Object(r["m"])(s,{"camera-groups":e.cameraGroups,class:"vms-sidebar-cameras-tab-filters__camera-group",modelValue:e.model.groupContains,"onUpdate:modelValue":t[1]||(t[1]=function(t){return e.model.groupContains=t})},null,8,["camera-groups","modelValue"]),Object(r["m"])(l,{class:"vms-sidebar-cameras-tab-filters__status",modelValue:e.model.added,"onUpdate:modelValue":t[2]||(t[2]=function(t){return e.model.added=t})},null,8,["modelValue"])])}var jr=n("f48d"),Or={class:"vms-sidebar-cameras-tab-filters-camera-group"};function yr(e,t,n,a,c,o){var i=Object(r["P"])("NSelect");return Object(r["F"])(),Object(r["i"])("div",Or,[Object(r["m"])(i,{items:e.items,"model-value":e.modelValue,"onUpdate:modelValue":e.dispatchUpdateModelValueEvent,selectonly:""},null,8,["items","model-value","onUpdate:modelValue"])])}var gr=n("b998"),_r=Object(r["n"])({name:"VmsSidebarCamerasTabFiltersCameraGroup",components:{NSelect:gr["a"]},props:{cameraGroups:Object(fr["b"])(Object(fr["j"])()).isRequired,modelValue:Object(fr["j"])().isRequired},emits:["update:modelValue"],computed:{items:function(){return[{value:"",label:this.$t("external_vms.any_camera_group")}].concat(Object(Cn["a"])(this.cameraGroups.map((function(e){return{value:e,label:e}}))))}},methods:{dispatchUpdateModelValueEvent:function(e){this.$emit("update:modelValue",e)}}});n("bba2");const kr=ce()(_r,[["render",yr]]);var wr=kr,Cr={class:"vms-sidebar-cameras-tab-filters-status"};function xr(e,t,n,a,c,o){var i=Object(r["P"])("NSelect");return Object(r["F"])(),Object(r["i"])("div",Cr,[Object(r["m"])(i,{items:e.items,"model-value":e.modelValue,"onUpdate:modelValue":e.dispatchUpdateModelValueEvent,selectonly:""},null,8,["items","model-value","onUpdate:modelValue"])])}var Tr=Object(r["n"])({name:"VmsSidebarCamerasTabFiltersStatus",components:{NSelect:gr["a"]},props:{modelValue:Object(fr["j"])().isRequired},emits:["update:modelValue"],computed:{items:function(){return[{value:"",label:this.$t("external_vms.any_status")},{value:"True",label:this.$t("external_vms.added")},{value:"False",label:this.$t("external_vms.not_added")}]}},methods:{dispatchUpdateModelValueEvent:function(e){this.$emit("update:modelValue",e)}}});n("044c");const Ir=ce()(Tr,[["render",xr]]);var Ar=Ir;function Fr(e,t){var n=Object(r["e"])({get:function(){return Object(r["Y"])(e.added)},set:function(e){return t("update:added",e)}}),a=Object(r["e"])({get:function(){return Object(r["Y"])(e.groupContains)},set:function(e){return t("update:groupContains",e)}}),c=Object(r["e"])({get:function(){return Object(r["Y"])(e.nameContains)},set:function(e){return t("update:nameContains",e)}}),o=Object(r["K"])({added:n,groupContains:a,nameContains:c});return{model:o}}var Nr=Object(r["n"])({name:"VmsSidebarCamerasTabFilters",components:{NInput:jr["a"],VmsSidebarCamerasTabFiltersCameraGroup:wr,VmsSidebarCamerasTabFiltersStatus:Ar},props:{added:Object(fr["j"])().isRequired,cameraGroups:Object(fr["b"])(Object(fr["j"])()).isRequired,groupContains:Object(fr["j"])().isRequired,nameContains:Object(fr["j"])().isRequired},emits:["update:added","update:groupContains","update:nameContains"],setup:function(e,t){var n=t.emit;return Fr(Object(r["X"])(e),n)}});n("4e80");const Sr=ce()(Nr,[["render",vr]]);var Vr=Sr,Pr={class:"vms-sidebar-cameras-tab-list"};function Rr(e,t,n,a,c,o){var i=Object(r["P"])("VmsSidebarCamerasTabListItem");return Object(r["F"])(),Object(r["i"])("div",Pr,[(Object(r["F"])(!0),Object(r["i"])(r["a"],null,Object(r["N"])(e.cameras,(function(t){return Object(r["F"])(),Object(r["g"])(i,{key:t.id,camera:t,onSelect:e.dispatchSelectEvent,class:"vms-sidebar-cameras-tab-list__item"},null,8,["camera","onSelect"])})),128))])}var Mr={class:"vms-sidebar-cameras-tab-list-item"},Er=["textContent"],Lr={class:"label-2xs vms-sidebar-cameras-tab-list-item__id"};function Dr(e,t,n,a,c,o){var i=Object(r["P"])("NButton"),s=Object(r["P"])("VmsSidebarCamerasTabListItemScreenshot"),l=Object(r["P"])("VmsSidebarCamerasTabListItemStreamTable");return Object(r["F"])(),Object(r["i"])("div",Mr,[Object(r["j"])("div",{class:"heading-s vms-sidebar-cameras-tab-list-item__name",textContent:Object(r["T"])(e.camera.name)},null,8,Er),Object(r["j"])("div",Lr,[Object(r["l"])(" ID "+Object(r["T"])(e.camera.id)+"  ",1),Object(r["m"])(i,{"icon-size":12,onClick:e.copyCameraIdToClipboard,icon:"copy",type:"link"},null,8,["onClick"])]),Object(r["m"])(s,{screenshot:e.camera.screenshot,class:"vms-sidebar-cameras-tab-list-item__screenshot"},null,8,["screenshot"]),Object(r["m"])(l,{added:e.camera.added,streams:e.camera.streams,onSelect:e.dispatchSelectEvent,class:"vms-sidebar-cameras-tab-list-item__table"},null,8,["added","streams","onSelect"])])}var $r={class:"vms-sidebar-cameras-tab-list-item-screenshot"};function Ur(e,t,n,a,c,o){return Object(r["F"])(),Object(r["i"])("div",$r)}var Br=n("3835"),qr=(n("7ed3"),n("f8c9"),n("2c35")),Hr=n("b74e"),Gr=n("6635"),zr=function(){};function Wr(e){var t=Object(r["L"])(c()),n=function(e){return t.value=(Object(r["Y"])(t).dispose(),e)},a=Object(r["db"])(e,(function(e){return Object(r["v"])((function(){return Object(Hr["g"])(e)&&n(i(e))}))}),{immediate:!0});function c(){function e(){return Object(r["m"])("div",{class:"vms-sidebar-cameras-tab-list-item-screenshot"},null)}return{content:e,dispose:zr}}function o(e){var t=URL.createObjectURL(e);function n(){return Object(r["m"])("img",{class:"vms-sidebar-cameras-tab-list-item-screenshot vms-sidebar-cameras-tab-list-item-screenshot_complete",src:t},null)}function a(){URL.revokeObjectURL(t)}return{content:n,dispose:a}}function i(e){var t=Object(qr["a"])(Yr(e));function a(){return Object(r["m"])("div",{class:"vms-sidebar-cameras-tab-list-item-screenshot vms-sidebar-cameras-tab-list-item-screenshot_in-progress"},[Object(r["m"])(Gr["a"],{class:"vms-sidebar-cameras-tab-list-item-screenshot__progress-bar"},null)])}function i(){t.cancel()}return t.then((function(e){return n(o(e))})).catch((function(){return n(c())})),{content:a,dispose:i}}return Object(r["B"])((function(){return a(),Object(r["Y"])(t).dispose()})),function(){return Object(r["Y"])(t).content()}}function Yr(e){var t=new URL(e),n=Object(Cn["a"])(t.searchParams).reduce((function(e,t){var n=Object(Br["a"])(t,2),a=n[0],r=n[1];return Reflect.set(e,a,r),e}),{});return{method:"GET",path:t.pathname,query:n,responseType:"blob"}}var Kr=Object(r["n"])({name:"VmsSidebarCamerasTabListItemScreenshot",props:{screenshot:Xr()},setup:function(e){var t=Object(r["X"])(e),n=t.screenshot;return Wr(n)}});function Xr(){return Object(fr["j"])().def("")}n("21ad");const Jr=ce()(Kr,[["render",Ur]]);var Zr=Jr;function Qr(e,t,n,a,c,o){var i=Object(r["P"])("NTable");return Object(r["F"])(),Object(r["g"])(i,{columns:e.columns,content:e.streams,selected:e.selected,"selections-schema":e.selectionsSchema,"onUpdate:selected":e.select,class:"vms-sidebar-cameras-tab-list-item-stream-table",selections:""},null,8,["columns","content","selected","selections-schema","onUpdate:selected"])}function ec(){return Object(fr["b"])(Object(fr["g"])()).isRequired}var tc=n("9bf1"),nc=(n("55a5"),n("5add")),ac=n.n(nc);function rc(e,t,n,a,c,o){var i=Object(r["P"])("NHint");return Object(r["F"])(),Object(r["g"])(i,{class:"vms-sidebar-cameras-tab-list-item-stream-table-status__hint"},{content:Object(r["eb"])((function(){return[Object(r["l"])(Object(r["T"])(e.content),1)]})),default:Object(r["eb"])((function(){return[Object(r["j"])("div",{class:Object(r["w"])([{"vms-sidebar-cameras-tab-list-item-stream-table-status_added":e.added},"vms-sidebar-cameras-tab-list-item-stream-table-status"])},null,2)]})),_:1})}var cc=n("7f76"),oc=Object(r["n"])({name:"VmsSidebarCamerasTabListItemStreamTableStatus",components:{NHint:cc["a"]},props:{added:Object(fr["c"])().def(!1)},computed:{content:function(){return this.$t("external_vms.".concat(this.added?"added":"not_added"),"f")}}});n("1faf");const ic=ce()(oc,[["render",rc]]);var sc=ic,lc=function(){},uc=Object(r["n"])({name:"VmsSidebarCamerasTabListItemStreamTable",components:{NTable:tc["a"]},props:{added:Object(fr["c"])().def(!1),streams:ec()},emits:["update:selected","select"],data:function(){return{selectionsSchema:dc}},setup:function(){return{select:Object(r["r"])("select"),selected:Object(r["r"])("streams",Object(r["L"])([]))}},computed:{columns:function(){return[this.createUrlTableColumn(),this.createStatusTableColumn(),this.createAddButtonTableColumn()]}},methods:{createUrlTableColumn:function(){var e=this;return{body:{content:function(t){var n=t.model;return Object(r["m"])("p",{class:"label-s vms-sidebar-cameras-tab-list-item-stream-table__url"},[n.url,Object(r["l"])(" "),Object(r["m"])(st["c"],{icon:"copy",iconSize:12,onClick:function(){return e.copyStreamUrlToClipboard(n.url)},type:"link"},null)])}},width:"1fr"}},createStatusTableColumn:function(){var e=this;return{body:function(){return Object(r["m"])(sc,{added:e.added},null)}}},createAddButtonTableColumn:function(){var e=this;return{body:{content:function(t){var n=t.model;return Object(r["m"])(st["c"],Object(r["u"])({icon:"add",onClick:function(){return e.dispatchSelectEvent(n)},type:"text"},{class:"vms-sidebar-cameras-tab-list-item-stream-table__add"}),null)},style:{paddingLeft:0,paddingRight:0}}}},copyStreamUrlToClipboard:function(e){navigator.clipboard.writeText(e).then(lc).catch(lc)},dispatchSelectEvent:function(e){this.$emit("select",e)}}});function dc(e,t,n){var a=Object(r["e"])((function(){return new Set(Object(r["Y"])(e))}));function c(t){var c=t.model,o={"onUpdate:modelValue":function(t){n(t?[].concat(Object(Cn["a"])(Object(r["Y"])(e)),[c]):ac()(Object(r["Y"])(e),c))},modelValue:Object(r["Y"])(a).has(c)};return Object(r["m"])(Ln["a"],o,null)}return{body:{content:c,style:{paddingLeft:0,paddingRight:0}}}}n("f0c0");const mc=ce()(uc,[["render",Qr]]);var bc=mc,pc=function(){},fc=Object(r["n"])({name:"VmsSidebarCamerasTabListItem",components:{NButton:st["c"],VmsSidebarCamerasTabListItemScreenshot:Zr,VmsSidebarCamerasTabListItemStreamTable:bc},props:{camera:hc()},emits:["select"],methods:{copyCameraIdToClipboard:function(){navigator.clipboard.writeText(String(this.camera.id)).then(pc).catch(pc)},dispatchSelectEvent:function(e){this.$emit("select",e)}}});function hc(){return Object(fr["g"])().isRequired}n("33ea");const vc=ce()(fc,[["render",Dr]]);var jc=vc,Oc=Object(r["n"])({name:"VmsSidebarCamerasTabList",components:{VmsSidebarCamerasTabListItem:jc},props:{cameras:yc(),streams:gc()},emits:["select"],methods:{dispatchSelectEvent:function(e){this.$emit("select",e)}}});function yc(){return Object(fr["b"])(Object(fr["g"])()).isRequired}function gc(){return Object(fr["b"])(Object(fr["g"])().isRequired)}n("4b82");const _c=ce()(Oc,[["render",Rr]]);var kc=_c,wc=n("261b"),Cc=n("f7d2"),xc={class:"vms-sidebar-cameras-tab-group-dialog__content"},Tc={class:"vms-sidebar-cameras-tab-group-dialog__footer"};function Ic(e,t,n,a,c,o){var i=Object(r["P"])("VmsSidebarCamerasTabGroupDialogForm"),s=Object(r["P"])("NButton"),l=Object(r["P"])("NModalWindow");return Object(r["F"])(),Object(r["g"])(l,{"insert-into-body":!1,onClose:e.dispatchCloseEvent,"custom-size":"320px"},{content:Object(r["eb"])((function(){return[Object(r["j"])("div",xc,[Object(r["m"])(i,{groups:e.groups,ref:"form",id:e.id,"onUpdate:id":t[0]||(t[0]=function(t){return e.id=t})},null,8,["groups","id"])])]})),footer:Object(r["eb"])((function(){return[Object(r["j"])("div",Tc,[Object(r["m"])(s,{label:e.$t("common.column_add","f"),onClick:e.submit},null,8,["label","onClick"])])]})),_:1},8,["onClose"])}function Ac(e,t,n,a,c,o){var i=Object(r["P"])("NForm");return Object(r["F"])(),Object(r["g"])(i,{layout:e.layout,model:e.model,class:"vms-sidebar-cameras-tab-group-dialog-form","inline-form":"",ref:"form"},null,8,["layout","model"])}var Fc=Object(r["n"])({name:"VmsSidebarCamerasTabGroupDialogForm",components:{NForm:be["b"]},props:{groups:Object(fr["b"])(Object(fr["g"])()).isRequired,id:Object(fr["e"])()},emits:["update:id"],setup:function(e,t){var n=t.emit,a=Object(r["X"])(e),c=a.id,o=Object(r["K"])({id:Object(r["e"])({get:function(){return Object(r["Y"])(c)},set:function(e){return n("update:id",e)}})});return{model:o}},computed:{items:function(){return this.groups.map((function(e){var t=e.id,n=e.name;return{label:n,value:t}}))},layout:function(){return[{classes:"label-m",component:gr["a"],label:this.$t("common.camera_group","f"),path:"id",props:{items:this.items},validators:[{name:"required"}]}]}},methods:{validate:function(){var e=this.$refs.form,t=e.validate();return!t&&e.displayErrors(),t}}});n("d7a8f");const Nc=ce()(Fc,[["render",Ac]]);var Sc=Nc,Vc=Object(r["n"])({name:"VmsSidebarCamerasTabGroupDialog",components:{NButton:st["c"],NModalWindow:ea["b"],VmsSidebarCamerasTabGroupDialogForm:Sc},props:{groups:Object(fr["b"])(Object(fr["g"])()).isRequired},emits:["close","done"],data:function(){return{id:void 0}},setup:function(){return{form:Object(r["L"])(null)}},methods:{dispatchCloseEvent:function(){this.$emit("close")},dispatchDoneEvent:function(){this.$emit("done",this.id)},submit:function(){var e;(null===(e=this.form)||void 0===e?void 0:e.validate())&&this.dispatchDoneEvent()}}});n("3e36");const Pc=ce()(Vc,[["render",Ic]]);var Rc=Pc;function Mc(e){function t(t){return new Promise((function(n){var a=document.body.appendChild(document.createElement("div")),c=Object(r["m"])(Rc,{groups:t,onClose:o,onDone:i},null);function o(){Object(r["M"])(null,document.body.removeChild(a))}function i(e){n(e),o()}Object(r["M"])((c.appContext=e,c),a)}))}return t}function Ec(e){var t,n,a=Object(r["e"])(y),c=Object(r["L"])([]),o=Object(r["K"])({added:"",groupContains:"",nameContains:""}),i=Mc(null!==(t=null===(n=Object(r["o"])())||void 0===n?void 0:n.appContext)&&void 0!==t?t:null),s=Object(r["L"])([]);function l(e){(null===e||void 0===e?void 0:e.type)===Pe["c"].Cameras&&(null===e||void 0===e?void 0:e.name)===ga["a"].Delete&&g()}function d(e){s.value=e}function m(){s.value=Object(r["Y"])(c).map((function(e){var t=e.streams;return t})).flat()}function b(){return p.apply(this,arguments)}function p(){return p=Object(u["a"])(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.t0=i,e.next=3,Lc();case 3:return e.t1=e.sent,e.next=6,(0,e.t0)(e.t1);case 6:return t=e.sent,e.next=9,Promise.all(Object(r["Y"])(s).map((function(e){return j(e,t)})));case 9:return v(),e.next=12,g();case 12:return e.abrupt("return",k());case 13:case"end":return e.stop()}}),e)}))),p.apply(this,arguments)}function f(e){return h.apply(this,arguments)}function h(){return h=Object(u["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.t0=j,e.t1=t,e.t2=i,e.next=5,Lc();case 5:return e.t3=e.sent,e.next=8,(0,e.t2)(e.t3);case 8:return e.t4=e.sent,e.next=11,(0,e.t0)(e.t1,e.t4);case 11:return v(),e.next=14,g();case 14:return e.abrupt("return",k());case 15:case"end":return e.stop()}}),e)}))),h.apply(this,arguments)}function v(){var e=wc["b"].getTranslatedToken("common.action_success");return Object(Cc["a"])({content:e,type:"success"})}function j(t,n){var a=O(t);return $c(a.name,t.url,Object(r["Y"])(e).id,a.id,n)}function O(e){return Object(Hr["a"])(Object(r["Y"])(c).find((function(t){return t.streams.some((function(t){return t===e}))})))}function y(){var e=Object(r["Y"])(c).map((function(e){var t,n;return null===(t=e.meta)||void 0===t||null===(n=t.camera_group)||void 0===n?void 0:n.id}));return Object(Cn["a"])(new Set(e.filter(Boolean)))}function g(){return _.apply(this,arguments)}function _(){return _=Object(u["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,Dc(Object(r["Y"])(e).id,Object(r["Y"])(o));case 3:c.value=t.sent;case 4:return t.prev=4,s.value=[],t.finish(4);case 7:case"end":return t.stop()}}),t,null,[[0,,4,7]])}))),_.apply(this,arguments)}function k(){ga["b"].sendCreate(Pe["c"].Cameras)}return Object(r["db"])((function(){return Object(r["Y"])(e).id}),g),Object(r["db"])(o,g,{deep:!0,immediate:!0}),Object(r["db"])((function(){return ga["b"].current}),l),Object(r["H"])("select",d),Object(r["H"])("streams",s),{cameraGroups:a,cameras:c,createCameraFromSelectedStream:f,createCameraFromSelectedStreams:b,filters:o,selectAll:m,streams:s}}function Lc(){return Te["d"].cameraGroupsList().then((function(e){var t=e.results;return null!==t&&void 0!==t?t:[]})).catch((function(){return[]}))}function Dc(e,t){return Object(qr["a"])({method:"GET",path:"/external-vms/".concat(e,"/cameras/"),query:{added:t.added,group_contains:t.groupContains,name_contains:t.nameContains}}).then((function(e){var t=e.results;return null!==t&&void 0!==t?t:[]})).catch((function(){return[]}))}function $c(e,t,n,a,r){return Object(qr["a"])({body:{active:!0,external_vms_camera_id:a,external_vms:n,group:r,name:e,url:t},mediaType:"application/json",method:"POST",path:"/cameras/"})}var Uc=Object(r["n"])({name:"VmsSidebarCamerasTab",components:{MultisidebarActions:Ia,NButton:st["c"],VmsSidebarCamerasTabFilters:Vr,VmsSidebarCamerasTabList:kc},props:{item:Bc()},setup:function(e){var t=Object(r["X"])(e),n=t.item;return Ec(n)}});function Bc(){return Object(fr["g"])().isRequired}n("34cb");const qc=ce()(Uc,[["render",pr]]);var Hc=qc,Gc={class:"vms-sent-messages__container"},zc={class:"label-xs"},Wc={class:"vms-sent-messages__content"},Yc={key:0,class:"interactions-banner"},Kc={key:1,class:"interactions-banner"},Xc={key:2,class:"interactions-banner"};function Jc(e,t,n,a,c,o){var i=Object(r["P"])("NFilterDateRange"),s=Object(r["P"])("NTable"),l=Object(r["P"])("NInfiniteScroll");return Object(r["F"])(),Object(r["i"])("div",Gc,[Object(r["j"])("div",zc,[Object(r["m"])(i,{size:"small",model:e.module.filter.current},null,8,["model"])]),Object(r["j"])("div",Wc,[Object(r["m"])(s,{columns:e.columns,content:e.module.items,class:"vms-sent-messages-table",onRowClick:e.rowClickHandler},null,8,["columns","content","onRowClick"]),!e.module.loaded||e.module.items.length||e.module.loading?Object(r["h"])("",!0):(Object(r["F"])(),Object(r["i"])("div",Yc,Object(r["T"])(e.$t("common.no_items","f")),1)),e.module.loading?(Object(r["F"])(),Object(r["i"])("div",Kc,Object(r["T"])(e.$t("common.loading","f")),1)):Object(r["h"])("",!0),Object(r["m"])(l,{filters:e.module.filter.current,onLoadMore:t[0]||(t[0]=function(t){return e.module.append()})},null,8,["filters"]),e.module.appending?(Object(r["F"])(),Object(r["i"])("div",Xc,Object(r["T"])(e.$t("common.loading","f")),1)):Object(r["h"])("",!0)])])}var Zc=n("85d1"),Qc=n("1fe2"),eo=n("1b62"),to=function(e){Object(b["a"])(n,e);var t=Object(p["a"])(n);function n(){var e;return Object(d["a"])(this,n),e=t.apply(this,arguments),e.config=null,e.module=ee["d"].getExternalVmsSendEventStatusListViewModel(),e}return Object(m["a"])(n,[{key:"columns",get:function(){return[this.createUrlTableColumn(),this.createStatusTableColumn(),this.createdTableColumn()]}},{key:"changeFilter",value:function(e,t){(null===e||void 0===e?void 0:e.page)===(null===t||void 0===t?void 0:t.page)&&(null===e||void 0===e?void 0:e.limit)===(null===t||void 0===t?void 0:t.limit)&&this.module.get()}},{key:"updateFilter",value:function(){this.module.filter.current.external_vms=[this.item.id]}},{key:"createUrlTableColumn",value:function(){var e=this;return{body:{content:function(t){var n=t.model;return Object(r["m"])("div",null,[Object(r["m"])("div",{class:"vms-sent-messages-table__id label-mono-s"},[Object(r["l"])("#"),n.event_id,Object(r["l"])(" "),Object(r["m"])(st["c"],{icon:"copy",iconSize:14,onClick:Object(r["hb"])((function(){return e.copyStreamUrlToClipboard(n.event_id)}),["stop","prevent"]),type:"link"},null)]),Object(r["m"])("span",null,[e.$t("common.camera_id"),Object(r["l"])(": "),n.camera])])}},width:"max-content"}}},{key:"createStatusTableColumn",value:function(){return{body:function(e){var t=e.model;return Object(r["m"])("div",{class:"label-xs"},[t.error])},width:"1fr"}}},{key:"createdTableColumn",value:function(){return{body:{content:function(e){var t=e.model;return Object(r["m"])("div",{class:"vms-sent-messages-table__date"},[Object(r["m"])(z["j"],{multiline:!0,modelValue:t.created_date},null)])}}}}},{key:"copyStreamUrlToClipboard",value:function(e){Object(eo["a"])(e)}},{key:"rowClickHandler",value:function(e){if(e.event_type){var t=ke["m"][e.event_type];xe["a"].run(te["b"].ShowItem,{type:t,rawItem:e.event_id})}}}]),n}(h["b"]);Object(f["b"])([Object(v["c"])({type:Object,required:!0})],to.prototype,"item",void 0),Object(f["b"])([Object(v["c"])({type:Object,required:!0})],to.prototype,"info",void 0),Object(f["b"])([Object(v["c"])({type:Object,required:!1})],to.prototype,"config",void 0),Object(f["b"])([Object(v["f"])("module.filter.current",{deep:!0})],to.prototype,"changeFilter",null),Object(f["b"])([Object(v["f"])("item.id",{immediate:!0})],to.prototype,"updateFilter",null),to=Object(f["b"])([Object(h["a"])({name:"ExternalVmsInfo",components:{NFilterDateRange:Zc["a"],NTable:tc["a"],NInfiniteScroll:Qc["a"]},emits:[]})],to);var no=to;n("d86b2");const ao=ce()(no,[["render",Jc]]);var ro=ao,co={class:"vms-events__container"},oo={class:"label-xs"},io={class:"vms-events__content"},so={key:0,class:"interactions-banner"},lo={key:1,class:"interactions-banner"},uo={key:2,class:"interactions-banner"};function mo(e,t,n,a,c,o){var i=Object(r["P"])("NFilterDateRange"),s=Object(r["P"])("NTable"),l=Object(r["P"])("NInfiniteScroll");return Object(r["F"])(),Object(r["i"])("div",co,[Object(r["j"])("div",oo,[Object(r["m"])(i,{size:"small",model:e.module.filter.current},null,8,["model"])]),Object(r["j"])("div",io,[Object(r["m"])(s,{columns:e.columns,content:e.module.items,class:"vms-events__table",onRowClick:e.rowClickHandler},null,8,["columns","content","onRowClick"]),!e.module.loaded||e.module.items.length||e.module.loading?Object(r["h"])("",!0):(Object(r["F"])(),Object(r["i"])("div",so,Object(r["T"])(e.$t("common.no_items","f")),1)),e.module.loading?(Object(r["F"])(),Object(r["i"])("div",lo,Object(r["T"])(e.$t("common.loading","f")),1)):Object(r["h"])("",!0),Object(r["m"])(l,{filters:e.module.filter.current,onLoadMore:t[0]||(t[0]=function(t){return e.module.append()})},null,8,["filters"]),e.module.appending?(Object(r["F"])(),Object(r["i"])("div",uo,Object(r["T"])(e.$t("common.loading","f")),1)):Object(r["h"])("",!0)])])}var bo=n("7428"),po=function(e){Object(b["a"])(n,e);var t=Object(p["a"])(n);function n(){var e;return Object(d["a"])(this,n),e=t.apply(this,arguments),e.config=null,e.module=ee["d"].getExternalVmsEventsListViewModel(),e}return Object(m["a"])(n,[{key:"columns",get:function(){return[this.createUrlTableColumn(),this.createInfoTableColumn(),this.createdTableColumn()]}},{key:"changeFilter",value:function(e,t){(null===e||void 0===e?void 0:e.page)===(null===t||void 0===t?void 0:t.page)&&(null===e||void 0===e?void 0:e.limit)===(null===t||void 0===t?void 0:t.limit)&&this.module.get()}},{key:"updateFilter",value:function(){this.module.filter.current.external_vms=[this.item.id]}},{key:"createUrlTableColumn",value:function(){var e=this;return{body:{content:function(t){var n=t.model;return Object(r["m"])("div",null,[Object(r["m"])("div",{class:"vms-events__table__id label-mono-s"},[Object(r["l"])("#"),n.id,Object(r["l"])(" "),Object(r["m"])(st["c"],{icon:"copy",iconSize:14,onClick:function(t){t.stopPropagation(),e.copyStreamUrlToClipboard(n.id)},type:"link"},null)])])}},width:"max-content"}}},{key:"createInfoTableColumn",value:function(){var e=this;return{body:function(t){var n=t.model;return Object(r["m"])("div",{class:"label-m"},[n.name,Object(r["m"])("br",null,null),n.type,Object(r["m"])("div",null,[n.camera?e.$t("common.camera_id")+":"+n.camera:""])])},width:"1fr"}}},{key:"createdTableColumn",value:function(){return{body:{content:function(e){var t=e.model;return Object(r["m"])("div",{class:"vms-events__table__date"},[Object(r["m"])(z["j"],{multiline:!0,modelValue:t.created_date},null)])}}}}},{key:"copyStreamUrlToClipboard",value:function(e){Object(eo["a"])(String(e))}},{key:"rowClickHandler",value:function(e){bo["a"].show(e)}}]),n}(h["b"]);Object(f["b"])([Object(v["c"])({type:Object,required:!0})],po.prototype,"item",void 0),Object(f["b"])([Object(v["c"])({type:Object,required:!0})],po.prototype,"info",void 0),Object(f["b"])([Object(v["c"])({type:Object,required:!1})],po.prototype,"config",void 0),Object(f["b"])([Object(v["f"])("module.filter.current",{deep:!0})],po.prototype,"changeFilter",null),Object(f["b"])([Object(v["f"])("item.id",{immediate:!0})],po.prototype,"updateFilter",null),po=Object(f["b"])([Object(h["a"])({name:"ExternalVmsInfo",components:{NFilterDateRange:Zc["a"],NTable:tc["a"],NInfiniteScroll:Qc["a"]},emits:[]})],po);var fo=po;n("d5bf");const ho=ce()(fo,[["render",mo]]);var vo=ho,jo={Info:"info",Cameras:"list_cameras",ReceivedMessages:"receive_events",SendingMessages:"send_events"},Oo=function(e){Object(b["a"])(n,e);var t=Object(p["a"])(n);function n(){var e;return Object(d["a"])(this,n),e=t.apply(this,arguments),e.info=null,e.tabName=jo.Info,e}return Object(m["a"])(n,[{key:"currentItem",get:function(){return this.module.item}},{key:"currentItemConfig",get:function(){var e,t,n=this;return this.info&&null!==(e=this.currentItem)&&void 0!==e&&e.name&&null!==(t=this.currentItem)&&void 0!==t&&t.version?this.info.vms[this.currentItem.name].find((function(e){var t;return e.version===(null===(t=n.currentItem)||void 0===t?void 0:t.version)})):null}},{key:"module",get:function(){return this.sidebarItem.model}},{key:"headerActions",get:function(){return i["b"].getItemActions(this.modelAcl,null,{hasChanges:this.module.hasChanges,hasDelete:!this.module.isNew}).map(i["b"].computeActionByName)}},{key:"tabItems",get:function(){var e=this,t=[jo.Info,jo.Cameras],n=Ke["f"].getAccess("ffsecurity.view_externalvmsevent"),a=Ke["f"].getAccess("ffsecurity.view_externalvmssendeventstatus");return n&&t.push(jo.ReceivedMessages),a&&t.push(jo.SendingMessages),t.filter((function(t){var n;return t===jo.Info||(null===(n=e.currentItemConfig)||void 0===n?void 0:n.features[t])})).map((function(t){return{name:t,label:e.$t("external_vms.".concat(t)),disabled:e.module.isNew&&t!==jo.Info}}))}},{key:"mainComponent",get:function(){switch(this.tabName){case jo.Cameras:return Hc;case jo.SendingMessages:return ro;case jo.ReceivedMessages:return vo;case jo.Info:default:return mr}}},{key:"actionHandler",value:function(e,t){xe["a"].run(e,t)}},{key:"loadInfo",value:function(){var e=Object(u["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Te["o"].externalVmsInfoRetrieve();case 2:this.info=e.sent;case 3:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"mounted",value:function(){this.loadInfo()}}]),n}(h["b"]);Object(f["b"])([Object(v["c"])({type:Object,required:!0})],Oo.prototype,"sidebarItem",void 0),Object(f["b"])([Object(v["c"])({type:Object,required:!0})],Oo.prototype,"modelAcl",void 0),Oo=Object(f["b"])([Object(h["a"])({name:"ExternalVmsSidebar",components:{MultisidebarSaveActions:Sa,NTabs:y["a"],SidebarHeader:j["a"],VmsSidebarCamerasTab:Hc},emits:["action"]})],Oo);var yo=Oo;n("810c");const go=ce()(yo,[["render",Ja]]);var _o=go,ko=function(e){return wo.apply(this,arguments)};function wo(){return wo=Object(u["a"])(regeneratorRuntime.mark((function e(t){var n,a,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return r=t.model,e.abrupt("return",{label:(null===(n=r.item)||void 0===n?void 0:n.verbose_name)||(null===(a=r.item)||void 0===a?void 0:a.name)||""});case 2:case"end":return e.stop()}}),e)}))),wo.apply(this,arguments)}var Co={class:"multisidebar-content__main"};function xo(e,t,n,a,c,o){var i=Object(r["P"])("SidebarHeader"),s=Object(r["P"])("NTabs"),l=Object(r["P"])("NForm"),u=Object(r["P"])("MultisidebarSaveActions");return Object(r["F"])(),Object(r["i"])("div",null,[Object(r["m"])(i,{label:e.item.name,actions:e.headerActions,item:e.item,inactivated:e.isInactive,"i18n-inactivated-label":"ds.inactivated",onAction:e.actionHandler},null,8,["label","actions","item","inactivated","onAction"]),e.isExternalDetector?Object(r["h"])("",!0):(Object(r["F"])(),Object(r["g"])(s,{key:0,items:e.tabItems,modelValue:e.state.activeTab,"onUpdate:modelValue":t[0]||(t[0]=function(t){return e.state.activeTab=t}),class:"multisidebar-content__tabs control-m"},null,8,["items","modelValue"])),Object(r["j"])("div",Co,[Object(r["m"])(l,{ref:"form",layout:e.formLayout,model:e.item,state:e.state,disabled:e.disabled},null,8,["layout","model","state","disabled"])]),Object(r["m"])(u,{"model-acl":e.modelAcl,"sidebar-item":e.sidebarItem},null,8,["model-acl","sidebar-item"])])}var To=n("a3d0"),Io=n("50e5"),Ao=n("8f11");function Fo(e,t,n,a,c,o){var i=Object(r["P"])("VideoPlayer"),s=Object(r["P"])("CameraScreenshot"),l=Object(r["P"])("NButton");return Object(r["F"])(),Object(r["i"])("div",null,[e.item.active?(Object(r["F"])(),Object(r["g"])(i,{key:0,class:"video-processing-player__video",model:"videos",cameraId:e.item.id,"time-from":0,"show-controls":!1,"show-timeline":!1,"show-bottom-bar":!1},null,8,["cameraId"])):(Object(r["F"])(),Object(r["g"])(s,{key:1,"model-value":e.item.screenshot,width:"520",displayWidth:"520px"},null,8,["model-value"])),Object(r["m"])(l,{class:"video-processing-player__navigate-button",onAction:e.navigateToVideoEvents,type:"link"},{default:Object(r["eb"])((function(){return[Object(r["l"])(Object(r["T"])(e.$t("ds.open_video_events")),1)]})),_:1},8,["onAction"])])}var No=n("50f0"),So=function(e){Object(b["a"])(n,e);var t=Object(p["a"])(n);function n(){return Object(d["a"])(this,n),t.apply(this,arguments)}return Object(m["a"])(n,[{key:"navigateToVideoEvents",value:function(){Nt["a"].navigateToEvents(ke["o"].Faces,{video_archive:this.item.id})}}]),n}(h["b"]);Object(f["b"])([Object(v["c"])({type:Object,required:!0})],So.prototype,"item",void 0),So=Object(f["b"])([Object(h["a"])({name:"VideoProcessingPlayer",components:{NButton:st["c"],CameraScreenshot:Ao["a"],VideoPlayer:No["a"]}})],So);var Vo=So;n("0085");const Po=ce()(Vo,[["render",Fo]]);var Ro=Po,Mo=n("a0ae");function Eo(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n={path:"screenshot",classes:"label-m n-form-w-12 n-form-pad-10",component:Ao["a"],props:{width:520,displayWidth:"520px",hasPlay:t}},a=[{classes:"label-m n-form-w-6 n-form-pad-10",component:To["a"],props:{i18n_label:"ds.info"}},{path:"id",classes:"n-form-w-6 n-form-horizontal n-form-pad-10",i18n_label:"common.id",component:Io["a"]},{classes:"n-form-w-6 pad n-form-horizontal n-form-pad-10",i18n_label:"common.status",component:Io["a"],props:function(t){var n;return{modelValue:e?Lo(t):null===t||void 0===t||null===(n=t.health_status)||void 0===n?void 0:n.status}}},{path:"health_status.statistic.processed_duration",classes:"n-form-w-6 pad n-form-horizontal n-form-pad-10",i18n_label:"ds.process_duration",component:Io["a"]},{path:"health_status.statistic.frames_dropped",classes:"n-form-w-6 pad n-form-horizontal n-form-pad-10",i18n_label:"ds.frames_dropped",component:Io["a"]},{path:"health_status.statistic.job_starts",classes:"n-form-w-6 pad n-form-horizontal n-form-pad-10",i18n_label:"ds.job_starts",component:Io["a"]},{classes:"label-m n-form-w-6 n-form-pad-10",component:To["a"],props:{i18n_label:"ds.objects_statistics"}},{path:"health_status.statistic.objects.face.posted",classes:"n-form-w-6 pad n-form-horizontal n-form-pad-10",i18n_label:"ds.faces_posted",component:Io["a"],props:{defaultText:"-"}},{path:"health_status.statistic.objects.face.not_posted",classes:"n-form-w-6 pad n-form-horizontal n-form-pad-10",i18n_label:"ds.faces_not_posted",component:Io["a"],props:{defaultText:"-"}},{path:"health_status.statistic.objects.face.failed",classes:"n-form-w-6 pad n-form-horizontal n-form-pad-10",i18n_label:"ds.faces_failed",component:Io["a"],props:{defaultText:"-"}},{path:"health_status.statistic.objects.body.posted",classes:"n-form-w-6 pad n-form-horizontal n-form-pad-10",i18n_label:"ds.bodies_posted",component:Io["a"],props:{defaultText:"-"}},{path:"health_status.statistic.objects.body.not_posted",classes:"n-form-w-6 pad n-form-horizontal n-form-pad-10",i18n_label:"ds.bodies_not_posted",component:Io["a"],props:{defaultText:"-"}},{path:"health_status.statistic.objects.body.failed",classes:"n-form-w-6 pad n-form-horizontal n-form-pad-10",i18n_label:"ds.bodies_failed",component:Io["a"],props:{defaultText:"-"}},{path:"health_status.statistic.objects.car.posted",classes:"n-form-w-6 pad n-form-horizontal n-form-pad-10",i18n_label:"ds.cars_posted",component:Io["a"],props:{defaultText:"-"}},{path:"health_status.statistic.objects.car.not_posted",classes:"n-form-w-6 pad n-form-horizontal n-form-pad-10",i18n_label:"ds.cars_not_posted",component:Io["a"],props:{defaultText:"-"}},{path:"health_status.statistic.objects.car.failed",classes:"n-form-w-6 pad n-form-horizontal n-form-pad-10",i18n_label:"ds.cars_failed",component:Io["a"],props:{defaultText:"-"}}];return[e?Do:n].concat(a)}function Lo(e){var t=Mo["a"].getStatusInfo(Object(ir["get"])(e,"health_status.status"),e.progress,e.__upload_progress,e.finished);return t.i18n_label&&(t.label=wc["b"].getTranslatedToken(t.i18n_label,"f")),t.label}var Do={path:"screenshot",classes:"label-m n-form-w-12 n-form-pad-10",component:Ro,props:function(e){return{item:e}}},$o=n("d338"),Uo=n("8c28"),Bo=[[{path:"latitude",classes:"n-form-w-150 n-form-pad-10",i18n_label:"ds.latitude",component:z["s"],props:{units:"°",textAlign:"right",step:.1,min:-90,max:90},validators:[Object(Qa["f"])({required:!1,min:-90,max:90,float:!0})]},{path:"longitude",classes:"n-form-w-150 n-form-pad-10",i18n_label:"ds.longitude",component:z["s"],props:{units:"°",textAlign:"right",step:.1,min:-180,max:180},validators:[Object(Qa["f"])({required:!1,min:-180,max:180,float:!0})]},{path:"azimuth",classes:"n-form-w-150 n-form-pad-10",i18n_label:"ds.azimuth",component:z["s"],props:{units:"°",textAlign:"right",step:.1,min:0,max:359.9},validators:[Object(Qa["f"])({required:!1,min:0,max:359.9,float:!0})]}]],qo=Bo,Ho=(n("dca8"),n("8af0"));function Go(e,t,n,a,c,o){var i=Object(r["P"])("NSelect");return Object(r["F"])(),Object(r["g"])(i,{"model-value":e.modelValue,"search-items":e.searchOptions,"load-items":e.loadOptions,disabled:!e.hasExternalVms,"onUpdate:modelValue":e.updateValue},null,8,["model-value","search-items","load-items","disabled","onUpdate:modelValue"])}function zo(e){return{label:e.name,value:String(e.id)}}var Wo=function(e){Object(b["a"])(n,e);var t=Object(p["a"])(n);function n(){return Object(d["a"])(this,n),t.apply(this,arguments)}return Object(m["a"])(n,[{key:"hasExternalVms",get:function(){return Boolean(this.model.external_vms&&!0!==this.model.external_vms)}},{key:"loadOptions",value:function(){var e=Object(u["a"])(regeneratorRuntime.mark((function e(t){var n,a,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!this.hasExternalVms){e.next=6;break}return a=[void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,[t]],e.next=4,Te["o"].externalVmsCamerasList.apply(Te["o"],[this.model.external_vms].concat(a));case 4:return r=e.sent,e.abrupt("return",(null===(n=r.results)||void 0===n?void 0:n.map(zo))||[]);case 6:return e.abrupt("return",[]);case 7:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"searchOptions",value:function(){var e=Object(u["a"])(regeneratorRuntime.mark((function e(){var t,n,a,r,c=arguments;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t=c.length>0&&void 0!==c[0]?c[0]:"",!this.hasExternalVms){e.next=7;break}return a=[void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,t],e.next=5,Te["o"].externalVmsCamerasList.apply(Te["o"],[this.model.external_vms].concat(a));case 5:return r=e.sent,e.abrupt("return",(null===(n=r.results)||void 0===n?void 0:n.map(zo))||[]);case 7:return e.abrupt("return",[]);case 8:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"updateValue",value:function(e){this.model.url="",this.$emit("update:modelValue",e)}}]),n}(h["b"]);Object(f["b"])([Object(v["c"])({type:Number,default:null})],Wo.prototype,"modelValue",void 0),Object(f["b"])([Object(v["c"])({type:Object,required:!0})],Wo.prototype,"model",void 0),Wo=Object(f["b"])([Object(h["a"])({name:"ExternalVmsCameraSelect",components:{NSelect:gr["a"]},emits:[]})],Wo);var Yo=Wo;const Ko=ce()(Yo,[["render",Go]]);var Xo=Ko,Jo={class:"external-vms-select"},Zo={class:"external-vms-select__selector"};function Qo(e,t,n,a,c,o){var i=Object(r["P"])("NSelect"),s=Object(r["P"])("NButton");return Object(r["F"])(),Object(r["i"])("div",Jo,[Object(r["j"])("div",Zo,[Object(r["m"])(i,{"clear-icon":e.hasRealVms,"model-value":e.modelValue,items:e.options,selectonly:"","onUpdate:modelValue":e.updateValue},null,8,["clear-icon","model-value","items","onUpdate:modelValue"])]),e.hasRealVms?(Object(r["F"])(),Object(r["g"])(s,{key:0,type:"link",onAction:e.showVms},{default:Object(r["eb"])((function(){return[Object(r["l"])(Object(r["T"])(e.$t("external_vms.configure")),1)]})),_:1},8,["onAction"])):Object(r["h"])("",!0)])}var ei=function(e){Object(b["a"])(n,e);var t=Object(p["a"])(n);function n(){var e;return Object(d["a"])(this,n),e=t.apply(this,arguments),e.options=[],e}return Object(m["a"])(n,[{key:"hasRealVms",get:function(){return Boolean(this.modelValue&&!0!==this.modelValue)}},{key:"initOptions",value:function(){var e=Object(u["a"])(regeneratorRuntime.mark((function e(){var t,n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Te["o"].externalVmsList();case 2:n=e.sent,this.options=(null===(t=n.results)||void 0===t?void 0:t.map((function(e){return{label:e.verbose_name||"",value:e.id}})))||[];case 4:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"updateValue",value:function(e){this.model.url="",this.model.external_vms_camera_id=null,this.$emit("update:modelValue",void 0===e||e)}},{key:"showVms",value:function(){xe["a"].run(te["b"].ShowItem,{type:Pe["c"].ExternalVms,rawItem:this.model.external_vms})}},{key:"mounted",value:function(){this.initOptions()}}]),n}(h["b"]);Object(f["b"])([Object(v["c"])({type:Number})],ei.prototype,"modelValue",void 0),Object(f["b"])([Object(v["c"])({type:Object,required:!0})],ei.prototype,"model",void 0),ei=Object(f["b"])([Object(h["a"])({name:"ExternalVmsSelect",components:{NSelect:gr["a"],NButton:st["c"]},emits:[]})],ei);var ti=ei;n("b2bf8");const ni=ce()(ti,[["render",Qo]]);var ai=ni;function ri(e,t,n,a,c,o){var i=Object(r["P"])("NSelect");return Object(r["F"])(),Object(r["g"])(i,{"model-value":e.modelValue,items:e.options,disabled:!e.hasCamera,selectonly:"","onUpdate:modelValue":e.updateValue},null,8,["model-value","items","disabled","onUpdate:modelValue"])}var ci=function(e){Object(b["a"])(n,e);var t=Object(p["a"])(n);function n(){var e;return Object(d["a"])(this,n),e=t.apply(this,arguments),e.options=[],e}return Object(m["a"])(n,[{key:"hasCamera",get:function(){return this.model.external_vms_camera_id}},{key:"initOptions",value:function(){var e=Object(u["a"])(regeneratorRuntime.mark((function e(){var t,n,a,r=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!this.hasCamera){e.next=6;break}return e.next=3,Te["o"].externalVmsCamerasList(this.model.external_vms);case 3:n=e.sent,a=null===(t=n.results)||void 0===t?void 0:t.find((function(e){return String(e.id)===r.model.external_vms_camera_id})),this.options=(null===a||void 0===a?void 0:a.streams.map((function(e){return{label:e.url,value:e.url}})))||[];case 6:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"updateValue",value:function(e){this.$emit("update:modelValue",e)}}]),n}(h["b"]);Object(f["b"])([Object(v["c"])({type:Number,default:null})],ci.prototype,"modelValue",void 0),Object(f["b"])([Object(v["c"])({type:Object,required:!0})],ci.prototype,"model",void 0),Object(f["b"])([Object(v["f"])("model.external_vms_camera_id",{immediate:!0})],ci.prototype,"initOptions",null),ci=Object(f["b"])([Object(h["a"])({name:"ExternalVmsStreamSelect",components:{NSelect:gr["a"]},emits:[]})],ci);var oi=ci;const ii=ce()(oi,[["render",ri]]);var si=ii,li={Stream:"stream",Onvif:"onvif",ExternalDetector:"external_detector",ExternalVMS:"external_vms"};function ui(e){return e.onvif_camera?li.Onvif:e.external_vms?li.ExternalVMS:li.Stream}var di=n("531d"),mi={class:"camera-lookup-sub-form"},bi={class:"camera-lookup-sub-form__address label-m"},pi={class:"camera-lookup-sub-form__profile label-m"},fi={class:"camera-lookup-sub-form__select"};function hi(e,t,n,a,c,o){var i=Object(r["P"])("NInput"),s=Object(r["P"])("NSelect"),l=Object(r["P"])("NLoadingCircle");return Object(r["F"])(),Object(r["i"])("div",mi,[Object(r["j"])("div",bi,Object(r["T"])(e.$t("ds.camera_ip_address")),1),Object(r["j"])("div",pi,Object(r["T"])(e.$t("ds.stream_profile")),1),Object(r["m"])(i,{"model-value":e.modelValue,class:"camera-lookup-sub-form__input",disabled:"",readonly:""},null,8,["model-value"]),Object(r["j"])("div",fi,[Object(r["m"])(s,{disabled:e.isSelectDisabled,items:e.streams,modelValue:e.token,"onUpdate:modelValue":t[0]||(t[0]=function(t){return e.token=t})},null,8,["disabled","items","modelValue"]),e.running?(Object(r["F"])(),Object(r["g"])(l,{key:0,class:"camera-lookup-sub-form__select-running"})):Object(r["h"])("",!0)])])}n("841c");var vi={class:"camera-lookup"};function ji(e,t,n,a,c,o){var i=Object(r["P"])("CameraLookupLink"),s=Object(r["P"])("CameraLookupSearch"),l=Object(r["P"])("CameraLookupSummary"),u=Object(r["P"])("CameraLookupTable");return Object(r["F"])(),Object(r["i"])("div",vi,[Object(r["m"])(i,{running:e.running,onClick:e.lookup,class:"camera-lookup__link"},null,8,["running","onClick"]),Object(r["m"])(s,{class:"camera-lookup__search",search:e.search,"onUpdate:search":t[0]||(t[0]=function(t){return e.search=t})},null,8,["search"]),Object(r["m"])(l,{summary:e.cameras.length,class:"camera-lookup__summary"},null,8,["summary"]),Object(r["m"])(u,{cameras:e.queriedCameras,onSelect:e.handleCameraSelection,class:"camera-lookup__table"},null,8,["cameras","onSelect"])])}function Oi(e,t,n,a,c,o){var i=Object(r["P"])("NForm");return Object(r["F"])(),Object(r["g"])(i,{layout:e.layout,model:e.model,class:"camera-lookup-authentication-form","inline-form":"",ref:"form"},null,8,["layout","model"])}var yi=Object(r["n"])({name:"CameraLookupAuthenticationForm",components:{NForm:be["b"]},props:{login:Object(fr["j"])().isRequired,password:Object(fr["j"])().isRequired},emits:["update:login","update:password"],setup:function(e,t){var n=t.emit,a=Object(r["X"])(e),c=a.login,o=a.password,i=Object(r["K"])({login:Object(r["e"])({get:function(){return Object(r["Y"])(c)},set:function(e){return n("update:login",e)}}),password:Object(r["e"])({get:function(){return Object(r["Y"])(o)},set:function(e){return n("update:password",e)}})});return{model:i}},computed:{layout:function(){return[{classes:"label-m",component:jr["a"],i18n_label:"common.login",path:"login",validators:[{name:"required"}]},{classes:"label-m",component:jr["a"],i18n_label:"common.password",path:"password",props:{password:!0},validators:[{name:"required"}]}]}},methods:{validate:function(){var e=this.$refs.form,t=e.validate();return!t&&e.displayErrors(),t}}});n("bbf5");const gi=ce()(yi,[["render",Oi]]);var _i=gi,ki={class:"camera-lookup-authentication-window__content"},wi={class:"camera-lookup-authentication-window__footer"};function Ci(e,t,n,a,c,o){var i=Object(r["P"])("CameraLookupAuthenticationForm"),s=Object(r["P"])("NButton"),l=Object(r["P"])("NModalWindow");return Object(r["F"])(),Object(r["g"])(l,{"insert-into-body":!1,onClose:e.dispatchCloseEvent,"custom-size":"570px"},{content:Object(r["eb"])((function(){return[Object(r["j"])("div",ki,[Object(r["m"])(i,{ref:"form",login:e.login,"onUpdate:login":t[0]||(t[0]=function(t){return e.login=t}),password:e.password,"onUpdate:password":t[1]||(t[1]=function(t){return e.password=t})},null,8,["login","password"])])]})),footer:Object(r["eb"])((function(){return[Object(r["j"])("div",wi,[Object(r["m"])(s,{label:e.$t("ds.login_to_camera"),loading:e.running,onClick:e.submit},null,8,["label","loading","onClick"])])]})),_:1},8,["onClose"])}n("4d63"),n("c607"),n("2c3e"),n("00b4");function xi(e){function t(t,n){return new Promise((function(a){var c=document.body.appendChild(document.createElement("div")),o=Object(r["m"])(bs,{authenticator:t,onClose:i,onSelect:s,source:n},null);function i(){Object(r["M"])(null,document.body.removeChild(c))}function s(e){a(e),i()}Object(r["M"])((o.appContext=e,o),c)}))}return t}function Ti(e){var t=new RegExp(e,"gi");return function(e){return t.test(e)}}function Ii(){return Object(fr["d"])().isRequired}function Ai(){return Object(fr["d"])().isRequired}var Fi=function(){},Ni=Object(r["n"])({name:"CameraLookupAuthenticationWindow",components:{CameraLookupAuthenticationForm:_i,NButton:st["c"],NModalWindow:ea["b"]},props:{authenticator:Ii(),id:Object(fr["e"])().isRequired},emits:["close","done"],data:function(){return{login:"",password:"",running:!1}},setup:function(){return{form:Object(r["L"])(null)}},methods:{authenticate:function(){var e=this;this.running=!0,this.authenticator(this.id,this.login,this.password).then(this.dispatchDoneEvent).catch(Fi).finally((function(){return e.running=!1}))},dispatchCloseEvent:function(){this.$emit("close")},dispatchDoneEvent:function(e){this.$emit("done",e)},submit:function(){var e;(null===(e=this.form)||void 0===e?void 0:e.validate())&&this.authenticate()}}});n("475c");const Si=ce()(Ni,[["render",Ci]]);var Vi=Si,Pi=Object(r["j"])("path",{fill:"currentcolor",d:"M6.429 5H4.15v-.007c.103-.503.304-.98.592-1.404A3.97 3.97 0 0 1 6.47 2.166c.237-.1.485-.178.737-.229a3.99 3.99 0 0 1 1.586 0 3.911 3.911 0 0 1 1.984 1.07l1.112-1.11a5.53 5.53 0 0 0-1.747-1.18A5.44 5.44 0 0 0 9.11.398a5.562 5.562 0 0 0-2.215 0A5.531 5.531 0 0 0 3.44 2.71a5.483 5.483 0 0 0-.828 1.969c-.022.106-.034.214-.05.322H.143l3.143 3.143L6.429 5Zm3.143 1.57h2.277v.006a3.91 3.91 0 0 1-1.653 2.466 3.884 3.884 0 0 1-1.404.59 3.986 3.986 0 0 1-1.585 0 3.894 3.894 0 0 1-1.985-1.07L4.11 9.676a5.526 5.526 0 0 0 1.748 1.178 5.554 5.554 0 0 0 3.247.32A5.524 5.524 0 0 0 12.56 8.86a5.48 5.48 0 0 0 .827-1.967c.021-.106.034-.214.05-.322h2.42l-3.143-3.143-3.142 3.143Z"},null,-1),Ri=[Pi],Mi={class:"camera-lookup-link__text control-m"};function Ei(e,t,n,a,c,o){return Object(r["F"])(),Object(r["i"])("a",{class:Object(r["w"])([{"camera-lookup-link_running":e.running},"camera-lookup-link"]),onClick:t[0]||(t[0]=Object(r["hb"])((function(){return e.dispatchClickEvent&&e.dispatchClickEvent.apply(e,arguments)}),["prevent"])),href:"#"},[(Object(r["F"])(),Object(r["i"])("svg",{class:Object(r["w"])([{"camera-lookup-link__icon_running":e.running},"camera-lookup-link__icon"]),fill:"none",height:"12",width:"16",xmlns:"http://www.w3.org/2000/svg"},Ri,2)),Object(r["j"])("span",Mi,Object(r["T"])(e.text),1)],2)}var Li=Object(r["n"])({name:"CameraLookupLink",props:{running:Object(fr["c"])().def(!1)},emits:["click"],computed:{text:function(){return this.$t("ds.".concat(this.running?"discovering":"discover_again"))}},methods:{dispatchClickEvent:function(){this.$emit("click")}}});n("609a");const Di=ce()(Li,[["render",Ei]]);var $i=Di;function Ui(e,t,n,a,c,o){var i=Object(r["P"])("NInput");return Object(r["F"])(),Object(r["g"])(i,{placeholder:e.$t("common.search","f"),class:"camera-lookup-search","suffix-icon":"search",modelValue:e.model,"onUpdate:modelValue":t[0]||(t[0]=function(t){return e.model=t})},null,8,["placeholder","modelValue"])}var Bi=Object(r["n"])({name:"CameraLookupSearch",components:{NInput:jr["a"]},props:{search:qi()},emits:["update:search"],computed:{model:{get:function(){return this.search},set:function(e){this.$emit("update:search",e)}}}});function qi(){return Object(fr["j"])().isRequired}const Hi=ce()(Bi,[["render",Ui]]);var Gi=Hi,zi={class:"camera-lookup-summary heading-m"};function Wi(e,t,n,a,c,o){return Object(r["F"])(),Object(r["i"])("div",zi,Object(r["T"])(e.summary)+" "+Object(r["T"])(e.$t("ds.devices","f")),1)}var Yi=Object(r["n"])({name:"CameraLookupSummary",props:{summary:Ki()}});function Ki(){return Object(fr["e"])().isRequired}const Xi=ce()(Yi,[["render",Wi]]);var Ji=Xi;function Zi(e,t,n,a,c,o){var i=Object(r["P"])("NTable");return Object(r["F"])(),Object(r["g"])(i,{columns:e.columns,content:e.cameras,onRowClick:e.dispatchSelectEvent,"fixed-head":""},null,8,["columns","content","onRowClick"])}var Qi=Object(r["n"])({name:"CameraLookupTable",components:{NTable:tc["a"]},props:{cameras:es()},emits:["select"],computed:{columns:function(){return[{body:function(e){var t,n,a=e.model;return null!==(t=null===(n=a.meta.device.Hostname)||void 0===n?void 0:n.Name)&&void 0!==t?t:"-"},head:this.$t("ds.brand","f"),width:100},{body:"-",head:this.$t("ds.model","f"),width:100},{body:function(e){var t=e.model;return t.meta.host},head:this.$t("ds.ip_address"),width:217},{body:function(e){var t=e.model;return t.meta.port},head:this.$t("ds.port","f"),width:100},{body:"-",head:this.$t("ds.mac_address"),width:"minmax(313px, 1fr)"},{body:function(e){var t=e.model;return t.need_auth?Object(r["m"])(st["c"],{icon:"authenticate",type:"text"},null):""},head:""}]}},methods:{dispatchSelectEvent:function(e){this.$emit("select",e)}}});function es(){return Object(fr["b"])(Object(fr["g"])()).isRequired}const ts=ce()(Qi,[["render",Zi]]);var ns=ts;function as(e){function t(t,n){return new Promise((function(a){var c=document.body.appendChild(document.createElement("div")),o=Object(r["m"])(Vi,{authenticator:t,id:n,onClose:i,onDone:s},null);function i(){Object(r["M"])(null,document.body.removeChild(c))}function s(e){a(e),i()}Object(r["M"])((o.appContext=e,o),c)}))}return t}var rs=[function(e,t){var n,a,r=e.meta;return t(null!==(n=null===(a=r.device.Hostname)||void 0===a?void 0:a.Name)&&void 0!==n?n:"")},function(e,t){var n,a=e.meta;return t(null!==(n=a.host)&&void 0!==n?n:"")},function(e,t){var n=e.meta;return t(String(n.port))}];function cs(e,t,n){var a,c,o=Object(r["L"])([]),i=as(null!==(a=null===(c=Object(r["o"])())||void 0===c?void 0:c.appContext)&&void 0!==a?a:null),s=Object(r["e"])(b),l=Object(r["L"])(!1),d=Object(r["L"])("");function m(t){t.need_auth?i(Object(r["Y"])(e),t.id).then(n):n(t)}function b(){var e=Ti(Object(r["Y"])(d));return Object(r["Y"])(o).filter((function(t){return rs.some((function(n){return n(t,e)}))}))}function p(){return f.apply(this,arguments)}function f(){return f=Object(u["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,l.value=!0,e.next=4,Object(r["Y"])(t)().catch((function(){return[]}));case 4:o.value=e.sent;case 5:return e.prev=5,l.value=!1,e.finish(5);case 8:case"end":return e.stop()}}),e,null,[[0,,5,8]])}))),f.apply(this,arguments)}return Object(r["D"])(p),{cameras:o,handleCameraSelection:m,lookup:p,queriedCameras:s,running:l,search:d,window:window}}var os=Object(r["n"])({name:"CameraLookup",components:{CameraLookupLink:$i,CameraLookupSearch:Gi,CameraLookupSummary:Ji,CameraLookupTable:ns},props:{authenticator:Ii(),source:Ai()},emits:["select"],setup:function(e,t){var n=t.emit,a=Object(r["X"])(e),c=a.authenticator,o=a.source;return cs(c,o,(function(e){return n("select",e)}))}});n("751e");const is=ce()(os,[["render",ji]]);var ss=is,ls={class:"camera-lookup-window__content"};function us(e,t,n,a,c,o){var i=Object(r["P"])("CameraLookup"),s=Object(r["P"])("NModalWindow");return Object(r["F"])(),Object(r["g"])(s,{"insert-into-body":!1,onClose:e.dispatchCloseEvent,"custom-size":"1000px"},{content:Object(r["eb"])((function(){return[Object(r["j"])("div",ls,[Object(r["m"])(i,{authenticator:e.authenticator,source:e.source,onSelect:e.dispatchSelectEvent},null,8,["authenticator","source","onSelect"])])]})),_:1},8,["onClose"])}var ds=Object(r["n"])({name:"CameraLookupWindow",components:{CameraLookup:ss,NModalWindow:ea["b"]},emits:["close","select"],props:{authenticator:Ii(),source:Ai()},methods:{dispatchCloseEvent:function(){this.$emit("close")},dispatchSelectEvent:function(e){this.$emit("select",e)}}});n("72b4");const ms=ce()(ds,[["render",us]]);var bs=ms;function ps(e,t,n){var a,c,o=Object(r["L"])(null),i=(xi(null!==(a=null===(c=Object(r["o"])())||void 0===c?void 0:c.appContext)&&void 0!==a?a:null),Object(r["e"])((function(){return!Object(r["Y"])(l).length||Object(r["Y"])(s)}))),s=Object(r["L"])(!1),l=Object(r["e"])(p),d=Object(r["L"])("");function m(e){return b.apply(this,arguments)}function b(){return b=Object(u["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(e.prev=0,s.value=!0,e.t0=Object(Hr["g"])(t),!e.t0){e.next=9;break}return e.t1=n,e.next=7,v(t);case 7:e.t2=e.sent,(0,e.t1)(e.t2);case 9:return e.prev=9,s.value=!1,e.finish(9);case 12:case"end":return e.stop()}}),e,null,[[0,,9,12]])}))),b.apply(this,arguments)}function p(){var e,t;return(null!==(e=null===(t=Object(r["Y"])(o))||void 0===t?void 0:t.meta.media.Profiles)&&void 0!==e?e:[]).map((function(e){var t=e.Name,n=e.token;return{label:t,value:n}}))}function f(){return h.apply(this,arguments)}function h(){return h=Object(u["a"])(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return n=Object(r["Y"])(t).onvif_camera,e.next=3,Te["q"].onvifCamerasRetrieve(n).catch((function(){return null}));case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)}))),h.apply(this,arguments)}function v(e){return j.apply(this,arguments)}function j(){return j=Object(u["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Te["q"].onvifCamerasStartStreamingCreate(Object(Hr["a"])(Object(r["Y"])(o)).id,{profile_token:t});case 2:return e.next=4,Te["q"].onvifCamerasStreamUriRetrieve(Object(Hr["a"])(Object(r["Y"])(o)).id,t).then((function(e){var t=e.Uri;return t})).catch((function(){return""}));case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}}),e)}))),j.apply(this,arguments)}return Object(r["B"])(Object(r["db"])(d,m)),Object(r["D"])(Object(u["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,f();case 2:return e.abrupt("return",o.value=e.sent);case 3:case"end":return e.stop()}}),e)})))),{isSelectDisabled:i,lookup:m,running:s,streams:l,token:d}}var fs=Object(r["n"])({name:"CameraLookupSubForm",components:{NInput:jr["a"],NLoadingCircle:Gr["a"],NSelect:gr["a"]},props:{camera:Object(fr["g"])().isRequired,modelValue:Object(fr["j"])().isRequired},emits:["update:modelValue"],setup:function(e,t){var n=t.emit;return ps(Object(r["W"])(e,"modelValue"),Object(r["W"])(e,"camera"),(function(e){return n("update:modelValue",e)}))}});n("ca2b");const hs=ce()(fs,[["render",hi]]);var vs=hs,js=n("7501");function Os(e){var t=[{name:li.Onvif,i18n_label:"ds.connection_onvif"},{name:li.Stream,i18n_label:"ds.connection_stream"}];return e&&t.push({name:li.ExternalVMS,i18n_label:"ds.connection_external_vms"}),t}function ys(e){return[{classes:"n-form-w-6  n-form-pad-10",component:To["a"],props:{i18n_label:"ds.info"}},[{path:"name",classes:"n-form-w-3  n-form-pad-10",i18n_label:"ds.camera_name",component:jr["a"],validators:[Object(Qa["g"])()]},{path:"group",classes:"n-form-w-3 n-form-pad-10",i18n_label:"ds.camera_group",component:Ho["a"]}],{path:"comment",classes:"n-form-w-6  n-form-pad-10",i18n_label:"ds.description_optional",component:ma["a"]},{path:"stream_settings.enable_recorder",classes:"n-form-w-2 n-form-pad-10 n-form-min-h-30 n-form-vcenter",component:di["a"],props:{i18n_label:"ds.enable_recorder"},hidden:function(){var e;return!(null!==(e=fe["a"].config.vms)&&void 0!==e&&e.enabled)}},{classes:"n-form-w-2 n-form-pad-10 n-form-min-h-30 n-form-vcenter",component:di["a"],path:"stream_settings.enable_liveness",props:{i18n_label:"ds.enable_liveness"}}].concat(Object(Cn["a"])(js["a"]),[{classes:"n-form-w-6 n-form-pad-10",component:To["a"],props:{i18n_label:"ds.connection_type"}},{classes:"n-form-pad-10",component:Dn["b"],props:function(t){return Object.freeze({items:Os(e),disabled:t.id>0})},encode:function(e,t){switch(t){case li.Onvif:this.model.external_vms=null,this.model.onvif_camera=!0;break;case li.ExternalVMS:this.model.onvif_camera=null,this.model.external_vms=!0;break;default:this.model.external_vms=this.model.onvif_camera=null}},decode:function(){return ui(this.model)}}])}var gs=[{classes:"n-form-pad-10",component:vs,path:"url",props:function(e){return{camera:e}}}],_s=[{path:"url",classes:"n-form-pad-10 grow-1",i18n_label:"ds.streaming_protocol_url",component:ma["a"],props:{minRows:3},validators:[Object(Qa["g"])(),Object(Qa["i"])()]}],ks=[{i18n_label:"external_vms.vms_select",classes:"n-form-w-full n-form-pad-10",component:ai,path:"external_vms",props:function(e){return{model:e}},validators:[{i18n_message:"errors.required.field",handler:function(e){var t,n=(null===(t=e.item)||void 0===t?void 0:t.path)&&Object(ir["get"])(e.model,e.item.path);return!0!==n&&n}}]},{i18n_label:"external_vms.camera_select",classes:"n-form-w-full n-form-pad-10",component:Xo,path:"external_vms_camera_id",props:function(e){return{model:e,disabled:!e.external_vms&&!0!==e.external_vms}},validators:[Object(Qa["g"])()]},{i18n_label:"external_vms.stream_select",classes:"n-form-w-full n-form-pad-10",component:si,path:"url",props:function(e){return{model:e,disabled:!e.external_vms_camera_id}},validators:[Object(Qa["g"])()]}];function ws(e,t){var n=ys(t);switch(e){case li.Onvif:return n.concat(gs);case li.Stream:return n.concat(_s);case li.ExternalVMS:return n.concat(t?ks:_s)}return n}var Cs=n("f46e"),xs=[{path:"screenshot",classes:"label-m n-form-w-12 n-form-pad-10",component:Ao["a"],props:{width:520,displayWidth:"520px",hasPlay:!1}},[{path:"name",classes:"n-form-w-3 n-form-pad-10",i18n_label:"ds.external_detector_name",component:jr["a"],validators:[{name:be["a"].Required}]},{path:"group",classes:"n-form-w-3 n-form-pad-10",i18n_label:"ds.external_detector_camera_group",component:Ho["a"]}],{path:"comment",classes:"n-form-w-6 n-form-pad-10",i18n_label:"ds.description",component:jr["a"]},{classes:"n-form-w-2 n-form-pad-10 n-form-min-h-30 n-form-vcenter",component:di["a"],path:"stream_settings.enable_liveness",props:{i18n_label:"ds.enable_liveness"}},{path:"external_detector_token",classes:"n-form-w-6 n-form-pad-10",i18n_label:"ds.external_detector_token",component:Io["a"],props:{copy:!0}}].concat(Object(Cn["a"])(Object(me["b"])())),Ts=n("da7f"),Is=n("96a4"),As=function(e){Object(b["a"])(n,e);var t=Object(p["a"])(n);function n(){var e;return Object(d["a"])(this,n),e=t.apply(this,arguments),e.state={activeTab:"info"},e}return Object(m["a"])(n,[{key:"pageType",get:function(){return this.sidebarItem.type}},{key:"item",get:function(){return this.sidebarItem.model.item}},{key:"disabled",get:function(){return!this.modelAcl.update}},{key:"isExternalDetector",get:function(){var e;return null===(e=this.item)||void 0===e?void 0:e.external_detector}},{key:"isVideoFile",get:function(){return this.pageType===Pe["c"].Videos}},{key:"isCamera",get:function(){return this.pageType===Pe["c"].Cameras}},{key:"isInactive",get:function(){var e;return!this.isVideoFile&&!(null!==(e=this.item)&&void 0!==e&&e.active)}},{key:"tabItems",get:function(){var e=[{name:"info",label:this.$t("ds.info","f")},{name:"general",label:this.$t("ds.general","f")},{name:"advanced",label:this.$t("ds.advanced","f")},{name:"zones",label:this.$t("ds.zones","f")}].concat(Object(Cn["a"])(this.detectorTabs));if(this.isCamera){var t={name:"map",label:this.$t("ds.map","f")};e.push(t)}return e}},{key:"detectorTabs",get:function(){var e=this;return we["a"].availableObjects.map((function(t){var n,a,r;return{name:t,label:e.$t("ds.".concat(ke["n"][t]),"f"),disabled:!(null!==(n=e.item)&&void 0!==n&&null!==(a=n.stream_settings)&&void 0!==a&&null!==(r=a.detectors)&&void 0!==r&&r[t])}}))}},{key:"formLayout",get:function(){if(this.isExternalDetector)return xs;switch(this.state.activeTab){case"info":return this.dataSourceInfo;case"general":return this.dataSourceGeneral;case"advanced":return $o["a"];case"zones":return Uo["a"];case"face":return Object(Cs["a"])("face",this.isCamera);case"body":return Object(Cs["a"])("body",this.isCamera);case"car":return Object(Cs["a"])("car",this.isCamera);case"map":return qo;default:return[]}}},{key:"connectionType",get:function(){return this.isCamera?ui(this.item):""}},{key:"isExternalVmsEnabled",get:function(){var e;return!(null===(e=fe["a"].config.external_vms)||void 0===e||!e.enabled)}},{key:"isPlayEnabled",get:function(){return!this.isExternalDetector}},{key:"dataSourceInfo",get:function(){return Eo(this.isVideoFile,this.isPlayEnabled)}},{key:"dataSourceGeneral",get:function(){switch(this.pageType){case Pe["c"].Cameras:return ws(this.connectionType,this.isExternalVmsEnabled);case Pe["c"].Videos:return Object(Ts["a"])(this.sidebarItem.model.item,we["a"].availableObjects);default:return[]}}},{key:"headerActions",get:function(){var e,t,n,a,r,c,o=[];this.isCamera?o=i["b"].getItemActions(this.modelAcl,null,{hasActive:!0,currentActive:null===(t=this.item)||void 0===t?void 0:t.active,hasRestart:!this.isExternalDetector,hasChanges:this.sidebarItem.model.hasChanges,hasDelete:!0,hasCameraReset:!this.isExternalDetector}).map(i["b"].computeActionByName):o=i["b"].getItemActions(this.modelAcl,null,{isArchivable:!0,hasProcess:(null===(n=this.item)||void 0===n||null===(a=n.health_status)||void 0===a?void 0:a.status)!==Is["a"].InProgress,hasStopProcess:(null===(r=this.item)||void 0===r||null===(c=r.health_status)||void 0===c?void 0:c.status)!==Is["a"].Disabled,hasChanges:this.sidebarItem.model.hasChanges,hasDelete:!0,hasDeleteFile:!!this.item.file_size,hasVideoReset:!0}).map(i["b"].computeActionByName);var s=i["b"].getItemActions(this.modelAcl,null,{hasShowPlayer:(null===(e=fe["a"].config.vms)||void 0===e?void 0:e.enabled)&&!this.isExternalDetector&&!this.isVideoFile}).map(i["b"].computeActionByName).map(i["b"].addIconToAction).map(i["b"].makeActionVisible);return[].concat(Object(Cn["a"])(o),Object(Cn["a"])(s))}},{key:"actionHandler",value:function(){var e=Object(u["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:e.t0=t,e.next=e.t0===te["b"].Restart?3:e.t0===te["b"].ShowPlayer?5:7;break;case 3:return this.item&&Te["e"].camerasRestartCreate(this.item.id),e.abrupt("break",8);case 5:return this.item&&(this.pageType===Pe["c"].Cameras?this.$videoPlayer.playCamera(this.item.id):this.$videoPlayer.playVideo(this.item.id)),e.abrupt("break",8);case 7:xe["a"].run(t,this.sidebarItem);case 8:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"validateForm",value:function(){var e=this.$refs.form,t=!e||e.validate();return t||e.displayErrors(),t}},{key:"created",value:function(){xe["a"].getIsItemFormValid=this.validateForm.bind(this)}}]),n}(h["b"]);Object(f["b"])([Object(v["c"])({type:Object,required:!0})],As.prototype,"sidebarItem",void 0),Object(f["b"])([Object(v["c"])({type:Object,required:!0})],As.prototype,"modelAcl",void 0),As=Object(f["b"])([Object(h["a"])({name:"DataSourceSidebar",components:{MultisidebarSaveActions:Sa,NForm:be["b"],NTabs:y["a"],SidebarHeader:j["a"]}})],As);var Fs=As;const Ns=ce()(Fs,[["render",xo]]);var Ss=Ns,Vs=n("e805"),Ps=function(e){var t,n=e.model,a=n.item?function(){return Vs["a"].get("".concat(n.item.screenshot,"?width=100"))}:void 0;return{label:(null===(t=n.item)||void 0===t?void 0:t.name)||"",thumbnailSrc:a,thumbnailType:"camera"}},Rs=function(){return Ms.apply(this,arguments)};function Ms(){return Ms=Object(u["a"])(regeneratorRuntime.mark((function e(){var t,n,a=arguments;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,c["j"].apply(void 0,a);case 2:return t=e.sent,n=t.model.save,t.model.save=Object(u["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return this.item.external_detector&&delete this.item.url,e.abrupt("return",n.apply(t.model));case 2:case"end":return e.stop()}}),e,this)}))),e.abrupt("return",t);case 6:case"end":return e.stop()}}),e)}))),Ms.apply(this,arguments)}function Es(e,t,n,a,c,o){var i=Object(r["P"])("SidebarHeader"),s=Object(r["P"])("NTabs"),l=Object(r["P"])("CounterRecords"),u=Object(r["P"])("CounterForm"),d=Object(r["P"])("CounterROIList"),m=Object(r["P"])("MultisidebarSaveActions");return Object(r["F"])(),Object(r["i"])(r["a"],null,[Object(r["m"])(i,{label:e.currentItem.name,"sub-label":e.currentItem.name,inactivated:!e.currentItem.active,changed:e.moduleItem.hasChanges,"i18n-inactivated":"common.user_inactive",actions:e.headerActions,onAction:t[0]||(t[0]=function(t){return e.actionHandler(t,e.sidebarItem)})},null,8,["label","sub-label","inactivated","changed","actions"]),Object(r["m"])(s,{items:e.tabItems,modelValue:e.activeTab,"onUpdate:modelValue":t[1]||(t[1]=function(t){return e.activeTab=t}),class:"multisidebar-content__tabs control-m"},null,8,["items","modelValue"]),"records"===e.activeTab?(Object(r["F"])(),Object(r["g"])(l,{key:0,counterId:e.currentItem.id},null,8,["counterId"])):Object(r["h"])("",!0),"information"===e.activeTab?(Object(r["F"])(),Object(r["g"])(u,{key:1,ref:"form",model:e.currentItem,disabled:e.disabled},null,8,["model","disabled"])):Object(r["h"])("",!0),"roi"===e.activeTab?(Object(r["F"])(),Object(r["g"])(d,{key:2,model:e.currentItem,disabled:e.disabled},null,8,["model","disabled"])):Object(r["h"])("",!0),Object(r["m"])(m,{"sidebar-item":e.sidebarItem,"model-acl":e.modelAcl},null,8,["sidebar-item","model-acl"])],64)}var Ls={class:"counter-roi"},Ds={class:"counter-roi__actions"},$s={class:"counter-roi__content"};function Us(e,t,n,a,c,o){var i=Object(r["P"])("CameraName"),s=Object(r["P"])("NCheckbox"),l=Object(r["P"])("NButton"),u=Object(r["P"])("NLoadingCircle"),d=Object(r["P"])("PolygonDrawTool");return Object(r["F"])(),Object(r["i"])("div",Ls,[Object(r["j"])("div",Ds,[Object(r["m"])(i,{modelValue:e.cameraId,"onUpdate:modelValue":t[0]||(t[0]=function(t){return e.cameraId=t}),idIn:e.model.cameras,readonly:""},null,8,["modelValue","idIn"]),Object(r["m"])(s,{modelValue:e.onlyRect,"onUpdate:modelValue":t[1]||(t[1]=function(t){return e.onlyRect=t}),disabled:e.disabled},{default:Object(r["eb"])((function(){return[Object(r["l"])(Object(r["T"])(e.$t("counters.rect")),1)]})),_:1},8,["modelValue","disabled"]),Object(r["m"])(l,{onAction:t[2]||(t[2]=function(t){return e.loadCameraImage(!0)}),icon:"table-action-refresh",disabled:e.loading},null,8,["disabled"]),e.hasFullscreen?(Object(r["F"])(),Object(r["g"])(l,{key:0,onAction:e.dispatchShowModal,icon:"fullscreen"},null,8,["onAction"])):Object(r["h"])("",!0),Object(r["m"])(l,{onAction:e.clearRect,disabled:e.disabled},{default:Object(r["eb"])((function(){return[Object(r["l"])(Object(r["T"])(e.$t("counters.clear")),1)]})),_:1},8,["onAction","disabled"])]),Object(r["j"])("div",$s,[e.error?(Object(r["F"])(),Object(r["g"])(l,{key:0,type:"text",onAction:e.loadCameraImage,icon:"file-broken","icon-size":"60"},null,8,["onAction"])):e.loading?(Object(r["F"])(),Object(r["g"])(u,{key:1})):e.hasCamera?(Object(r["F"])(),Object(r["g"])(d,{key:2,ref:"drawTool",onlyRect:e.onlyRect,image:e.imageDataUrl,points:e.points,disabled:e.disabled,onChange:t[3]||(t[3]=function(t){return e.points=t})},null,8,["onlyRect","image","points","disabled"])):Object(r["h"])("",!0)])])}var Bs=n("c656"),qs=n("35ac"),Hs=n("bc3a"),Gs=n.n(Hs),zs=n("554f"),Ws=n("8fc8");function Ys(e){if(4!==e.length)return!1;var t=Object(Br["a"])(e,4),n=t[0],a=t[1],r=t[2],c=t[3];return n[0]===c[0]&&n[1]===a[1]&&a[0]===r[0]&&r[1]===c[1]}var Ks=function(e){Object(b["a"])(n,e);var t=Object(p["a"])(n);function n(){var e;return Object(d["a"])(this,n),e=t.apply(this,arguments),e.loading=!1,e.error=!1,e.sourceCancelToken=null,e.onlyRect=!1,e.imageDataUrl="",e}return Object(m["a"])(n,[{key:"hasCamera",get:function(){return-1!==this.cameraId&&this.imageDataUrl}},{key:"points",get:function(){var e;return this.hasCamera&&(null===(e=this.model.roi)||void 0===e?void 0:e[this.cameraId])||[]},set:function(e){this.hasCamera&&(!this.model.roi&&e&&(this.model.roi={}),this.model.roi&&(this.model.roi[this.cameraId]=e))}},{key:"mounted",value:function(){this.loadCameraImage()}},{key:"loadCameraImage",value:function(){var e=Object(u["a"])(regeneratorRuntime.mark((function e(){var t,n,a,r,c,o,i,s,l=arguments;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t=l.length>0&&void 0!==l[0]&&l[0],this.loading=!0,this.error=!1,e.prev=3,this.sourceCancelToken&&(this.sourceCancelToken.cancel(),this.sourceCancelToken=null),this.sourceCancelToken=Gs.a.CancelToken.source(),c=null===(n=zs["b"].token)||void 0===n?void 0:n.toString(),o=(null!==(a=null===(r=fe["a"].config.server)||void 0===r?void 0:r.url)&&void 0!==a?a:"/")+"cameras/".concat(this.cameraId,"/screenshot/"),e.next=10,Gs()({url:o,method:t?"POST":"GET",responseType:"blob",headers:{Authorization:"Token "+encodeURIComponent(c)},cancelToken:this.sourceCancelToken.token});case 10:i=e.sent,s=i.data,this.imageDataUrl=URL.createObjectURL(s),e.next=18;break;case 15:e.prev=15,e.t0=e["catch"](3),this.error=!0;case 18:return e.prev=18,this.loading=!1,this.sourceCancelToken=null,e.finish(18);case 22:this.model.roi&&(this.onlyRect=Ys(this.points));case 23:case"end":return e.stop()}}),e,this,[[3,15,18,22]])})));function t(){return e.apply(this,arguments)}return t}()},{key:"clearRect",value:function(){var e;null===(e=this.$refs.drawTool)||void 0===e||e.clear()}},{key:"dispatchShowModal",value:function(){this.$emit("showModal")}}]),n}(h["b"]);Object(f["b"])([Object(v["c"])({type:Object,required:!0})],Ks.prototype,"model",void 0),Object(f["b"])([Object(v["c"])({type:Number,required:!0})],Ks.prototype,"cameraId",void 0),Object(f["b"])([Object(v["c"])({type:Boolean,default:!0})],Ks.prototype,"hasFullscreen",void 0),Object(f["b"])([Object(v["c"])({type:Boolean,default:!1})],Ks.prototype,"disabled",void 0),Ks=Object(f["b"])([Object(h["a"])({name:"CounterROI",components:{NIcon:Ws["a"],NLoadingCircle:Gr["a"],NButton:st["c"],CameraName:qs["a"],NCheckbox:Ln["a"],PolygonDrawTool:Bs["a"]},emits:["showModal"]})],Ks);var Xs=Ks;n("6543");const Js=ce()(Xs,[["render",Us]]);var Zs=Js,Qs=n("17c5"),el=n("f310"),tl={class:"counter-roi-list"};function nl(e,t,n,a,c,o){var i=Object(r["P"])("CounterROI"),s=Object(r["P"])("CounterROIModal");return Object(r["F"])(),Object(r["i"])(r["a"],null,[Object(r["j"])("div",tl,[(Object(r["F"])(!0),Object(r["i"])(r["a"],null,Object(r["N"])(e.model.cameras,(function(t,n){return Object(r["F"])(),Object(r["g"])(i,{key:t,model:e.model,cameraId:t,disabled:e.disabled,onShowModal:function(t){return e.showModal(n)}},null,8,["model","cameraId","disabled","onShowModal"])})),128))]),e.modalEnabled?(Object(r["F"])(),Object(r["g"])(s,{key:0,model:e.model,cameraStartIndex:e.cameraStartIndex,disabled:e.disabled,onClose:t[0]||(t[0]=function(t){return e.modalEnabled=!1})},null,8,["model","cameraStartIndex","disabled"])):Object(r["h"])("",!0)],64)}function al(e,t,n,a,c,o){var i=Object(r["P"])("CounterROI"),s=Object(r["P"])("NButton"),l=Object(r["P"])("NModalWindow");return Object(r["F"])(),Object(r["g"])(l,{"has-margins":!1,layout:"",customSize:"90vw","class-name":"counter-roi-modal"},{default:Object(r["eb"])((function(){return[(Object(r["F"])(),Object(r["g"])(i,{model:e.model,cameraId:e.cameraId,key:e.cameraId,hasFullscreen:!1,disabled:e.disabled,class:"counter-roi-modal__item"},null,8,["model","cameraId","disabled"])),e.hasArrows?(Object(r["F"])(),Object(r["g"])(s,{key:0,icon:"scroll-left",type:"link",class:"counter-roi-modal__arrow counter-roi-modal__arrow_left",onAction:e.prev},null,8,["onAction"])):Object(r["h"])("",!0),e.hasArrows?(Object(r["F"])(),Object(r["g"])(s,{key:1,icon:"scroll-right",type:"link",class:"counter-roi-modal__arrow counter-roi-modal__arrow_right",onAction:e.next},null,8,["onAction"])):Object(r["h"])("",!0)]})),_:1})}var rl=function(e){Object(b["a"])(n,e);var t=Object(p["a"])(n);function n(){var e;return Object(d["a"])(this,n),e=t.apply(this,arguments),e.cameraIndex=e.cameraStartIndex,e}return Object(m["a"])(n,[{key:"cameraId",get:function(){return this.model.cameras[this.cameraIndex]}},{key:"itemsCount",get:function(){return this.model.cameras.length}},{key:"hasArrows",get:function(){return this.itemsCount>1}},{key:"mounted",value:function(){this.bindArrowsHandler()}},{key:"beforeUnmount",value:function(){this.unbindArrowsHandler()}},{key:"next",value:function(){this.cameraIndex=this.cameraIndex===this.itemsCount-1?0:this.cameraIndex+1}},{key:"prev",value:function(){this.cameraIndex=0===this.cameraIndex?this.itemsCount-1:this.cameraIndex-1}},{key:"bindArrowsHandler",value:function(){document.addEventListener("keyup",this.handleArrow.bind(this))}},{key:"unbindArrowsHandler",value:function(){document.removeEventListener("keyup",this.handleArrow.bind(this))}},{key:"handleArrow",value:function(e){"ArrowLeft"===e.key&&this.prev(),"ArrowRight"===e.key&&this.next()}}]),n}(h["b"]);Object(f["b"])([Object(v["c"])({type:Object,required:!0})],rl.prototype,"model",void 0),Object(f["b"])([Object(v["c"])({type:Number,required:!0})],rl.prototype,"cameraStartIndex",void 0),Object(f["b"])([Object(v["c"])({type:Boolean,default:!1})],rl.prototype,"disabled",void 0),rl=Object(f["b"])([Object(h["a"])({name:"CounterROIModal",components:{NButton:st["c"],NModalWindow:ea["b"],CounterROI:Zs}})],rl);var cl=rl;n("bfa4");const ol=ce()(cl,[["render",al]]);var il=ol,sl=function(e){Object(b["a"])(n,e);var t=Object(p["a"])(n);function n(){var e;return Object(d["a"])(this,n),e=t.apply(this,arguments),e.modalEnabled=!1,e.cameraStartIndex=null,e}return Object(m["a"])(n,[{key:"showModal",value:function(e){this.modalEnabled=!0,this.cameraStartIndex=e}}]),n}(h["b"]);Object(f["b"])([Object(v["c"])({type:Object,required:!0})],sl.prototype,"model",void 0),Object(f["b"])([Object(v["c"])({type:Boolean,default:!1})],sl.prototype,"disabled",void 0),sl=Object(f["b"])([Object(h["a"])({name:"CounterROIList",components:{CounterROIModal:il,CounterROI:Zs}})],sl);var ll=sl;n("4a7a");const ul=ce()(ll,[["render",nl]]);var dl=ul,ml=function(e){Object(b["a"])(n,e);var t=Object(p["a"])(n);function n(){var e;return Object(d["a"])(this,n),e=t.apply(this,arguments),e.activeTab="information",e}return Object(m["a"])(n,[{key:"moduleItem",get:function(){return this.sidebarItem.model}},{key:"currentItem",get:function(){return this.sidebarItem.model.item}},{key:"disabled",get:function(){return!(this.moduleItem.isNew?this.modelAcl.add:this.modelAcl.update)}},{key:"headerActions",get:function(){var e;return i["b"].getItemActions(this.modelAcl,null,{hasChanges:this.moduleItem.hasChanges,hasActive:!0,hasDelete:!0,currentActive:null===(e=this.currentItem)||void 0===e?void 0:e.active}).map(i["b"].computeActionByName)}},{key:"tabItems",get:function(){return this.moduleItem.isNew?[{name:"information",label:this.$t("counters.information","f")}]:[{name:"records",label:this.$t("counters.records","f")},{name:"information",label:this.$t("counters.information","f")},{name:"roi",label:this.$t("counters.roi","f")}]}},{key:"actionHandler",value:function(e,t){xe["a"].run(e,t)}},{key:"validateForm",value:function(){return"roi"===this.activeTab||this.$refs.form.validate()}},{key:"mounted",value:function(){xe["a"].getIsItemFormValid=this.validateForm.bind(this)}}]),n}(h["b"]);Object(f["b"])([Object(v["c"])({type:Object,required:!0})],ml.prototype,"sidebarItem",void 0),Object(f["b"])([Object(v["c"])({type:Object,required:!0})],ml.prototype,"modelAcl",void 0),ml=Object(f["b"])([Object(h["a"])({name:"CounterSidebar",components:{CounterROIList:dl,MultisidebarSaveActions:Sa,SidebarTab:Oa["a"],SidebarHeader:j["a"],CounterROI:Zs,CounterForm:Qs["a"],CounterRecords:el["a"],NTabs:y["a"]}})],ml);var bl=ml;const pl=ce()(bl,[["render",Es]]);var fl=pl,hl=function(e){return vl.apply(this,arguments)};function vl(){return vl=Object(u["a"])(regeneratorRuntime.mark((function e(t){var n,a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return a=t.model,e.abrupt("return",{label:(null===(n=a.item)||void 0===n?void 0:n.name)||""});case 2:case"end":return e.stop()}}),e)}))),vl.apply(this,arguments)}var jl={class:"webhooks-sidebar"};function Ol(e,t,n,a,c,o){var i=Object(r["P"])("SidebarHeader"),s=Object(r["P"])("NForm"),l=Object(r["P"])("MultisidebarSaveActions");return Object(r["F"])(),Object(r["i"])("div",jl,[Object(r["m"])(i,{actions:e.headerActions,changed:e.module.hasChanges,label:e.currentItem.name,"model-acl":e.modelAcl,onAction:t[0]||(t[0]=function(t){return e.actionHandler(t,e.sidebarItem)}),class:"external-vms-sidebar__header"},null,8,["actions","changed","label","model-acl"]),Object(r["m"])(s,{ref:"form",model:e.currentItem,layout:e.layout,disabled:e.disabled},null,8,["model","layout","disabled"]),Object(r["m"])(l,{"sidebar-item":e.sidebarItem,"model-acl":e.modelAcl},null,8,["sidebar-item","model-acl"])])}var yl=n("4264");function gl(e,t,n,a,c,o){var i=Object(r["P"])("NTextareaAutosize"),s=Object(r["P"])("NTooltip");return Object(r["F"])(),Object(r["i"])(r["a"],null,[Object(r["m"])(i,{"model-value":e.modelValueString,"onUpdate:modelValue":e.dispatchModelValueUpdate,ref:"area",rows:"18",disabled:e.disabled},null,8,["model-value","onUpdate:modelValue","disabled"]),e.isInvalid?(Object(r["F"])(),Object(r["g"])(s,{key:0,reference:e.$refs.area.$el,placement:"left-start",mode:"manual"},{default:Object(r["eb"])((function(){return[Object(r["l"])(Object(r["T"])(e.$t("errors.json_invalid","f")),1)]})),_:1},8,["reference"])):Object(r["h"])("",!0)],64)}var _l=n("53ca"),kl=(n("e9c4"),n("93de")),wl=function(e){Object(b["a"])(n,e);var t=Object(p["a"])(n);function n(){var e;return Object(d["a"])(this,n),e=t.apply(this,arguments),e.isInvalid=!1,e}return Object(m["a"])(n,[{key:"modelValueString",get:function(){return this.modelValue&&"object"===Object(_l["a"])(this.modelValue)?JSON.stringify(this.modelValue,null,"\t"):"{}"}},{key:"dispatchModelValueUpdate",value:function(e){this.isInvalid=!1;try{var t=JSON.parse(e);this.$emit("update:modelValue",t)}catch(n){this.isInvalid=!0}}}]),n}(h["b"]);Object(f["b"])([Object(v["c"])({type:Object,default:function(){return{}}})],wl.prototype,"modelValue",void 0),Object(f["b"])([Object(v["c"])({type:Boolean,default:!1})],wl.prototype,"disabled",void 0),wl=Object(f["b"])([Object(h["a"])({name:"WebhooksFiltersEditor",components:{NTooltip:kl["a"],NTextareaAutosize:ma["a"]},emits:["update:modelValue"]})],wl);var Cl=wl;const xl=ce()(Cl,[["render",gl]]);var Tl=xl,Il=[{path:"name",classes:"label-m n-form-w-2 n-form-pad-10 camera-group-form-pad",i18n_label:"webhooks.webhook_title",component:jr["a"],validators:[Object(Qa["g"])(),Object(Qa["h"])({min:2,max:100})]},{path:"url",classes:"label-m n-form-w-4 n-form-pad-10 camera-group-form-pad",i18n_label:"common.url",component:jr["a"],validators:[Object(Qa["i"])()]},{classes:"label-m n-form-w-6 n-form-pad-10 camera-group-form-pad",i18n_label:"webhooks.batch_size",component:yl["a"]},{path:"batch_size",classes:"label-m n-form-w-1",component:z["s"],props:{controls:!1},validators:[Object(Qa["f"])({required:!1,min:1})]},{classes:"label-m n-form-w-6 camera-group-form-pad",i18n_label:"webhooks.send_attempts",component:yl["a"]},[{path:"send_attempts",classes:"label-m n-form-w-1",component:z["s"],props:{controls:!1},validators:[Object(Qa["f"])({required:!0,min:0})]},{classes:"label-m n-form-tip",component:yl["a"],i18n_label:"webhooks.send_attempts_tip"}],{path:"filters",classes:"label-m n-form-w-6 n-form-pad-10 camera-group-form-pad",i18n_label:"webhooks.filters",component:Tl,validators:[Object(Qa["g"])()]},{path:"active",classes:"label-m n-form-w-6 n-form-pad-10 camera-group-form-pad",props:{i18n_label:"common.active"},component:Ln["a"]},{classes:"label-m n-form-pad-10 n-form-label-horizontal-100 camera-group-form-pad",component:yl["a"],props:function(e){return{i18n_label:"webhooks.webhook_id",value:e.id,hidden:e.id<1}}}],Al=Il,Fl=function(e){Object(b["a"])(n,e);var t=Object(p["a"])(n);function n(){return Object(d["a"])(this,n),t.apply(this,arguments)}return Object(m["a"])(n,[{key:"currentItem",get:function(){return this.module.item}},{key:"disabled",get:function(){return!(this.module.isNew?this.modelAcl.add:this.modelAcl.update)}},{key:"module",get:function(){return this.sidebarItem.model}},{key:"headerActions",get:function(){return i["b"].getItemActions(this.modelAcl,null,{hasChanges:this.module.hasChanges,hasDelete:!0}).map(i["b"].computeActionByName)}},{key:"layout",get:function(){return Al}},{key:"mounted",value:function(){xe["a"].getIsItemFormValid=this.validateForm.bind(this)}},{key:"actionHandler",value:function(e,t){xe["a"].run(e,t)}},{key:"validateForm",value:function(){var e=this.$refs.form,t=!e||e.validate();return t||e.displayErrors(),t}}]),n}(h["b"]);Object(f["b"])([Object(v["c"])({type:Object,required:!0})],Fl.prototype,"sidebarItem",void 0),Object(f["b"])([Object(v["c"])({type:Object,required:!0})],Fl.prototype,"modelAcl",void 0),Fl=Object(f["b"])([Object(h["a"])({name:"WebhooksSidebar",components:{MultisidebarSaveActions:Sa,SidebarHeader:j["a"],NForm:z["n"]},emits:["action"]})],Fl);var Nl=Fl;n("c7c9");const Sl=ce()(Nl,[["render",Ol]]);var Vl=Sl,Pl=function(e){return Rl.apply(this,arguments)};function Rl(){return Rl=Object(u["a"])(regeneratorRuntime.mark((function e(t){var n,a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return a=t.model,e.abrupt("return",{label:(null===(n=a.item)||void 0===n?void 0:n.name)||""});case 2:case"end":return e.stop()}}),e)}))),Rl.apply(this,arguments)}var Ml={class:"multisidebar-content__main"};function El(e,t,n,a,c,o){var i=Object(r["P"])("SidebarHeader"),s=Object(r["P"])("NTabs"),l=Object(r["P"])("UserForm"),u=Object(r["P"])("UserFaces"),d=Object(r["P"])("MultisidebarSaveActions");return Object(r["F"])(),Object(r["i"])("div",null,[Object(r["m"])(i,{label:e.item.real_name,"sub-label":e.item.name,inactivated:!e.item.active,changed:e.sidebarItem.model.hasChanges,actions:e.headerActions,"model-acl":e.modelAcl,"i18n-inactivated":"common.user_inactive",onAction:t[0]||(t[0]=function(t){return e.actionHandler(t,e.sidebarItem)})},null,8,["label","sub-label","inactivated","changed","actions","model-acl"]),Object(r["m"])(s,{items:e.tabItems,modelValue:e.activeTab,"onUpdate:modelValue":t[1]||(t[1]=function(t){return e.activeTab=t}),class:"multisidebar-content__tabs control-m"},null,8,["items","modelValue"]),Object(r["j"])("div",Ml,["information"===e.activeTab?(Object(r["F"])(),Object(r["g"])(l,{key:0,"is-new":e.isNew,item:e.item,disabled:!e.modelAcl.update},null,8,["is-new","item","disabled"])):(Object(r["F"])(),Object(r["g"])(u,{key:1,"is-new":e.isNew,item:e.item},null,8,["is-new","item"]))]),Object(r["m"])(d,{"model-acl":e.modelAcl,"sidebar-item":e.sidebarItem},null,8,["model-acl","sidebar-item"])])}function Ll(e,t,n,a,c,o){var i=Object(r["P"])("NForm");return Object(r["F"])(),Object(r["g"])(i,{layout:e.layout,model:e.item,ref:"itemForm"},null,8,["layout","model"])}var Dl={class:"user-roles"},$l={key:0,class:"user-roles__add"};function Ul(e,t,n,a,c,o){var i=Object(r["P"])("NTable"),s=Object(r["P"])("NSelect");return Object(r["F"])(),Object(r["i"])("div",Dl,[Object(r["m"])(i,{columns:e.columns,content:e.embeddedUserGroups,hover:!1,onAction:e.handleTableAction},null,8,["columns","content","onAction"]),e.groupAddItems.length?(Object(r["F"])(),Object(r["i"])("div",$l,[e.item.ad_user?Object(r["h"])("",!0):(Object(r["F"])(),Object(r["g"])(s,{key:0,"model-value":[],placeholder:e.$t("common.add_role","f"),items:e.groupAddItems,"fill-value-on-select":!1,selectonly:"","onUpdate:modelValue":e.addGroup},null,8,["placeholder","items","onUpdate:modelValue"]))])):Object(r["h"])("",!0)])}n("caad"),n("2532"),n("a434"),n("c740");var Bl=n("1e97"),ql=n("92f1");function Hl(e,t,n,a,c,o){var i=Object(r["P"])("NButton");return Object(r["F"])(),Object(r["g"])(i,Object(r["u"])(e.$props,{onClick:e.handleClick}),null,16,["onClick"])}var Gl=Object(r["n"])({name:"NTableButtonCell",components:{NButton:st["c"]},props:{modelValue:{type:String,default:""}},emits:["update:modelValue"],methods:{handleClick:function(){this.$emit("update:modelValue",this.modelValue)}}});const zl=ce()(Gl,[["render",Hl]]);var Wl=zl,Yl=function(e){Object(b["a"])(n,e);var t=Object(p["a"])(n);function n(){return Object(d["a"])(this,n),t.apply(this,arguments)}return Object(m["a"])(n,[{key:"embeddedUserGroups",get:function(){var e=this;return this.groups.filter((function(t){var n;return(null===(n=e.item.groups)||void 0===n?void 0:n.includes(t.id))||t.id===e.item.primary_group}))}},{key:"groupAddItems",get:function(){var e=this;return this.groups.filter((function(t){return!e.embeddedUserGroups.find((function(e){return e.id===t.id}))})).map((function(e){return{label:e.name,value:e.id}}))}},{key:"groups",get:function(){return Q["a"].groupsModule.items}},{key:"columns",get:function(){var e=this;return[{width:"325px",header:{classes:["bottom-border"],component:Bl["a"],props:{i18n_label:"common.roles"}},content:{path:"name",component:Io["a"]}},{width:"120px",header:{classes:["bottom-border","align-center"],component:Bl["a"],props:{i18n_label:"common.primary_role"}},content:{classes:["align-center"],path:"primary_group",component:z["w"],decode:function(){return e.item.primary_group},props:function(e){return{selectValue:e.id}}}},{width:"40px",header:{classes:["bottom-border","align-center"],component:Bl["a"]},content:{path:"group_remove",classes:["align-center"],component:Wl,props:function(){return{type:"text",icon:"trash",disabled:!e.item.groups||0===e.item.groups.length}}}}]}},{key:"addGroup",value:function(e){var t;void 0!==e&&(null===(t=this.item.groups)||void 0===t||t.push(e))}},{key:"removeGroup",value:function(e){if(this.item.primary_group===e){var t,n,a=null===(t=this.item.groups)||void 0===t?void 0:t[0];if(void 0===a)throw new Error("Can't delete last user group. User should has at least one group!");this.item.primary_group=a,null===(n=this.item.groups)||void 0===n||n.splice(0,1)}else if(this.item.groups){var r=this.item.groups.findIndex((function(t){return t===e}));-1!==r&&this.item.groups.splice(r,1)}}},{key:"updatePrimaryGroup",value:function(e){var t=this.item.primary_group;if(this.item.groups){var n=this.item.groups.findIndex((function(t){return e===t}));-1!==n&&this.item.groups.splice(n,1,t)}this.item.primary_group=e}},{key:"handleTableAction",value:function(e){if("change"===e.type)switch(e.path){case"primary_group":this.updatePrimaryGroup(e.value);break;case"group_remove":this.removeGroup(e.row.id);break;default:console.warn("[UserRoles] Unknown table action path:"+e.path)}}}]),n}(h["b"]);Object(f["b"])([Object(v["c"])({type:Object,required:!0})],Yl.prototype,"item",void 0),Yl=Object(f["b"])([Object(h["a"])({components:{NTable:ql["a"],NRadio:z["w"],NSelect:z["x"]}})],Yl);var Kl=Yl;n("1c237");const Xl=ce()(Kl,[["render",Ul]]);var Jl=Xl;function Zl(e){return e.model.password===e.model.password_confirm}function Ql(e){return!!e.model.primary_group}var eu=function(e){Object(b["a"])(n,e);var t=Object(p["a"])(n);function n(){var e;return Object(d["a"])(this,n),e=t.apply(this,arguments),e.changePasswordEnabled=!1,e}return Object(m["a"])(n,[{key:"isADUser",get:function(){var e;return fe["a"].config.services.ffsecurity.active_directory&&(null===(e=this.item)||void 0===e?void 0:e.ad_user)}},{key:"layout",get:function(){return[].concat(Object(Cn["a"])(this.names),Object(Cn["a"])(this.passwords),Object(Cn["a"])(this.commentAndRoles),Object(Cn["a"])(this.meta))}},{key:"passwords",get:function(){var e=this,t=[{classes:"n-form-w-6 n-form-pad-10 control-l n-form-block-start",component:z["b"],props:{i18n_label:"common.password_change",type:"link"},on:{click:function(){e.changePasswordEnabled=!e.changePasswordEnabled}}}],n=[[{path:"password",classes:"n-form-w-3 n-form-pad-10 label-m",i18n_label:"common.password",component:jr["a"],i18n_tooltip:"common.password_desc",props:{password:!0},validators:[{name:"required",i18n_message:"errors.required.password"},{handler:Zl,i18n_message:"errors.confirm.password"},Object(Qa["b"])(),Object(Qa["e"])(),Object(Qa["h"])({min:8})]},{path:"password_confirm",classes:"n-form-w-3 n-form-pad-10 label-m n-form-ml-1",i18n_label:"common.password_repeat",component:jr["a"],props:{password:!0}}]];return this.isADUser?[]:this.changePasswordEnabled||this.isNew?n:t}},{key:"names",get:function(){var e=[{path:"real_name",classes:"n-form-w-6 n-form-pad-10 label-m",i18n_label:"common.name",component:jr["a"],validators:[{name:be["a"].Required,i18n_message:"errors.required.name"}]},{path:"name",classes:"n-form-w-6 n-form-pad-10 label-m",i18n_label:"common.login",component:jr["a"],validators:[{name:be["a"].Required,i18n_message:"errors.required.login"}]}],t=[{classes:"n-form-w-6 n-form-color-400",component:Io["a"],props:{i18n_modelValue:"common.user_ad_label",class:"label-m"}},{path:"real_name",classes:"n-form-w-6 n-form-pad-10 n-form-block-start",i18n_label:"common.name",component:Io["a"],props:{class:"label-m"}},{path:"name",classes:"n-form-w-6 n-form-pad-10 label-m",i18n_label:"common.login",component:Io["a"],props:{class:"label-m"}}];return this.isADUser?t:e}},{key:"commentAndRoles",get:function(){return[{path:"comment",classes:"n-form-w-6 n-form-pad-10 label-m n-form-block-start",i18n_label:"common.comment",component:ma["a"]},{classes:"n-form-w-6 n-form-block-start",component:Jl,props:{item:this.item},validators:[{handler:Ql,i18n_message:"errors.required.primary_group"}]}]}},{key:"meta",get:function(){return this.isNew?[]:Object(me["b"])()}},{key:"validateForm",value:function(){var e=!this.$refs.itemForm||this.$refs.itemForm.validate();return!e&&this.$refs.itemForm.displayErrors(),e}},{key:"created",value:function(){var e=Object(u["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:xe["a"].getIsItemFormValid=this.validateForm.bind(this);case 1:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()}]),n}(h["b"]);Object(f["b"])([Object(v["c"])({type:Object,required:!0})],eu.prototype,"item",void 0),Object(f["b"])([Object(v["c"])({type:Boolean,default:!1})],eu.prototype,"isNew",void 0),eu=Object(f["b"])([Object(h["a"])({name:"UserForm",components:{NForm:be["b"]},emits:[]})],eu);var tu=eu;const nu=ce()(tu,[["render",Ll]]);var au=nu,ru={class:"user-photos"},cu={key:0,class:"control-m"},ou={key:1,class:"control-m"},iu={key:0,class:"user-photos__items"};function su(e,t,n,a,c,o){var i=Object(r["P"])("FileAttachButton"),s=Object(r["P"])("CameraShotAttach"),l=Object(r["P"])("NBaseBar"),u=Object(r["P"])("UserFace"),d=Object(r["P"])("NAttachments"),m=Object(r["P"])("DetectionDialog");return Object(r["F"])(),Object(r["i"])("div",ru,[Object(r["m"])(l,{class:"user-photos__bar"},{start:Object(r["eb"])((function(){return[e.items.length?(Object(r["F"])(),Object(r["i"])("div",cu,Object(r["T"])(e.items.length)+" "+Object(r["T"])(e.$t("common.total")),1)):(Object(r["F"])(),Object(r["i"])("div",ou,Object(r["T"])(e.$t("common.no_photos")),1))]})),end:Object(r["eb"])((function(){return[Object(r["m"])(i,{onAttach:e.handleAttach},null,8,["onAttach"]),Object(r["m"])(s,{onAttach:e.handleAttach},null,8,["onAttach"])]})),_:1}),e.items.length?(Object(r["F"])(),Object(r["i"])("div",iu,[(Object(r["F"])(!0),Object(r["i"])(r["a"],null,Object(r["N"])(e.items,(function(t,n){return Object(r["F"])(),Object(r["g"])(u,{"is-cover":e.getIsCover(t),face:t,key:n,onAction:function(n){return e.handleAction(n,t)}},null,8,["is-cover","face","onAction"])})),128))])):e.module.loading?Object(r["h"])("",!0):(Object(r["F"])(),Object(r["g"])(d,{key:1,onAttach:e.handleDndAttach,accept:"image/*",class:"user-photos__dnd","disallow-attach":"",drag:"","hide-amount":""},{droparea:Object(r["eb"])((function(){return[Object(r["j"])("label",null,Object(r["T"])(e.$t("common.drag_and_drop_files")),1),Object(r["j"])("div",{onClick:t[0]||(t[0]=Object(r["hb"])((function(){}),["stop"]))},[Object(r["m"])(i,{onAttach:e.handleAttach,type:"link",icon:"",i18n_label:"common.select_file"},null,8,["onAttach"]),Object(r["l"])(" "+Object(r["T"])(e.$t("common.or"))+" ",1),Object(r["m"])(s,{onAttach:e.handleAttach,type:"link",icon:"",i18n_label:"common.uploader_activate_webcam"},null,8,["onAttach"])])]})),_:1},8,["onAttach"])),e.file?(Object(r["F"])(),Object(r["g"])(m,{key:2,"image-file":e.file,"thumbnail-scale":1.8,onApply:e.applyDetection,onClose:t[1]||(t[1]=function(t){return e.file=null})},null,8,["image-file","thumbnail-scale","onApply"])):Object(r["h"])("",!0)])}function lu(e){return void 0===e.id&&void 0!==e.user}function uu(e,t,n,a,c,o){var i=Object(r["P"])("NButton");return Object(r["F"])(),Object(r["g"])(i,{icon:e.icon,type:e.type,onClick:e.attach},{default:Object(r["eb"])((function(){return[Object(r["l"])(Object(r["T"])(e.i18n_label?e.$t(e.i18n_label):""),1)]})),_:1},8,["icon","type","onClick"])}var du=Object(r["n"])({name:"FileAttachButton",components:{NButton:z["b"]},props:{accept:{type:String,default:"image/*"},icon:{type:String,default:"upload"},type:{type:String,default:z["d"].Secondary},i18n_label:{type:String,default:"common.photo_upload"}},emits:["attach"],methods:{attach:function(){var e=this;return Object(u["a"])(regeneratorRuntime.mark((function t(){var n,a,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Object(ta["b"])(e.accept,!1);case 2:n=t.sent,a=Object(Br["a"])(n,1),r=a[0],e.$emit("attach",r);case 6:case"end":return t.stop()}}),t)})))()}}});const mu=ce()(du,[["render",uu]]);var bu=mu,pu=(n("159b"),function(){function e(){Object(d["a"])(this,e),this.items=[]}return Object(m["a"])(e,[{key:"add",value:function(e){this.items.push(e)}},{key:"remove",value:function(e){this.items=this.items.filter((function(t){return t!==e}))}},{key:"getUserFaces",value:function(e){return this.items.filter((function(t){return t.user===e}))}},{key:"uploadAll",value:function(){var e=Object(u["a"])(regeneratorRuntime.mark((function e(t){var n,a,r,c;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:n=this.getUserFaces(t),a=Object(Un["a"])(n),e.prev=2,a.s();case 4:if((r=a.n()).done){e.next=11;break}return c=r.value,delete c.thumbnail,e.next=9,Te["x"].userFaceCreate(c);case 9:e.next=4;break;case 11:e.next=16;break;case 13:e.prev=13,e.t0=e["catch"](2),a.e(e.t0);case 16:return e.prev=16,a.f(),e.finish(16);case 19:return this.items=this.items.filter((function(e){return e.user!==t})),e.abrupt("return",!0);case 21:case"end":return e.stop()}}),e,this,[[2,13,16,19]])})));function t(t){return e.apply(this,arguments)}return t}()},{key:"replaceIds",value:function(e,t){this.items.forEach((function(n){n.user===e&&(n.user=t)}))}}],[{key:"create",value:function(){return Object(r["K"])(new this)}}]),e}()),fu=pu.create();function hu(e,t,n,a,c,o){var i=Object(r["P"])("NThumbnail");return Object(r["F"])(),Object(r["g"])(i,{"model-value":e.face.thumbnail,actions:e.actions,"default-action":e.defaultAction},null,8,["model-value","actions","default-action"])}var vu=function(e){Object(b["a"])(n,e);var t=Object(p["a"])(n);function n(){var e;return Object(d["a"])(this,n),e=t.apply(this,arguments),e.defaultAction=te["b"].ShowFullScreen,e}return Object(m["a"])(n,[{key:"actions",get:function(){var e=[{icon:"trash",name:te["b"].Delete,position:lt["c"].TopRight},{icon:"eye-open",name:te["b"].ShowFullScreen,position:lt["c"].BottomLeft}];return this.isCover||e.push({icon:"main-picture",name:te["b"].SetCover,position:lt["c"].BottomRight}),e}}]),n}(h["b"]);Object(f["b"])([Object(v["c"])({type:Object,required:!0})],vu.prototype,"face",void 0),Object(f["b"])([Object(v["c"])({type:Boolean,default:!1})],vu.prototype,"isCover",void 0),vu=Object(f["b"])([Object(h["a"])({components:{NThumbnail:pe["a"]}})],vu);var ju=vu;const Ou=ce()(ju,[["render",hu]]);var yu=Ou,gu=function(e){Object(b["a"])(n,e);var t=Object(p["a"])(n);function n(){var e;return Object(d["a"])(this,n),e=t.apply(this,arguments),e.module=ee["d"].getUserFaceListViewModel(),e.file=null,e}return Object(m["a"])(n,[{key:"facesModule",get:function(){return fu}},{key:"items",get:function(){var e=this.facesModule.getUserFaces(this.item.id);return[].concat(Object(Cn["a"])(e),Object(Cn["a"])(this.module.items))}},{key:"initModule",value:function(){this.module.filter.force.limit=1e3,this.module.filter.force.user=[this.item.id],this.module.get()}},{key:"applyDetection",value:function(){var e=Object(u["a"])(regeneratorRuntime.mark((function e(t){var n,r,c;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(n=Object(Br["a"])(t,1),r=n[0],!this.file){e.next=12;break}if(c={user:this.item.id,source_photo:this.file,create_from:"detection:".concat(r.meta.id)},this.file=null,!this.isNew){e.next=8;break}this.facesModule.add(Object(a["a"])(Object(a["a"])({},c),{},{thumbnail:r.thumbnail})),e.next=12;break;case 8:return e.next=10,Te["x"].userFaceCreate(c);case 10:return e.next=12,this.module.get();case 12:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"getIsCover",value:function(e){return!!lu(e)||e.id===this.item.face_cover}},{key:"handleAttach",value:function(e){this.file=e}},{key:"handleDndAttach",value:function(e){var t=Object(Br["a"])(e,1),n=t[0];this.handleAttach(n.file)}},{key:"handleAction",value:function(e,t){switch(e){case te["b"].SetCover:!lu(t)&&(this.item.face_cover=t.id);break;case te["b"].ShowFullScreen:xe["a"].run(te["b"].ShowFullScreen,t);break;case te["b"].Delete:this.deleteFace(t);break}}},{key:"deleteFace",value:function(){var e=Object(u["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!lu(t)){e.next=4;break}this.facesModule.remove(t),e.next=8;break;case 4:return e.next=6,this.module.delete(t.id);case 6:return e.next=8,this.module.get({resetState:!1});case 8:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"mounted",value:function(){!this.isNew&&this.initModule()}}]),n}(h["b"]);Object(f["b"])([Object(v["c"])({type:Object,required:!0})],gu.prototype,"item",void 0),Object(f["b"])([Object(v["c"])({type:Boolean,default:!1})],gu.prototype,"isNew",void 0),Object(f["b"])([Object(v["f"])("item.id")],gu.prototype,"initModule",null),gu=Object(f["b"])([Object(h["a"])({components:{CameraShotAttach:Ct,DetectionDialog:ft["a"],FileAttachButton:bu,NAttachments:ta["a"],NBaseBar:z["a"],NButton:z["b"],UserFace:yu}})],gu);var _u=gu;n("e3c4");const ku=ce()(_u,[["render",su]]);var wu=ku,Cu={Information:"information",Photos:"photos"},xu=function(e){Object(b["a"])(n,e);var t=Object(p["a"])(n);function n(){var e;return Object(d["a"])(this,n),e=t.apply(this,arguments),e.activeTab=Cu.Information,e}return Object(m["a"])(n,[{key:"item",get:function(){return this.sidebarItem.model.item}},{key:"isNew",get:function(){return this.sidebarItem.model.isNew}},{key:"tabItems",get:function(){var e={name:Cu.Information,label:this.$t("common.".concat(Cu.Information),"f")},t={name:Cu.Photos,label:this.$t("common.".concat(Cu.Photos),"f")};return this.isAdUser?[e]:[e,t]}},{key:"isAdUser",get:function(){var e;return fe["a"].config.services.ffsecurity.active_directory&&(null===(e=this.item)||void 0===e?void 0:e.ad_user)}},{key:"headerActions",get:function(){var e,t;return i["b"].getItemActions(this.modelAcl,null,{hasChanges:null===(e=this.sidebarItem.model)||void 0===e?void 0:e.hasChanges,hasActive:!0,currentActive:null===(t=this.item)||void 0===t?void 0:t.active,hasDelete:!this.isAdUser}).map(i["b"].computeActionByName)}},{key:"actionHandler",value:function(e,t){xe["a"].run(e,t)}}]),n}(h["b"]);Object(f["b"])([Object(v["c"])({type:Object,required:!0})],xu.prototype,"sidebarItem",void 0),Object(f["b"])([Object(v["c"])({type:Object,required:!0})],xu.prototype,"modelAcl",void 0),xu=Object(f["b"])([Object(h["a"])({name:"UsersSidebar",components:{MultisidebarSaveActions:Sa,UserFaces:wu,UserForm:au,NForm:be["b"],NTabs:y["a"],SidebarTab:Oa["a"],SidebarHeader:j["a"]}})],xu);var Tu=xu;const Iu=ce()(Tu,[["render",El]]);var Au=Iu;function Fu(e){return Nu.apply(this,arguments)}function Nu(){return Nu=Object(u["a"])(regeneratorRuntime.mark((function e(t){var n,a,r,c,o;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(r="",null===(n=t.model.item)||void 0===n||!n.face_cover){e.next=6;break}return e.next=4,Te["x"].userFaceRetrieve(null===(c=t.model.item)||void 0===c?void 0:c.face_cover);case 4:o=e.sent,r=o.thumbnail;case 6:return e.abrupt("return",{label:null===(a=t.model.item)||void 0===a?void 0:a.name,thumbnailSrc:r});case 7:case"end":return e.stop()}}),e)}))),Nu.apply(this,arguments)}function Su(){return Vu.apply(this,arguments)}function Vu(){return Vu=Object(u["a"])(regeneratorRuntime.mark((function e(){var t,n,a=arguments;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,c["j"].apply(void 0,a);case 2:return t=e.sent,n=t.model.save,t.model.save=Object(u["a"])(regeneratorRuntime.mark((function e(){var a,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!t.model.isNew){e.next=9;break}return a=t.model.item.id,e.next=4,n.apply(t.model);case 4:return r=e.sent,fu.replaceIds(a,r.id),e.next=8,fu.uploadAll(r.id);case 8:return e.abrupt("return",r);case 9:return e.abrupt("return",n.apply(t.model));case 10:case"end":return e.stop()}}),e)}))),e.abrupt("return",t);case 6:case"end":return e.stop()}}),e)}))),Vu.apply(this,arguments)}var Pu={class:"multisidebar-content__main"};function Ru(e,t,n,a,c,o){var i=Object(r["P"])("SidebarHeader"),s=Object(r["P"])("NTabs"),l=Object(r["P"])("NFormBlocks"),u=Object(r["P"])("NForm"),d=Object(r["P"])("MultisidebarSaveActions");return Object(r["F"])(),Object(r["i"])("div",null,[Object(r["m"])(i,{label:e.model.item.name,inactivated:!e.model.item.active,changed:e.sidebarItem.hasChanges,"current-item-acl":e.itemAcl,actions:e.headerActions,"i18n-inactivated":"common.inactivated",onAction:e.handleAction},null,8,["label","inactivated","changed","current-item-acl","actions","onAction"]),Object(r["m"])(s,{items:e.tabItems,modelValue:e.activeTab,"onUpdate:modelValue":t[0]||(t[0]=function(t){return e.activeTab=t}),class:"multisidebar-content__tabs control-m"},null,8,["items","modelValue"]),Object(r["j"])("div",Pu,[e.activeTab===e.Tabs.Information?(Object(r["F"])(),Object(r["g"])(l,{disabled:e.isFormDisabled,key:"".concat(e.model.item.id,"-").concat(e.activeTab),blocks:e.cameraGroupInformation,model:e.model.item,ref:"form"},null,8,["disabled","blocks","model"])):Object(r["h"])("",!0),e.activeTab===e.Tabs.Permissions?(Object(r["F"])(),Object(r["g"])(u,{key:1,layout:e.cameraGroupPermissions,model:e.model.item,disabled:e.isFormDisabled},null,8,["layout","model","disabled"])):Object(r["h"])("",!0)]),Object(r["m"])(d,{"model-acl":e.modelAcl,"item-acl":e.itemAcl,"sidebar-item":e.sidebarItem},null,8,["model-acl","item-acl","sidebar-item"])])}var Mu={class:"object-thresholds"};function Eu(e,t,n,a,c,o){var i=Object(r["P"])("NForm");return Object(r["F"])(),Object(r["i"])("div",Mu,[(Object(r["F"])(),Object(r["g"])(Object(r["R"])(e.togglerComponent),{label:e.$t("common.confidence_threshold"),modelValue:e.showConfidenceThresholds,"onUpdate:modelValue":t[0]||(t[0]=function(t){return e.showConfidenceThresholds=t})},null,8,["label","modelValue"])),e.showConfidenceThresholds?(Object(r["F"])(),Object(r["g"])(i,{key:0,layout:e.layout,model:e.item},null,8,["layout","model"])):Object(r["h"])("",!0)])}var Lu=n("19b1"),Du=n("e33d"),$u=.75,Uu={face_threshold:"face_confidence_threshold",body_threshold:"body_confidence_threshold",car_threshold:"car_confidence_threshold"},Bu=function(e){Object(b["a"])(n,e);var t=Object(p["a"])(n);function n(){return Object(d["a"])(this,n),t.apply(this,arguments)}return Object(m["a"])(n,[{key:"togglerComponent",get:function(){return"switch"===this.togglerType?"NSwitch":"NCheckbox"}},{key:"layout",get:function(){var e=this,t=[{path:"face_threshold",classes:"label-m n-form-w-2 n-form-label-horizontal-100 n-form-pad-10",i18n_label:"common.faces",component:Lu["a"],i18n_tooltip:"common.confidence_desc",props:{controls:!0},hidden:function(){return!we["a"].isObjectAvailable("face")}},{path:"body_threshold",classes:"label-m n-form-w-2 n-form-label-horizontal-100 n-form-pad-10",i18n_label:"common.bodies",component:Lu["a"],i18n_tooltip:"common.confidence_desc",props:{controls:!0},hidden:function(){return!we["a"].isObjectAvailable("body")}},{path:"car_threshold",classes:"label-m n-form-w-2 n-form-label-horizontal-100 n-form-pad-10",i18n_label:"common.cars",component:Lu["a"],i18n_tooltip:"common.confidence_desc",props:{controls:!0},hidden:function(){return!we["a"].isObjectAvailable("car")}}];return t.filter((function(t){return e.fields.includes(t.path)}))}},{key:"settings",get:function(){return Du["a"].item}},{key:"fields",get:function(){return this.objectTypes.filter((function(e){return we["a"].availableObjectsMap[e]})).map((function(e){return"".concat(e,"_threshold")}))}},{key:"showConfidenceThresholds",get:function(){var e=this;return this.fields.some((function(t){return null!==e.item[t]&&0!==e.item[t]}))},set:function(e){var t,n=Object(Un["a"])(this.fields);try{for(n.s();!(t=n.n()).done;){var a,r,c=t.value;this.item[c]=e?null!==(a=null===(r=this.settings)||void 0===r?void 0:r[Uu[c]])&&void 0!==a?a:$u:null}}catch(o){n.e(o)}finally{n.f()}}}]),n}(h["b"]);Object(f["b"])([Object(v["c"])({type:Object,required:!0})],Bu.prototype,"item",void 0),Object(f["b"])([Object(v["c"])({type:Array,default:function(){return["face","body","car"]}})],Bu.prototype,"objectTypes",void 0),Object(f["b"])([Object(v["c"])({type:String,default:"switch"})],Bu.prototype,"togglerType",void 0),Bu=Object(f["b"])([Object(h["a"])({name:"ObjectThresholds",components:{NForm:be["b"],NConfidence:Lu["a"],NCheckbox:z["e"],NSwitch:z["y"]}})],Bu);var qu=Bu;n("965e");const Hu=ce()(qu,[["render",Eu]]);var Gu=Hu,zu=[{layout:[{path:"name",classes:"label-m n-form-w-6 n-form-pad-10 camera-group-form-pad",i18n_label:"common.name",component:jr["a"],validators:[Object(Qa["g"])()]},{path:"comment",classes:"label-m n-form-w-6 n-form-pad-10",i18n_label:"common.comment",component:jr["a"]},{classes:"label-m n-form-w-6 n-form-pad-10",i18n_label:"common.labels",component:z["x"],props:{multiple:!0,allowCreate:!0,keyField:"",i18n_placeholder:"common.camera_groups_not_selected",loadItems:function(){return Q["a"].cameraGroupsLabels.map((function(e){return{label:e,value:e}}))}},encode:function(e,t){var n={};t.forEach((function(e){n[e.label]="true"})),this.model.labels=n},decode:function(){var e,t=[];return Object.keys((null===(e=this.model)||void 0===e?void 0:e.labels)||[]).forEach((function(e,n){return t.push({label:e,value:e})})),t}},[{path:"deduplicate",classes:"label-m n-form-w-4 n-form-vcenter n-form-pad-10",component:Ln["a"],props:{i18n_label:"common.deduplicate_events_with_interval"}},{path:"deduplicateDelay",classes:"label-m n-form-w-2 n-form-pad-10",component:z["s"],validators:[Object(Qa["g"])()]}],{component:Gu,classes:"n-form-w-6 n-form-pad-20 control-m",props:function(e){return{item:e}}}]},{layout:Object(me["b"])(),display:function(e){return e.id>or["a"]}}],Wu=zu,Yu=n("6320"),Ku=[{path:"permissions",classes:"n-form-w-6",component:Yu["a"]}],Xu=Ku,Ju={WatchLists:"permissions_watch_lists",CameraGroups:"permissions_camera_groups"},Zu="permissions";function Qu(e,t,n){return ed.apply(this,arguments)}function ed(){return ed=Object(u["a"])(regeneratorRuntime.mark((function e(t,n,a){var r,c,o,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t.item){e.next=2;break}return e.abrupt("return");case 2:if(r=t.changes,!r.includes(Zu)||"undefined"===typeof t.item.permissions){e.next=16;break}return c=t.item.permissions,e.next=7,a();case 7:return ad(t,c),o=Object(ee["c"])(n),o.setItemsState({id:t.item.id,permissions:c}),e.next=12,o.save();case 12:i=e.sent,ad(t,i.permissions),e.next=20;break;case 16:if(!(r.length>0)){e.next=20;break}return delete t.item[Zu],e.next=20,a();case 20:return e.abrupt("return",t.item);case 21:case"end":return e.stop()}}),e)}))),ed.apply(this,arguments)}function td(e,t){return nd.apply(this,arguments)}function nd(){return nd=Object(u["a"])(regeneratorRuntime.mark((function e(t,n){var a,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(null!==t&&void 0!==t&&t.isNew||!t.item){e.next=5;break}return r=Object(ee["c"])(n),e.next=4,r.get(t.item.id);case 4:(null===(a=r.item)||void 0===a?void 0:a.permissions)&&ad(t,r.item.permissions);case 5:case"end":return e.stop()}}),e)}))),nd.apply(this,arguments)}function ad(e,t){t?(e.item&&(e.item.permissions=Object(a["a"])({},t)),e.originalItem&&(e.originalItem.permissions=Object(a["a"])({},t))):(e.item&&delete e.item.permissions,e.originalItem&&delete e.originalItem.permissions)}var rd=n("78fb"),cd=function(e){Object(b["a"])(n,e);var t=Object(p["a"])(n);function n(){var e;return Object(d["a"])(this,n),e=t.apply(this,arguments),e.Tabs={Information:"information",Permissions:"permissions"},e.activeTab=e.Tabs.Information,e.cameraGroupInformation=Wu,e.cameraGroupPermissions=Xu,e}return Object(m["a"])(n,[{key:"isFormDisabled",get:function(){return!(this.sidebarItem.model.isNew?this.modelAcl.add:this.itemAcl.update)}},{key:"model",get:function(){return this.sidebarItem.model}},{key:"tabItems",get:function(){var e={name:this.Tabs.Information,label:this.$t("common.".concat(this.Tabs.Information),"f")},t={name:this.Tabs.Permissions,label:this.$t("common.".concat(this.Tabs.Permissions),"f")};return this.model.isNew?[e]:[e,t]}},{key:"headerActions",get:function(){var e,t;return i["b"].getItemActions(this.modelAcl,this.itemAcl,{hasChanges:null===(e=this.model)||void 0===e?void 0:e.hasChanges,hasActive:!0,hasDelete:!0,currentActive:null===(t=this.model.item)||void 0===t?void 0:t.active}).map(i["b"].computeActionByName)}},{key:"loadPermissionsOnPermissionTab",value:function(){var e=Object(u["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(this.activeTab!==this.Tabs.Permissions){e.next=3;break}return e.next=3,td(this.sidebarItem.model,Ju.CameraGroups);case 3:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"handleAction",value:function(e){xe["a"].run(e,this.sidebarItem)}},{key:"validateForm",value:function(){var e=!this.$refs.form||this.$refs.form.validate();return e||this.$refs.form.displayErrors(),e}},{key:"created",value:function(){xe["a"].getIsItemFormValid=this.validateForm.bind(this)}}]),n}(h["b"]);Object(f["b"])([Object(v["c"])({type:Object,required:!0})],cd.prototype,"sidebarItem",void 0),Object(f["b"])([Object(v["c"])({type:Object,required:!0})],cd.prototype,"modelAcl",void 0),Object(f["b"])([Object(v["c"])({type:Object,required:!0})],cd.prototype,"itemAcl",void 0),Object(f["b"])([Object(v["f"])("model.item.id"),Object(v["f"])("activeTab",{immediate:!0})],cd.prototype,"loadPermissionsOnPermissionTab",null),cd=Object(f["b"])([Object(h["a"])({name:"CameraGroupsSidebar",components:{Permissions:Yu["a"],MultisidebarSaveActions:Sa,NForm:be["b"],NFormBlocks:rd["a"],NTabs:y["a"],SidebarHeader:j["a"]}})],cd);var od=cd;const id=ce()(od,[["render",Ru]]);var sd=id,ld=function(){return ud.apply(this,arguments)};function ud(){return ud=Object(u["a"])(regeneratorRuntime.mark((function e(){var t,n,a=arguments;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,c["j"].apply(void 0,a);case 2:return t=e.sent,n=t.model.save,t.model.save=function(){return Qu(t.model,Ju.CameraGroups,n.bind(t.model))},e.abrupt("return",t);case 6:case"end":return e.stop()}}),e)}))),ud.apply(this,arguments)}var dd={class:"multisidebar-content__main"};function md(e,t,n,a,c,o){var i=Object(r["P"])("SidebarHeader"),s=Object(r["P"])("NTabs"),l=Object(r["P"])("NForm"),u=Object(r["P"])("MultisidebarSaveActions");return Object(r["F"])(),Object(r["i"])("div",null,[Object(r["m"])(i,{label:e.model.item.name,inactivated:!e.model.item.active,changed:e.model.hasChanges,"current-item-acl":e.itemAcl,actions:e.headerActions,"i18n-inactivated":"common.watch_list_inactive",onAction:e.handleAction},null,8,["label","inactivated","changed","current-item-acl","actions","onAction"]),Object(r["m"])(s,{items:e.tabItems,modelValue:e.activeTab,"onUpdate:modelValue":t[0]||(t[0]=function(t){return e.activeTab=t}),class:"multisidebar-content__tabs control-m"},null,8,["items","modelValue"]),Object(r["j"])("div",dd,[(Object(r["F"])(),Object(r["g"])(l,{ref:"form",layout:e.itemForm,model:e.model.item,key:"".concat(e.model.item.id,"-").concat(e.activeTab),disabled:e.isFormDisabled},null,8,["layout","model","disabled"]))]),Object(r["m"])(u,{"model-acl":e.modelAcl,"item-acl":e.itemAcl,"sidebar-item":e.sidebarItem},null,8,["model-acl","item-acl","sidebar-item"])])}var bd=n("f4cb");function pd(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return[].concat(Object(Cn["a"])(hd()),Object(Cn["a"])(vd()),Object(Cn["a"])(e?[]:Object(me["b"])()))}function fd(){return[{path:"permissions",classes:"n-form-w-6",component:Yu["a"],props:{disabledIds:[1]}}]}function hd(){return[[{path:"name",classes:"grow-1 n-form-pad-10 control-m",i18n_label:"common.name",component:jr["a"],validators:[Object(Qa["g"])(),Object(Qa["h"])({required:!0,max:256})]},{path:"color",classes:"n-form-pad-10 control-m n-form-ml-1",i18n_label:"common.color",component:bd["a"],validators:[{name:be["a"].Required}]}],{path:"camera_groups",classes:"n-form-w-6 n-form-pad-20 control-m",i18n_label:"common.camera_groups",component:gr["a"],props:{i18n_placeholder:"common.camera_groups_not_selected",items:Q["a"].cameraGroupsModule.items.map((function(e){return{label:e.name,value:e.id}})),multiple:!0}},{path:"comment",classes:"n-form-w-6 n-form-pad-20 control-m",i18n_label:"common.comment",component:ma["a"]},{component:Gu,classes:"n-form-w-6 n-form-pad-20 control-m",props:function(e){return{item:e}}}]}function vd(){var e,t,n={path:"acknowledge",classes:"label-m n-form-w-4 n-form-vcenter n-form-block-start",component:Ln["a"],props:{i18n_label:"common.require_event_acknowledgement"}},a={path:"ignore_events",classes:"label-m n-form-w-4 n-form-vcenter n-form-pad-10",component:Ln["a"],props:{i18n_label:"common.dont_create_events"}},r={path:"notify",classes:"label-m n-form-w-4 n-form-vcenter n-form-pad-10",component:Ln["a"],props:{i18n_label:"common.enable_sound_alert"}},c={path:"send_events_to_external_vms",classes:"label-m n-form-w-4 n-form-vcenter n-form-pad-10",props:function(e){return{i18n_label:"common.send_events_to_external_vms",disabled:-1===e.id}},component:Ln["a"]},o={path:"active",classes:"label-m n-form-w-4 n-form-vcenter n-form-block-start",props:function(e){return{i18n_label:"common.watch_list_active",disabled:-1===e.id}},component:Ln["a"]},i=null===(e=!(null!==(t=fe["a"].config.extra_options)&&void 0!==t&&t.includes("hide_events")))||void 0===e||e,s=fe["a"].config.external_vms.enabled;return i?[n,a,r,s&&c,o]:[n,r,o]}var jd={Information:"information",Permissions:"permissions"},Od=function(e){Object(b["a"])(n,e);var t=Object(p["a"])(n);function n(){var e;return Object(d["a"])(this,n),e=t.apply(this,arguments),e.activeTab=jd.Information,e}return Object(m["a"])(n,[{key:"isFormDisabled",get:function(){return!(this.sidebarItem.model.isNew?this.modelAcl.add:this.itemAcl.update)}},{key:"model",get:function(){return this.sidebarItem.model}},{key:"tabItems",get:function(){var e={name:jd.Information,label:this.$t("common.".concat(jd.Information),"f")},t={name:jd.Permissions,label:this.$t("common.".concat(jd.Permissions),"f")};return this.model.isNew?[e]:[e,t]}},{key:"itemForm",get:function(){var e,t=this.activeTab,n=null===(e=this.model)||void 0===e?void 0:e.item;return n?t===jd.Permissions?fd():pd(this.model.isNew):[]}},{key:"headerActions",get:function(){var e,t,n,a;return i["b"].getItemActions(this.modelAcl,this.itemAcl,{hasChanges:null===(e=this.model)||void 0===e?void 0:e.hasChanges,currentActive:null===(t=this.model.item)||void 0===t?void 0:t.active,hasActive:-1!==(null===(n=this.model.item)||void 0===n?void 0:n.id),hasDelete:-1!==(null===(a=this.model.item)||void 0===a?void 0:a.id),hasDeleteCard:!0}).map(i["b"].computeActionByName)}},{key:"loadPermissionsOnPermissionTab",value:function(){var e=Object(u["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(this.activeTab!==jd.Permissions){e.next=3;break}return e.next=3,td(this.sidebarItem.model,Ju.WatchLists);case 3:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"validateForm",value:function(){var e=!this.$refs.form||this.$refs.form.validate();return e||this.$refs.form.displayErrors(),e}},{key:"handleAction",value:function(e){xe["a"].run(e,this.sidebarItem)}},{key:"created",value:function(){xe["a"].getIsItemFormValid=this.validateForm.bind(this)}}]),n}(h["b"]);Object(f["b"])([Object(v["c"])({type:Object,required:!0})],Od.prototype,"sidebarItem",void 0),Object(f["b"])([Object(v["c"])({type:Object,required:!0})],Od.prototype,"modelAcl",void 0),Object(f["b"])([Object(v["c"])({type:Object,required:!0})],Od.prototype,"itemAcl",void 0),Object(f["b"])([Object(v["f"])("model.item.id"),Object(v["f"])("activeTab",{immediate:!0})],Od.prototype,"loadPermissionsOnPermissionTab",null),Od=Object(f["b"])([Object(h["a"])({name:"WatchListsSidebar",components:{NTabs:y["a"],NForm:be["b"],MultisidebarSaveActions:Sa,SidebarHeader:j["a"]}})],Od);var yd=Od;const gd=ce()(yd,[["render",md]]);var _d=gd,kd=function(){return wd.apply(this,arguments)};function wd(){return wd=Object(u["a"])(regeneratorRuntime.mark((function e(){var t,n,a=arguments;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,c["j"].apply(void 0,a);case 2:return t=e.sent,n=t.model.save,t.model.save=function(){return Qu(t.model,Ju.WatchLists,n.bind(t.model))},e.abrupt("return",t);case 6:case"end":return e.stop()}}),e)}))),wd.apply(this,arguments)}var Cd={class:"multisidebar-content__main"};function xd(e,t,n,a,c,o){var i=Object(r["P"])("SidebarHeader"),s=Object(r["P"])("NTabs"),l=Object(r["P"])("NForm"),u=Object(r["P"])("MultisidebarSaveActions");return Object(r["F"])(),Object(r["i"])("div",null,[Object(r["m"])(i,{label:e.model.item.name,onAction:e.handleAction,actions:e.headerActions},null,8,["label","onAction","actions"]),e.tabItems?(Object(r["F"])(),Object(r["g"])(s,{key:0,items:e.currentTabItems,modelValue:e.tab,"onUpdate:modelValue":t[0]||(t[0]=function(t){return e.tab=t}),class:"multisidebar-content__tabs control-m"},null,8,["items","modelValue"])):Object(r["h"])("",!0),Object(r["j"])("div",Cd,[(Object(r["F"])(),Object(r["g"])(l,{layout:e.sidebarForm,model:e.model.item,key:"".concat(e.model.item.id,"-").concat(e.tab),disabled:!e.computedModelAcl.update,ref:"form"},null,8,["layout","model","disabled"]))]),Object(r["m"])(u,{"model-acl":e.computedModelAcl,"sidebar-item":e.sidebarItem},null,8,["model-acl","sidebar-item"])])}var Td={class:"group-watch-lists"};function Id(e,t,n,a,c,o){var i=Object(r["P"])("HeaderBar"),s=Object(r["P"])("NTable");return Object(r["F"])(),Object(r["i"])("div",Td,[e.content?(Object(r["F"])(),Object(r["g"])(i,{key:0,"search-text":e.searchText,"onUpdate:search-text":t[0]||(t[0]=function(t){return e.searchText=t})},{count:Object(r["eb"])((function(){return[Object(r["l"])(Object(r["T"])(e.watchLists.length)+" "+Object(r["T"])(e.$t("common.total"))+", "+Object(r["T"])(e.offCount)+" "+Object(r["T"])(e.$t("common.off")),1)]})),_:1},8,["search-text"])):Object(r["h"])("",!0),Object(r["m"])(s,{columns:e.columns,header:e.header,content:e.watchLists,disabled:e.disabled,onAction:e.actionHandler},null,8,["columns","header","content","disabled","onAction"])])}var Ad=n("f6bd"),Fd=n("b8a3"),Nd=n("2107"),Sd=function(e){Object(b["a"])(n,e);var t=Object(p["a"])(n);function n(){var e;return Object(d["a"])(this,n),e=t.apply(this,arguments),e.columns=[{header:{classes:["bottom-border"],component:Bl["a"],props:{i18n_label:"common.column_name"}},content:{path:"name",component:Ad["a"],props:function(e){return{color:"#".concat(e.color),name:e.name,textType:de["b"].Link}}}},{width:"100px",header:{classes:["align-center","bottom-border"],component:Bl["a"],props:{i18n_label:"common.column_off"}},content:{path:"permission",classes:["align-center"],component:Fd["a"],props:function(e){return{name:"watch_"+e.id,selectValue:"off"}}}},{width:"100px",header:{classes:["align-center","bottom-border"],component:Bl["a"],props:{i18n_label:"common.column_view"}},content:{path:"permission",classes:["align-center"],component:Fd["a"],props:function(e){return{name:"watch_"+e.id,selectValue:"view"}}}},{width:"100px",header:{classes:["align-center","bottom-border"],component:Bl["a"],props:{i18n_label:"common.column_change"}},content:{path:"permission",classes:["align-center"],component:Fd["a"],props:function(e){return{name:"watch_"+e.id,selectValue:"edit"}}}}],e.header={checked_all:!1},e.content=[],e.searchText="",e.module=ee["d"].getPermissionsWatchListsListViewModel(),e}return Object(m["a"])(n,[{key:"offCount",get:function(){return this.watchLists.filter((function(e){return"off"===e["permission"]})).length}},{key:"watchLists",get:function(){var e=this;return this.content.filter((function(t){return t.name.toLowerCase().includes(e.searchText)}))}},{key:"fullWatchListsMap",get:function(){var e=Q["a"].watchListsModule.items;return Object.fromEntries(e.map((function(e){return[e.id,e]})))}},{key:"actionHandler",value:function(){var e=Object(u["a"])(regeneratorRuntime.mark((function e(t){var n,a,r,c;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(n=t.type,a=t.row,r=t.path,c=t.value,"change"!==n){e.next=14;break}if("permission"!==r){e.next=11;break}return c="off"===c?null:c,a.permissions.toString().includes(this.modelValue.toString())||Object.assign(a.permissions,Object(Ge["a"])({},this.modelValue,c)),e.next=7,this.module.update(a);case 7:return e.next=9,this.module.get({resetState:!1});case 9:e.next=14;break;case 11:if("name"!==r){e.next=14;break}return e.next=14,xe["a"].run(te["b"].ShowItem,{type:Pe["c"].WatchLists,rawItem:a.id});case 14:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"mounted",value:function(){var e=Object(u["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return this.module.filter.current.limit=1e3,e.next=3,this.module.get();case 3:this.updateTable();case 4:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"updateTable",value:function(){var e=this;this.content=this.module.items.map((function(t){return Object(a["a"])(Object(a["a"])({},t),{},{color:e.fullWatchListsMap[t.id].color,permission:t.permissions&&t.permissions[e.modelValue]?t.permissions[e.modelValue]:"off"})}))}}]),n}(h["b"]);Object(f["b"])([Object(v["c"])({type:Number,required:!0})],Sd.prototype,"modelValue",void 0),Object(f["b"])([Object(v["c"])({type:Boolean,default:!1})],Sd.prototype,"disabled",void 0),Object(f["b"])([Object(v["f"])("modelValue",{deep:!0})],Sd.prototype,"updateTable",null),Sd=Object(f["b"])([Object(h["a"])({name:"GroupWatchLists",components:{HeaderBar:Nd["a"],NRadio:Fd["a"],NTable:ql["a"]}})],Sd);var Vd=Sd;n("4789");const Pd=ce()(Vd,[["render",Id]]);var Rd=Pd,Md=[{path:"id",classes:"n-form-w-6 form-pad",component:Rd}],Ed=Md,Ld={class:"group-camera-groups"};function Dd(e,t,n,a,c,o){var i=Object(r["P"])("HeaderBar"),s=Object(r["P"])("NTable");return Object(r["F"])(),Object(r["i"])("div",Ld,[e.content?(Object(r["F"])(),Object(r["g"])(i,{key:0,"search-text":e.searchText,"onUpdate:search-text":t[0]||(t[0]=function(t){return e.searchText=t})},{count:Object(r["eb"])((function(){return[Object(r["l"])(Object(r["T"])(e.cameraGroups.length)+" "+Object(r["T"])(e.$t("common.total"))+", "+Object(r["T"])(e.offCount)+" "+Object(r["T"])(e.$t("common.off")),1)]})),_:1},8,["search-text"])):Object(r["h"])("",!0),Object(r["m"])(s,{columns:e.columns,header:e.header,content:e.cameraGroups,disabled:e.disabled,onAction:e.actionHandler},null,8,["columns","header","content","disabled","onAction"])])}var $d=function(e){Object(b["a"])(n,e);var t=Object(p["a"])(n);function n(){var e;return Object(d["a"])(this,n),e=t.apply(this,arguments),e.columns=[{header:{classes:["bottom-border"],component:Bl["a"],props:{i18n_label:"common.column_name"}},content:{path:"name",component:z["b"],props:function(e){return{label:e.name,type:"link",align:"left"}},on:{click:function(){xe["a"].run(te["b"].ShowItem,{type:Pe["c"].CameraGroups,rawItem:this.item.id})}}}},{width:"100px",header:{classes:["align-center","bottom-border"],component:Bl["a"],props:{i18n_label:"common.column_off"}},content:{path:"permission",classes:["align-center"],component:Fd["a"],props:function(e){return{name:"group_"+e.id,selectValue:"off"}}}},{width:"100px",header:{classes:["align-center","bottom-border"],component:Bl["a"],props:{i18n_label:"common.column_view"}},content:{path:"permission",classes:["align-center"],component:Fd["a"],props:function(e){return{name:"group_"+e.id,selectValue:"view"}}}},{width:"100px",header:{classes:["align-center","bottom-border"],component:Bl["a"],props:{i18n_label:"common.column_change"}},content:{path:"permission",classes:["align-center"],component:Fd["a"],props:function(e){return{name:"group_"+e.id,selectValue:"edit"}}}}],e.header={checked_all:!1},e.content=[],e.searchText="",e.module=ee["d"].getPermissionsCameraGroupsListViewModel(),e}return Object(m["a"])(n,[{key:"offCount",get:function(){return this.cameraGroups.filter((function(e){return"off"===e["permission"]})).length}},{key:"cameraGroups",get:function(){var e=this;return this.content.filter((function(t){return t.name.toLowerCase().includes(e.searchText)}))}},{key:"actionHandler",value:function(){var e=Object(u["a"])(regeneratorRuntime.mark((function e(t){var n,a,r,c;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(n=t.type,a=t.row,r=t.path,c=t.value,"change"!==n||"permission"!==r){e.next=8;break}return c="off"===c?null:c,a.permissions.toString().includes(this.modelValue.toString())||Object.assign(a.permissions,Object(Ge["a"])({},this.modelValue,c)),e.next=6,this.module.update(a);case 6:return e.next=8,this.module.get({resetState:!1});case 8:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"mounted",value:function(){var e=Object(u["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return this.module.filter.current.limit=1e3,e.next=3,this.module.get();case 3:this.updateTable();case 4:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"updateTable",value:function(){var e=this;this.content=this.module.items.map((function(t){return Object(a["a"])(Object(a["a"])({},t),{},{permission:t.permissions&&t.permissions[e.modelValue]?t.permissions[e.modelValue]:"off"})}))}}]),n}(h["b"]);Object(f["b"])([Object(v["c"])({type:Number,required:!0})],$d.prototype,"modelValue",void 0),Object(f["b"])([Object(v["c"])({type:Boolean,default:!1})],$d.prototype,"disabled",void 0),Object(f["b"])([Object(v["f"])("modelValue")],$d.prototype,"updateTable",null),$d=Object(f["b"])([Object(h["a"])({name:"GroupCameraGroups",components:{HeaderBar:Nd["a"],NRadio:Fd["a"],NTable:ql["a"]}})],$d);var Ud=$d;const Bd=ce()(Ud,[["render",Dd]]);var qd=Bd,Hd=[{path:"id",classes:"n-form-w-6 form-pad",component:qd}],Gd=Hd,zd={class:"permissions"};function Wd(e,t,n,a,c,o){var i=Object(r["P"])("HeaderBar"),s=Object(r["P"])("GroupAccessPermissions"),l=Object(r["P"])("GroupCommonPermissions");return Object(r["F"])(),Object(r["i"])("div",zd,[Object(r["m"])(i,{"search-text":e.searchText,"onUpdate:search-text":t[0]||(t[0]=function(t){return e.searchText=t})},{count:Object(r["eb"])((function(){return[Object(r["l"])(Object(r["T"])(e.totalCount)+" "+Object(r["T"])(e.$t("common.total"))+", "+Object(r["T"])(e.totalCount-e.grantedCount)+" "+Object(r["T"])(e.$t("common.off")),1)]})),_:1},8,["search-text"]),Object(r["m"])(s,{groups:e.access,"is-blocked":e.isBlocked,"is-granted":e.isGranted,disabled:e.disabled,onToggle:e.toggle},null,8,["groups","is-blocked","is-granted","disabled","onToggle"]),Object(r["m"])(l,{groups:e.common,"is-blocked":e.isBlocked,"is-granted":e.isGranted,disabled:e.disabled,onToggle:e.toggle},null,8,["groups","is-blocked","is-granted","disabled","onToggle"])])}function Yd(e,t,n,a,c,o){var i=Object(r["P"])("NTable");return Object(r["F"])(),Object(r["g"])(i,{columns:e.columns,content:e.groups},null,8,["columns","content"])}var Kd=Object(r["n"])({name:"GroupAccessPermissions",components:{NTable:ql["a"]},props:{groups:Object(fr["b"])(Object(fr["g"])()).isRequired,isBlocked:Object(fr["d"])().isRequired,isGranted:Object(fr["d"])().isRequired},emits:["toggle"],computed:{columns:function(){return[this.createTargetColumn(),this.createActionColumn("view"),this.createActionColumn("change"),this.createActionColumn("add"),this.createActionColumn("delete")]}},methods:{createActionColumn:function(e){var t=this,n={width:"75px",header:{classes:["align-center","bottom-border"],component:Bl["a"],props:{i18n_label:"common.column_".concat(e)}},content:{classes:["align-center"],component:Ln["a"],props:function(n){return{disabled:t.isBlocked(n[e]),modelValue:t.isGranted(n[e]),"onUpdate:modelValue":function(){return t.$emit("toggle",n[e])}}}}};return n},createTargetColumn:function(){var e={header:{classes:["bottom-border"],component:Bl["a"],props:{i18n_label:"common.column_name"}},content:{component:Io["a"],path:"target"}};return e}}});const Xd=ce()(Kd,[["render",Yd]]);var Jd=Xd;function Zd(e,t,n,a,c,o){var i=Object(r["P"])("NTable");return Object(r["F"])(),Object(r["g"])(i,{columns:e.columns,content:e.groups},null,8,["columns","content"])}var Qd=Object(r["n"])({name:"GroupCommonPermissions",components:{NTable:ql["a"]},props:{groups:Object(fr["b"])(Object(fr["g"])()).isRequired,isBlocked:Object(fr["d"])().isRequired,isGranted:Object(fr["d"])().isRequired},emits:["toggle"],computed:{columns:function(){var e=this,t=[{header:{classes:["bottom-border"],component:Bl["a"],props:{i18n_label:"common.column_name"}},content:{path:"target",component:Io["a"]}},{width:"100px",header:{classes:["align-center","bottom-border"],component:Bl["a"],props:{i18n_label:"common.column_active"}},content:{classes:["align-center"],component:Ln["a"],props:function(t){var n=t.permission;return{disabled:e.isBlocked(n),modelValue:e.isGranted(n),"onUpdate:modelValue":function(){return e.$emit("toggle",n)}}}}}];return t}}});const em=ce()(Qd,[["render",Zd]]);var tm=em,nm={incidents:[],puppeteer:[{add:"ffsecurity_puppeteer.add_dailysearchevent",view:"ffsecurity_puppeteer.view_dailysearchevent",change:"ffsecurity_puppeteer.change_dailysearchevent",delete:"ffsecurity_puppeteer.delete_dailysearchevent",target:"dailysearchevent"},{add:"ffsecurity_puppeteer.add_dailysearchsyncjob",view:"ffsecurity_puppeteer.view_dailysearchsyncjob",change:"ffsecurity_puppeteer.change_dailysearchsyncjob",delete:"ffsecurity_puppeteer.delete_dailysearchsyncjob",target:"dailysearchsyncjob"},{add:"ffsecurity_puppeteer.add_remotemonitoringrecord",view:"ffsecurity_puppeteer.view_remotemonitoringrecord",change:"ffsecurity_puppeteer.change_remotemonitoringrecord",delete:"ffsecurity_puppeteer.delete_remotemonitoringrecord",target:"remotemonitoringrecord"},{add:"ffsecurity_puppeteer.add_searchrequest",view:"ffsecurity_puppeteer.view_searchrequest",change:"ffsecurity_puppeteer.change_searchrequest",delete:"ffsecurity_puppeteer.delete_searchrequest",target:"searchrequest"}]},am=["incidents","puppeteer"],rm=[{add:"ffsecurity.add_all_own_sessions",view:"ffsecurity.view_all_own_sessions",change:"ffsecurity.change_all_own_sessions",delete:"ffsecurity.delete_all_own_sessions",target:"all_own_sessions"},{add:"ffsecurity.add_area",view:"ffsecurity.view_area",change:"ffsecurity.change_area",delete:"ffsecurity.delete_area",target:"area"},{add:"ffsecurity.add_bodycluster",view:"ffsecurity.view_bodycluster",change:"ffsecurity.change_bodycluster",delete:"ffsecurity.delete_bodycluster",target:"bodycluster"},{add:"ffsecurity.add_bodyevent",view:"ffsecurity.view_bodyevent",change:"ffsecurity.change_bodyevent",delete:"ffsecurity.delete_bodyevent",target:"bodyevent"},{add:"ffsecurity.add_bodyobject",view:"ffsecurity.view_bodyobject",change:"ffsecurity.change_bodyobject",delete:"ffsecurity.delete_bodyobject",target:"bodyobject"},{add:"ffsecurity.add_camera",view:"ffsecurity.view_camera",change:"ffsecurity.change_camera",delete:"ffsecurity.delete_camera",target:"camera"},{add:"ffsecurity.add_cameragroup",view:"ffsecurity.view_cameragroup",change:"ffsecurity.change_cameragroup",delete:"ffsecurity.delete_cameragroup",target:"cameragroup"},{add:"ffsecurity.add_carcard",view:"ffsecurity.view_carcard",change:"ffsecurity.change_carcard",delete:"ffsecurity.delete_carcard",target:"carcard"},{add:"ffsecurity.add_carcluster",view:"ffsecurity.view_carcluster",change:"ffsecurity.change_carcluster",delete:"ffsecurity.delete_carcluster",target:"carcluster"},{add:"ffsecurity.add_carepisode",view:"ffsecurity.view_carepisode",change:"ffsecurity.change_carepisode",delete:"ffsecurity.delete_carepisode",target:"carepisode"},{add:"ffsecurity.add_carevent",view:"ffsecurity.view_carevent",change:"ffsecurity.change_carevent",delete:"ffsecurity.delete_carevent",target:"carevent"},{add:"ffsecurity.add_carobject",view:"ffsecurity.view_carobject",change:"ffsecurity.change_carobject",delete:"ffsecurity.delete_carobject",target:"carobject"},{add:"ffsecurity.add_case",view:"ffsecurity.view_case",change:"ffsecurity.change_case",delete:"ffsecurity.delete_case",target:"case"},{add:"ffsecurity.add_counter",view:"ffsecurity.view_counter",change:"ffsecurity.change_counter",delete:"ffsecurity.delete_counter",target:"counter"},{add:"ffsecurity.add_deviceblacklistrecord",view:"ffsecurity.view_deviceblacklistrecord",change:"ffsecurity.change_deviceblacklistrecord",delete:"ffsecurity.delete_deviceblacklistrecord",target:"deviceblacklistrecord"},{add:"ffsecurity.add_externalvms",view:"ffsecurity.view_externalvms",change:"ffsecurity.change_externalvms",delete:"ffsecurity.delete_externalvms",target:"externalvms"},{add:"ffsecurity.add_externalvmsevent",view:"ffsecurity.view_externalvmsevent",change:"ffsecurity.change_externalvmsevent",delete:"ffsecurity.delete_externalvmsevent",target:"externalvmsevent"},{add:"ffsecurity.add_externalvmssendeventstatus",view:"ffsecurity.view_externalvmssendeventstatus",change:"ffsecurity.change_externalvmssendeventstatus",delete:"ffsecurity.delete_externalvmssendeventstatus",target:"externalvmssendeventstatus"},{add:"ffsecurity.add_facecluster",view:"ffsecurity.view_facecluster",change:"ffsecurity.change_facecluster",delete:"ffsecurity.delete_facecluster",target:"facecluster"},{add:"ffsecurity.add_faceevent",view:"ffsecurity.view_faceevent",change:"ffsecurity.change_faceevent",delete:"ffsecurity.delete_faceevent",target:"faceevent"},{add:"ffsecurity.add_faceobject",view:"ffsecurity.view_faceobject",change:"ffsecurity.change_faceobject",delete:"ffsecurity.delete_faceobject",target:"faceobject"},{add:"ffsecurity.add_humancard",view:"ffsecurity.view_humancard",change:"ffsecurity.change_humancard",delete:"ffsecurity.delete_humancard",target:"humancard"},{add:"ffsecurity.add_humanepisode",view:"ffsecurity.view_humanepisode",change:"ffsecurity.change_humanepisode",delete:"ffsecurity.delete_humanepisode",target:"humanepisode"},{add:"ffsecurity.add_metadictionary",view:"ffsecurity.view_metadictionary",change:"ffsecurity.change_metadictionary",delete:"ffsecurity.delete_metadictionary",target:"metadictionary"},{add:"ffsecurity.add_notification",view:"ffsecurity.view_notification",change:"ffsecurity.change_notification",delete:"ffsecurity.delete_notification",target:"notification"},{add:"ffsecurity.add_report",view:"ffsecurity.view_report",change:"ffsecurity.change_report",delete:"ffsecurity.delete_report",target:"report"},{add:"ffsecurity.add_upload",view:"ffsecurity.view_upload",change:"ffsecurity.change_upload",delete:"ffsecurity.delete_upload",target:"upload"},{add:"ffsecurity.add_uploadlist",view:"ffsecurity.view_uploadlist",change:"ffsecurity.change_uploadlist",delete:"ffsecurity.delete_uploadlist",target:"uploadlist"},{add:"ffsecurity.add_user",view:"ffsecurity.view_user",change:"ffsecurity.change_user",delete:"ffsecurity.delete_user",target:"user"},{add:"ffsecurity.add_videoarchive",view:"ffsecurity.view_videoarchive",change:"ffsecurity.change_videoarchive",delete:"ffsecurity.delete_videoarchive",target:"videoarchive"},{add:"ffsecurity.add_watchlist",view:"ffsecurity.view_watchlist",change:"ffsecurity.change_watchlist",delete:"ffsecurity.delete_watchlist",target:"watchlist"},{add:"ffsecurity.add_webhook",view:"ffsecurity.view_webhook",change:"ffsecurity.change_webhook",delete:"ffsecurity.delete_webhook",target:"webhook"},{add:"auth.add_group",view:"auth.view_group",change:"auth.change_group",delete:"auth.delete_group",target:"group"}],cm=[{permission:"ffsecurity.batchupload_cards",target:"batchupload_cards"},{permission:"ffsecurity.change_runtimesetting",target:"change_runtimesetting"},{permission:"ffsecurity.configure_ntls",target:"configure_ntls"},{permission:"ffsecurity.view_auditlog",target:"view_auditlog"},{permission:"ffsecurity.view_runtimesetting",target:"view_runtimesetting"}],om=["ffsecurity.add_all_own_sessions","ffsecurity.add_notification","ffsecurity.add_user","ffsecurity.change_all_own_sessions","ffsecurity.delete_notification","ffsecurity.delete_user","ffsecurity.add_externalvmsevent","ffsecurity.change_externalvmsevent","ffsecurity.delete_externalvmsevent","ffsecurity.add_externalvmssendeventstatus","ffsecurity.change_externalvmssendeventstatus","ffsecurity.delete_externalvmssendeventstatus","auth.change_group","auth.add_group","auth.delete_group"],im=n("d180"),sm=n.n(im);function lm(e,t){var n=Object(r["e"])((function(){return new Set(om)})),a=Object(r["e"])((function(){return new Set(Object(r["Y"])(e))})),c=Object(r["L"])(""),o=Object(r["e"])(v),i=Object(r["e"])((function(){return cm})),s=Object(r["e"])(j),l=Object(r["e"])(O),u=Object(r["e"])((function(){return Object(r["Y"])(l).length+4*Object(r["Y"])(s).length})),d=Object(r["e"])((function(){return _(Object(r["Y"])(l))+g(Object(r["Y"])(s))}));function m(e){return Object(r["Y"])(n).has(e)}function b(e){return Object(r["Y"])(a).has(e)}function p(e){b(e)?h(e):f(e)}function f(t){Object(r["Y"])(e).push(t)}function h(t){Object(r["Y"])(e).splice(Object(r["Y"])(e).indexOf(t),1)}function v(){var e=am.filter((function(e){return Boolean(t[e])})).map((function(e){return nm[e]}));return rm.concat(e.flat())}function j(){var e=um(Object(r["Y"])(c));return Object(r["Y"])(o).filter((function(t){return e(t.target)}))}function O(){var e=um(Object(r["Y"])(c));return Object(r["Y"])(i).filter((function(t){return e(t.target)}))}function y(e){return Number(b(e))}function g(e){return sm()(e.map((function(e){return y(e.view)+y(e.add)+y(e.change)+y(e.delete)})))}function _(e){return sm()(e.map((function(e){return y(e.permission)})))}return{access:s,common:l,totalCount:u,grantedCount:d,isBlocked:m,isGranted:b,searchText:c,toggle:p}}function um(e){var t=new RegExp(e,"i");return function(e){return t.test(e)}}var dm=Object(r["n"])({name:"GroupPermissions",components:{HeaderBar:Nd["a"],GroupAccessPermissions:Jd,GroupCommonPermissions:tm},props:{modelValue:Object(fr["b"])(Object(fr["j"])()).isRequired,disabled:Object(fr["c"])().def(!1)},setup:function(e){var t=Object(r["W"])(e,"modelValue");return lm(t,fe["a"].plugins)}});const mm=ce()(dm,[["render",Wd]]);var bm=mm,pm=[{path:"permissions",classes:"n-form-w-6 form-pad",component:bm}],fm=pm;function hm(e,t,n,a,c,o){var i=Object(r["P"])("NSelect");return Object(r["F"])(),Object(r["g"])(i,{items:e.items,"model-value":e.itemValue,"onUpdate:modelValue":e.updateAdGroup,"key-field":"value","clear-icon":""},null,8,["items","model-value","onUpdate:modelValue"])}var vm=function(){function e(){Object(d["a"])(this,e)}return Object(m["a"])(e,null,[{key:"adGroupsRetrieve",value:function(){return Object(qr["a"])({method:"GET",path:"/ad_groups/"})}}]),e}(),jm=Object(r["n"])({name:"GroupADSelect",components:{NSelect:z["x"]},props:{item:{type:Object,required:!0}},setup:function(e){var t=Object(r["W"])(e,"item"),n=Object(r["L"])([]),a=Object(r["e"])((function(){var e;return n.value.length&&((null===(e=t.value.ad_group)||void 0===e?void 0:e.group_guid)||"")}));function c(e){t.value.ad_group||(t.value.ad_group={group_guid:null}),t.value.ad_group.group_guid=null!==e&&void 0!==e?e:null}return vm.adGroupsRetrieve().then((function(e){n.value=e.map((function(e){return{label:String(e.group_name),value:e.group_guid}}))})),{items:n,itemValue:a,updateAdGroup:c}}});const Om=ce()(jm,[["render",hm]]);var ym=Om,gm={path:"name",classes:"n-form-w-3 n-form-pad-10",i18n_label:"common.name",component:jr["a"]},_m={classes:"n-form-w-3 n-form-pad-10 n-form-block-start",i18n_label:"common.ad_group",component:ym,props:function(e){return{item:e}}},km={Information:"information",WatchLists:"watch_lists",CameraGroups:"camera_groups",Permissions:"permissions"},wm=function(e){Object(b["a"])(n,e);var t=Object(p["a"])(n);function n(){var e;return Object(d["a"])(this,n),e=t.apply(this,arguments),e.tab="information",e}return Object(m["a"])(n,[{key:"computedModelAcl",get:function(){return Q["a"].isCurrentUserAdmin?{view:!0,update:!0,delete:!0,add:!0}:this.modelAcl}},{key:"model",get:function(){return this.sidebarItem.model}},{key:"sidebarForm",get:function(){switch(this.tab){case km.WatchLists:return Ed;case km.CameraGroups:return Gd;case km.Permissions:return fm;default:return this.infoLayout}}},{key:"infoLayout",get:function(){var e=this.isADEnabled?[gm,_m]:[gm];return!this.model.isNew&&e.push.apply(e,Object(Cn["a"])(Object(me["b"])(["id"]))),e}},{key:"isADEnabled",get:function(){return fe["a"].config.services.ffsecurity.active_directory}},{key:"currentTabItems",get:function(){return this.editMode?this.tabItems:this.tabItems.slice(0,1)}},{key:"editMode",get:function(){return!this.model.isNew}},{key:"tabItems",get:function(){return[{name:km.Information,label:this.$t("common.".concat(km.Information),"f")},{name:km.WatchLists,label:this.$t("common.".concat(km.WatchLists),"f")},{name:km.CameraGroups,label:this.$t("common.".concat(km.CameraGroups),"f")},{name:km.Permissions,label:this.$t("common.".concat(km.Permissions),"f")}]}},{key:"headerActions",get:function(){return i["b"].getItemActions(this.modelAcl,null,{hasDelete:!0}).map(i["b"].computeActionByName)}},{key:"lastPageEvent",get:function(){var e;return(null===(e=ga["b"].current)||void 0===e?void 0:e.type)===Pe["c"].Groups?ga["b"].current:null}},{key:"refreshUserDescriptors",value:function(e){(null===e||void 0===e?void 0:e.name)===ga["a"].Update&&Q["a"].loadCurrentUserModule()}},{key:"handleAction",value:function(e){xe["a"].run(e,this.sidebarItem)}},{key:"validateForm",value:function(){var e=!this.$refs.form||this.$refs.form.validate();return e||this.$refs.form.displayErrors(),e}},{key:"created",value:function(){xe["a"].getIsItemFormValid=this.validateForm.bind(this)}}]),n}(h["b"]);Object(f["b"])([Object(v["c"])({type:Object,required:!0})],wm.prototype,"sidebarItem",void 0),Object(f["b"])([Object(v["c"])({type:Object,required:!0})],wm.prototype,"modelAcl",void 0),Object(f["b"])([Object(v["f"])("lastPageEvent")],wm.prototype,"refreshUserDescriptors",null),wm=Object(f["b"])([Object(h["a"])({name:"GroupsSidebar",components:{MultisidebarSaveActions:Sa,NForm:be["b"],NTabs:y["a"],SidebarHeader:j["a"]}})],wm);var Cm=wm;const xm=ce()(Cm,[["render",xd]]);var Tm=xm;function Im(){return fe["a"].config.services.ffsecurity.active_directory}var Am=function(){return Fm.apply(this,arguments)};function Fm(){return Fm=Object(u["a"])(regeneratorRuntime.mark((function e(){var t,n,a=arguments;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,c["j"].apply(void 0,a);case 2:return t=e.sent,n=t.model.save,t.model.save=Object(u["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return Im()?this.item["ad_group"]||(this.item["ad_group"]={group_guid:null}):delete this.item["ad_group"],e.abrupt("return",n.apply(t.model));case 2:case"end":return e.stop()}}),e,this)}))),e.abrupt("return",t);case 6:case"end":return e.stop()}}),e)}))),Fm.apply(this,arguments)}var Nm=n("4a98");function Sm(){return{create:100,update:-1,delete:100}}var Vm={itemLoader:c["j"],aclPrefix:o["b"],getModelAcl:c["e"],websocketUpdateHandler:c["k"],globalEventDelayTimeouts:Sm()},Pm=[{type:Pe["c"].EventsFaces,groupName:Pe["b"].Events,groupActionsOptions:[i["a"].hasSearch],contentComponent:Be,itemAttributesLoader:c["c"],websocketUpdateHandler:Nm["b"],websocketUpdateProperties:["eventUpdated","acknowledgedAll"],aclModelName:"faceevent"},{type:Pe["c"].EventsBodies,groupName:Pe["b"].Events,contentComponent:Be,itemAttributesLoader:c["c"],websocketUpdateHandler:Nm["b"],websocketUpdateProperties:["eventUpdated","acknowledgedAll"],aclModelName:"bodyevent"},{type:Pe["c"].EventsCars,groupName:Pe["b"].Events,contentComponent:Be,itemAttributesLoader:c["c"],websocketUpdateHandler:Nm["b"],websocketUpdateProperties:["eventUpdated","acknowledgedAll"],aclModelName:"carevent"},{type:Pe["c"].EpisodesHumans,groupName:Pe["b"].Episode,contentComponent:Be,itemAttributesLoader:c["b"],websocketUpdateHandler:Nm["b"],websocketUpdateProperties:["episode","episodeUpdated"],aclModelName:"humanepisode"},{type:Pe["c"].EpisodesCars,groupName:Pe["b"].Episode,contentComponent:Be,itemAttributesLoader:c["b"],websocketUpdateHandler:Nm["b"],websocketUpdateProperties:["episode","episodeUpdated"],aclModelName:"carepisode"},{type:Pe["c"].CardsHumans,groupName:Pe["b"].Cards,groupActionsOptions:[i["a"].hasDelete,i["a"].hasActive,i["a"].hasDelete],contentComponent:za,itemAttributesLoader:Wa,aclModelName:"humancard"},{type:Pe["c"].CardsCars,groupName:Pe["b"].Cards,groupActionsOptions:[i["a"].hasDelete,i["a"].hasActive,i["a"].hasDelete],contentComponent:za,itemAttributesLoader:Wa,aclModelName:"carcard"},{type:Pe["c"].ClustersFaces,groupName:Pe["b"].Clusters,contentComponent:Ka["a"],groupActionsOptions:[i["a"].hasDelete],itemAttributesLoader:c["a"],aclModelName:"facecluster"},{type:Pe["c"].ClustersBodies,groupName:Pe["b"].Clusters,contentComponent:Ka["a"],groupActionsOptions:[i["a"].hasDelete],itemAttributesLoader:c["a"],aclModelName:"bodycluster"},{type:Pe["c"].ClustersCars,groupName:Pe["b"].Clusters,contentComponent:Ka["a"],groupActionsOptions:[i["a"].hasDelete],itemAttributesLoader:c["a"],aclModelName:"carcluster"},{type:Pe["c"].ExternalVms,groupName:Pe["b"].ExternalVms,groupActionsOptions:[i["a"].hasDelete],contentComponent:_o,itemAttributesLoader:ko,aclModelName:"externalvms"},{type:Pe["c"].Cameras,groupName:Pe["b"].Cameras,contentComponent:Ss,itemAttributesLoader:Ps,itemLoader:Rs,aclModelName:"camera",websocketUpdateProperties:["cameraUpdated"],groupActionsOptions:[i["a"].hasActive,i["a"].hasCameraReset]},{type:Pe["c"].Videos,groupName:Pe["b"].Videos,contentComponent:Ss,itemAttributesLoader:Ps,aclModelName:"videoarchive",websocketUpdateProperties:["videoUpdated"],groupActionsOptions:[i["a"].hasProcess,i["a"].hasStopProcess,i["a"].hasDeleteFile,i["a"].hasDelete,i["a"].hasCameraReset]},{type:Pe["c"].Counters,groupName:Pe["b"].Counters,groupActionsOptions:[i["a"].hasActive,i["a"].hasDelete],contentComponent:fl,itemAttributesLoader:hl,aclModelName:"counter"},{type:Pe["c"].Webhooks,groupName:Pe["b"].Webhooks,contentComponent:Vl,itemAttributesLoader:Pl,aclModelName:"webhook",groupActionsOptions:[i["a"].hasActive,i["a"].hasDelete]},{type:Pe["c"].Users,groupName:Pe["b"].Users,contentComponent:Au,itemLoader:Su,itemAttributesLoader:Fu,aclModelName:"user",groupActionsOptions:[i["a"].hasDelete,i["a"].hasActive]},{type:Pe["c"].CameraGroups,groupName:Pe["b"].CameraGroups,contentComponent:sd,itemLoader:ld,itemAttributesLoader:function(e){var t;return{label:null===(t=e.model.item)||void 0===t?void 0:t.name}},aclModelName:"cameragroup",getItemAcl:Mm,groupActionsOptions:[i["a"].hasActive],globalEventDelayTimeouts:{create:1e3,update:-1,delete:100}},{type:Pe["c"].WatchLists,groupName:Pe["b"].WatchLists,contentComponent:_d,itemLoader:kd,itemAttributesLoader:function(e){var t;return{label:null===(t=e.model.item)||void 0===t?void 0:t.name}},aclModelName:"watchlist",getItemAcl:Rm,groupActionsOptions:[i["a"].hasActive,i["a"].hasDelete,i["a"].hasDeleteCard],globalEventDelayTimeouts:{create:1e3,update:-1,delete:100}},{type:Pe["c"].Groups,groupName:Pe["b"].Groups,contentComponent:Tm,itemLoader:Am,itemAttributesLoader:function(e){var t;return{label:null===(t=e.model.item)||void 0===t?void 0:t.name}},aclPrefix:"auth",aclModelName:"group",groupActionsOptions:[i["a"].hasDelete]}];function Rm(e,t){var n;return Em(null===(n=e.model.item)||void 0===n?void 0:n.id,"watch_list_permissions",t)}function Mm(e,t){var n;return Em(null===(n=e.model.item)||void 0===n?void 0:n.id,"camera_group_permissions",t)}function Em(e,t,n){var r=Object(a["a"])(Object(a["a"])({},n),{},{add:void 0});return e?Ke["f"].getItemAclByUserProperty(e,t,r):r}var Lm=Pm.map((function(e){return Object(a["a"])(Object(a["a"])({},Vm),e)})),Dm=Object.fromEntries(Lm.map((function(e){return[e.type,Object(r["t"])(e)]})))},f0c0:function(e,t,n){"use strict";n("abf9")},f63d:function(e,t,n){"use strict";n("b8b7")},fc78:function(e,t,n){},ff92:function(e,t,n){}}]);
//# sourceMappingURL=chunk-71afac1e.4800d718.js.map